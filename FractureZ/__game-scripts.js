var gameControllerSelf,GameController=pc.createScript("gameController");GameController.attributes.add("debug",{type:"boolean",default:!1}),GameController.attributes.add("debugLevelState",{type:"number",default:3,enum:[{Unlocked:2},{Completed:3}]}),GameController.attributes.add("configs",{type:"asset",assetType:"json"}),GameController.attributes.add("collections",{type:"entity",array:!0});var DEBUG=!1,GameData={curreentModel:null,currentCollectionConfig:null,currentCollectionIndex:0,currentLevelIndex:0,selectedCollectionIndex:0,paused:!1,showBotInvite:!1,showLevelFinishAds:!1};GameController.prototype.initialize=function(){DEBUG=this.debug,this.applyConfigs(),gameControllerSelf=this,this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:start",this.onGameStart),this.app.on("game:finish",this.onGameFinish),this.app.on("game:stop",this.onGameStop),this.app.on("game:replay",this.onGameReplay),this.app.on("game:pause",this.onGamePause),this.app.on("rewards:get",this.onGetRewards),this.subscribeToInputEvents()},GameController.prototype.applyConfigs=function(){for(var e=this.configs.resource,o=this.collections.length,t=0,n=0;n<o;n++){var a=this.collections[n].script.collectionConfig;a.showVideoOnUnlock=e.ads.startCollection.includes(n),e.inApps.includes(n)&&(a.lockType=CollectionLockReason.InAppPurchase);for(var l=a.levels.length,r=0;r<l;r++){var i=a.levels[r].script.levelConfig;i.isAdUnlock=e.ads.unlockLevel.includes(t),i.isInterstitialStart=e.ads.startLevel.includes(t),i.isInterstitialFinish=e.ads.finishLevel.includes(t),i.isBotInvite=e.bot.includes(t),t++}}},GameController.prototype.subscribeToInputEvents=function(){var e=this.app.touch;e&&e.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this);var o=this.app.mouse;o&&o.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this)},GameController.prototype.onGameLoaded=function(e){FbApi.loadInterstitialAd(),FbApi.loadRewardedVideo()},GameController.prototype.onGameStart=function(e,o,t,n){console.log("game:start"),GameData.currentLevelConfig=e,GameData.currentCollectionConfig=o,GameData.currentCollectionIndex=t,GameData.currentLevelIndex=n},GameController.prototype.onGameFinish=function(e,o){playLevelFinishAudio()},GameController.prototype.onGameStop=function(){console.log("game:stop")},GameController.prototype.onGameReplay=function(e,o){console.log("game:replay"),gameControllerSelf.onGameStart(e,o,GameData.currentCollectionIndex,GameData.currentLevelIndex)},GameController.prototype.onGetRewards=function(){console.log("rewards:get")},GameController.prototype.onGamePause=function(){GameData.paused=!0},GameController.prototype.onMouseDown=function(){GameData.paused&&(GameData.paused=!1,gameControllerSelf.app.fire("game:unpause"))};var playerControllerSelf,PlayerController=pc.createScript("playerController");PlayerController.attributes.add("gameController",{type:"entity"}),PlayerController.attributes.add("showBotSubscribeFrequency",{type:"number",default:5});var PlayerData={playerName:"FooBar",sound:!1,canSubscribeToBot:!0,botSubscription:!1,botInvitesCounter:0,collectionsProgress:[],sessionData:{},dataKeys:["progress","sound","bot","botInvitesCount"],firstSession:!1},CollectionItemState={Locked:0,ReadyToUnlock:1,Unlocked:2,Completed:3};function isCollectionAvailable(e){return!!DEBUG||getCollectionState(e)>CollectionItemState.Locked}function getCollectionState(e){return DEBUG?CollectionItemState.Completed:PlayerData.collectionsProgress[e].state}function getLevelState(e,o){return DEBUG?playerControllerSelf.gameController.script.gameController.debugLevelState:PlayerData.collectionsProgress[e].levels[o].state}function isLevelAvailable(e,o){return!!DEBUG||PlayerData.collectionsProgress[e].state>CollectionItemState.Locked&&PlayerData.collectionsProgress[e].levels[o].state>CollectionItemState.Locked}function isLevelCompleted(e,o){return!!DEBUG||PlayerData.collectionsProgress[e].state>CollectionItemState.Locked&&PlayerData.collectionsProgress[e].levels[o].state==CollectionItemState.Completed}PlayerController.prototype.initialize=function(){playerControllerSelf=this,this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:finish",this.onGameFinish),this.app.on("set:sound",this.onSetSound),this.app.on("bot:subscribe:result",this.onSubscribeBotResult),this.app.on("collection.unlocked",this.unlockCollection),this.app.on("level.unlocked",this.unlockLevel),this.app.on("bot:subscribe:popup",this.onShowSubscribeBotPopup)},PlayerController.prototype.onGameLoaded=function(e){PlayerData.playerName=FbApi.getPlayerName(),void 0!==e.sound&&(PlayerData.sound=e.sound),PlayerData.botSubscription=!0===e.bot,PlayerData.botSubscription?PlayerData.canSubscribeToBot=!1:FbApi.canSubscribeBot(function(e){PlayerData.canSubscribeToBot=e}),void 0===e.progress&&(e.progress=[],e.firstSession=!0),void 0!==e.botInvitesCount&&(PlayerData.botInvitesCounter=e.botInvitesCount);for(var o=playerControllerSelf.gameController.script.gameController.collections.length,l=0;l<o;l++){var t=playerControllerSelf.gameController.script.gameController.collections[l].script.collectionConfig,r=e.progress[l],n=void 0;switch(void 0!==r?n=playerControllerSelf.decodeCollectionState(r,t):(n=playerControllerSelf.createDefaultCollectionState(t)).state>CollectionItemState.Locked&&playerControllerSelf.unlockCollectionLevels(n,t),t.collectionType){case CollectionType.Gifts:PlayerData.botSubscription&&n.state===CollectionItemState.Locked&&(n.state=CollectionItemState.Unlocked,playerControllerSelf.unlockCollectionLevels(n,t))}PlayerData.collectionsProgress.push(n)}GameData.selectedCollectionIndex=void 0,playerControllerSelf.handleEntryPointData(),GameData.selectedCollectionIndex||(GameData.selectedCollectionIndex=playerControllerSelf.findLastAvailableCollectionIndex()),playerControllerSelf.app.fire("collections:update"),PlayerData.firstSession||FbApi.canCreateShortcut(function(e){e&&FbApi.createShortcut(function(e){console.log("createShortcut: "+e)})}),playAmbientAudio()},PlayerController.prototype.decodeCollectionState=function(e,o){for(var l=3&e,t=o.levels.length,r={state:l,levels:[],totalLevels:t},n=0;n<t;n++){var a=2*(n+1),i=(e&3<<a)>>a;r.levels.push({state:i})}return r},PlayerController.prototype.encodeCollectionsProgresses=function(){for(var e=PlayerData.collectionsProgress,o=[],l=0;l<e.length;l++)o[l]=this.encodeCollectionState(e[l]);return{progress:o}},PlayerController.prototype.encodeCollectionState=function(e){for(var o=e.totalLevels,l=e.state,t=0;t<o;t++){var r=2*(t+1);l|=e.levels[t].state<<r}return l},PlayerController.prototype.createDefaultCollectionState=function(e){for(var o=e.levels.length,l={state:e.lockType==CollectionLockReason.None?CollectionItemState.Unlocked:CollectionItemState.Locked,levels:[],totalLevels:o},t=0;t<o;t++){e.levels[t].script.levelConfig;l.levels.push({state:CollectionItemState.Locked})}return l},PlayerController.prototype.defineDefaultLevelState=function(e,o,l){if(o.isAdUnlock)return CollectionItemState.Locked;switch(l.collectionType){case CollectionType.Regular:return o.isBoss?CollectionItemState.Locked:CollectionItemState.Unlocked;case CollectionType.Tutorial:case CollectionType.Gifts:return 0===e?CollectionItemState.Unlocked:CollectionItemState.Locked}},PlayerController.prototype.handleEntryPointData=function(){var e=FbApi.getEntryPointData();if(e){var o=e.giftItemId;if(o)playerControllerSelf.unlockGiftLevel(o)&&(PlayerData.sessionData.receivedGiftId=o,FbApi.setSessionData(PlayerData.sessionData),playerControllerSelf.saveCollectionsProgress(),GameData.selectedCollectionIndex=playerControllerSelf.getGiftCollectionId(),playerControllerSelf.app.fire("gift:received:popup"))}},PlayerController.prototype.onGameFinish=function(e,o){if(playerControllerSelf.updateCollectionProgress(e,o)){playerControllerSelf.saveCollectionsProgress();var l=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig.levels[o].script.levelConfig;!PlayerData.botSubscription&&PlayerData.canSubscribeToBot&&l.isBotInvite&&(GameData.showBotInvite=!0),l.isInterstitialFinish&&(GameData.showLevelFinishAds=!0)}},PlayerController.prototype.saveCollectionsProgress=function(e,o){var l=playerControllerSelf.encodeCollectionsProgresses();FbApi.savePlayerData(l)},PlayerController.prototype.updateCollectionProgress=function(e,o){if(isLevelCompleted(e,o))return!1;PlayerData.collectionsProgress[e].levels[o].state=CollectionItemState.Completed;var l=PlayerData.collectionsProgress[e],t=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig;switch(t.collectionType){case CollectionType.Regular:t.levels[o].script.levelConfig.isBoss?playerControllerSelf.checkAndUlockNextCollection(e):playerControllerSelf.countCollectionComletedLevels(l)==l.totalLevels-1&&playerControllerSelf.unlockLevel(e,playerControllerSelf.getBossLevelIndex(t));break;case CollectionType.Tutorial:o+1>=l.totalLevels?playerControllerSelf.checkAndUlockNextCollection(e):playerControllerSelf.unlockLevel(e,o+1);break;case CollectionType.Gifts:}return playerControllerSelf.app.fire("collections:update"),!0},PlayerController.prototype.getBossLevelIndex=function(e){for(var o=e.levels.length,l=0;l<o;l++)if(e.levels[l].script.levelConfig.isBoss)return l;return-1},PlayerController.prototype.countCollectionComletedLevels=function(e){for(var o=e.levels.length,l=0,t=0;t<o;t++)e.levels[t].state==CollectionItemState.Completed&&l++;return l},PlayerController.prototype.checkAndUlockNextCollection=function(e){var o=e+1;void 0!==PlayerData.collectionsProgress[o]&&(isCollectionAvailable(o)||playerControllerSelf.gameController.script.gameController.collections[o].script.collectionConfig.lockType===CollectionLockReason.PreviousCollection&&playerControllerSelf.prepareCollectionToUnlock(o))},PlayerController.prototype.prepareCollectionToUnlock=function(e){PlayerData.collectionsProgress[e].state=CollectionItemState.ReadyToUnlock,playerControllerSelf.saveCollectionsProgress()},PlayerController.prototype.unlockCollection=function(e){var o=PlayerData.collectionsProgress[e];if(!(o.state>CollectionItemState.ReadyToUnlock)){o.state=CollectionItemState.Unlocked;var l=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig;playerControllerSelf.unlockCollectionLevels(o,l),playerControllerSelf.saveCollectionsProgress(),l.showVideoOnUnlock&&FbApi.showRewardedVideo(function(){},function(){})}},PlayerController.prototype.unlockLevel=function(e,o){var l=PlayerData.collectionsProgress[e].levels[o];l.state>CollectionItemState.ReadyToUnlock||(l.state=CollectionItemState.Unlocked,playerControllerSelf.saveCollectionsProgress())},PlayerController.prototype.unlockCollectionLevels=function(e,o){for(var l=e.totalLevels,t=0;t<l;t++){var r=o.levels[t].script.levelConfig;e.levels[t].state=playerControllerSelf.defineDefaultLevelState(t,r,o)}},PlayerController.prototype.unlockGiftCollection=function(){GameData.selectedCollectionIndex=playerControllerSelf.getGiftCollectionId(),playerControllerSelf.unlockCollection(GameData.selectedCollectionIndex),playerControllerSelf.app.fire("collections:update")},PlayerController.prototype.getGiftCollectionId=function(){for(var e=playerControllerSelf.gameController.script.gameController.collections.length,o=0;o<e;o++){if(playerControllerSelf.gameController.script.gameController.collections[o].script.collectionConfig.collectionType==CollectionType.Gifts)return o}},PlayerController.prototype.unlockGiftLevel=function(e){if(e<=0)return!1;var o=playerControllerSelf.getGiftCollectionId();return!!isLevelAvailable(o,e-1)&&(!isLevelAvailable(o,e)&&(playerControllerSelf.unlockLevel(o,e),playerControllerSelf.app.fire("collections:update"),!0))},PlayerController.prototype.unlockLevel=function(e,o){PlayerData.collectionsProgress[e].levels[o].state=CollectionItemState.Unlocked},PlayerController.prototype.onSetSound=function(e){PlayerData.sound=e,FbApi.savePlayerData({sound:e}),e?playAmbientAudio():stopAllAudios()},PlayerController.prototype.onSubscribeBotResult=function(e,o){!e&&o&&(PlayerData.botSubscription=!0,FbApi.savePlayerData({bot:!0}),playerControllerSelf.unlockGiftCollection())},PlayerController.prototype.onShowSubscribeBotPopup=function(e){switch(e){case BotSubscriptionType.First:case BotSubscriptionType.Repeated:PlayerData.botInvitesCounter++,FbApi.savePlayerData({botInvitesCount:PlayerData.botInvitesCounter})}},PlayerController.prototype.findLastAvailableCollectionIndex=function(){for(var e=0,o=this.gameController.script.gameController.collections,l=0;l<o.length;l++){switch(o[l].script.collectionConfig.collectionType){case CollectionType.Tutorial:case CollectionType.Regular:isCollectionAvailable(l)&&(e=l)}}return e};var playFabControllerSelf,PlayFabController=pc.createScript("playFabController");PlayFabController.prototype.initialize=function(){playFabControllerSelf=this,PlayFab.settings.titleId="F07D",this.app.on("game:loaded",this.loginToPlayfab)},PlayFabController.prototype.loginToPlayfab=function(a){FbApi.getPlayerSignature(function(a){null!==a&&PlayFabClientSDK.LoginWithFacebookInstantGamesId({FacebookInstantGamesSignature:a,CreateAccount:!0},playFabControllerSelf.onPlayFabLoginResponse)})},PlayFabController.prototype.onPlayFabLoginResponse=function(a,l){playFabControllerSelf.onPlayFabResponse(a,l),a&&a.data.NewlyCreated&&(PlayFabClientSDK.UpdateUserTitleDisplayName({DisplayName:FbApi.getPlayerName()},playFabControllerSelf.onPlayFabResponse),PlayFabClientSDK.UpdateAvatarUrl({ImageUrl:FbApi.getPlayerAvatar()},playFabControllerSelf.onPlayFabResponse))},PlayFabController.prototype.onPlayFabResponse=function(a,l){};var fbControllerSelf,Fbcontroller=pc.createScript("fbcontroller");Fbcontroller.prototype.postInitialize=function(){fbControllerSelf=this,"FBInstant"in window?FBState.initialized?this.startFBGame():this.app.on("fb:initialized",this.startFBGame):this.app.fire("game:loaded",{})},Fbcontroller.prototype.startFBGame=function(){FbApi.startGame(fbControllerSelf.app)};var FbApi={initialized:!1,app:null,supportedAPIs:null,entryPoint:null,REWARDED_VIDEO_PLACEMENT:"1045588595649752_1048424095366202",INTERSTITIAL_AD_PLACEMENT:"1045588595649752_1048423892032889",interstitialAdInstance:null,interstitialAdAvailable:!1,rewardedVideoInstance:null,rewardedVideoAvailable:!1,billingAvailable:!1,storeCatalog:[],purchases:[],startGame:function(t){FBInstant.startGameAsync().then(function(){FbApi.initialized=!0,FbApi.app=t,FbApi.getSupportedAPIs(),FbApi.onPause(),FbApi.getAllPlayerData(function(t){FbApi.app.fire("game:loaded",t)}),FbApi.setupBilling(function(t){FbApi.getStoreCatalogAsync(),FbApi.getPurchasesAsync()})}).catch(function(t){console.error("startGameAsync: "+t.message)})},getPlayerSignature:function(t){FbApi.initialized?FBInstant.player.getSignedPlayerInfoAsync(FbApi.getPlayerID()).then(function(n){t(n.getSignature())}):t(null)},getSupportedAPIs:function(){if(FbApi.initialized)try{FbApi.supportedAPIs=FBInstant.getSupportedAPIs()}catch(t){FbApi.supportedAPIs=null}},isApiSupported:function(t){return!!FbApi.initialized&&FbApi.supportedAPIs.indexOf(t)>-1},onPause:function(){FbApi.initialized&&FBInstant.onPause(function(){console.debug("FB Game Paused"),FbApi.app.fire("game:pause")})},getPlayerID:function(){return FbApi.initialized?FBInstant.player.getID():"42"},getPlayerName:function(){return FbApi.initialized?FBInstant.player.getName():"Player"},getPlayerAvatar:function(){return FbApi.initialized?FBInstant.player.getPhoto():null},getConnectedPlayers:function(){FbApi.initialized?FBInstant.player.getConnectedPlayersAsync().then(function(t){FbApi.app.fire("fb:connectedPlayers",t)}):FbApi.app.fire("fb:connectedPlayers",{})},getAllPlayerData:function(t){FbApi.initialized?FBInstant.player.getDataAsync(PlayerData.dataKeys).then(function(n){console.log("player fb data: "+JSON.stringify(n)),t(n)}).catch(function(n){console.error("getDataAsync: "+n.message),t({})}):t({})},savePlayerData:function(t){FbApi.initialized&&FBInstant.player.setDataAsync(t).then(function(){console.log("PlayerDataSaved = "+JSON.stringify(t))}).catch(function(t){console.error("setDataAsync: "+t.message)})},resetPlayerData:function(){FbApi.initialized&&FbApi.savePlayerData({progress:[],botInvitesCount:0})},getLocale:function(){return FbApi.initialized?FBInstant.getLocale():null},getPlatform:function(){return FbApi.initialized?FBInstant.getPlatform():null},getSDKVersion:function(){return FbApi.initialized?FBInstant.getSDKVersion():null},getEntryPointData:function(){return FbApi.initialized?FBInstant.getEntryPointData():{}},getEntryPointAsync:function(){if(FbApi.initialized)try{FBInstant.getEntryPointAsync().then(function(t){console.debug("FBInstant.getEntryPointAsync",t),FbApi.entryPoint=t})}catch(t){}},getContextID:function(){return FbApi.initialized?FBInstant.context.getID():null},getContextType:function(){return FbApi.initialized?FBInstant.context.getType():"SOLO"},loadInterstitialAd:function(){FbApi.initialized&&FbApi.isApiSupported("getInterstitialAdAsync")&&(FbApi.interstitialAdAvailable||FBInstant.getInterstitialAdAsync(FbApi.INTERSTITIAL_AD_PLACEMENT).then(function(t){return console.log("getInterstitialAdAsync OK"),FbApi.interstitialAdInstance=t,t.loadAsync()}).then(function(){console.log("interstitialAd loadAsync OK"),FbApi.interstitialAdAvailable=!0}).catch(function(t){console.error("getInterstitialAdAsync: "+t.message)}))},showInterstitialAd:function(t,n){console.log("try show int ads"),FbApi.initialized&&(FbApi.interstitialAdAvailable?FbApi.interstitialAdInstance.showAsync().then(function(){console.log("Interstitial ad finished successfully"),FbApi.interstitialAdAvailable=!1,FbApi.interstitialAdInstance=null,FbApi.loadInterstitialAd(),t()}).catch(function(t){console.error("interstitial.showAsync: "+t.message),n()}):(console.error("interstitial ads not available: "),n()))},loadRewardedVideo:function(){FbApi.initialized&&FbApi.isApiSupported("getRewardedVideoAsync")&&(FbApi.rewardedVideoAvailable||FBInstant.getRewardedVideoAsync(FbApi.REWARDED_VIDEO_PLACEMENT).then(function(t){return console.log("getRewardedVideoAsync OK"),FbApi.rewardedVideoInstance=t,t.loadAsync()}).then(function(){console.log("rewarded video loadAsync OK"),FbApi.rewardedVideoAvailable=!0}).catch(function(t){console.error("getRewardedVideoAsync: "+t.message)}))},showRewardedVideo:function(t,n){console.log("try show rewarded video"),FbApi.initialized&&(FbApi.rewardedVideoAvailable?FbApi.rewardedVideoInstance.showAsync().then(function(){console.log("rewardedVideo finished successfully"),FbApi.rewardedVideoAvailable=!1,FbApi.rewardedVideoInstance=null,FbApi.loadRewardedVideo(),t()}).catch(function(t){console.error("rewardedVideo.showAsync: "+t.message),n()}):(console.error("rewardedVideo not available: "),n()))},shareGameResult:function(t,n,e,i){console.log("shareGameResult. shareText="+n+", btnText="+btnText),FbApi.initialized&&FBInstant.shareAsync({intent:"SHARE",image:t,text:n,data:{myReplayData:"..."}}).then(function(){e()}).catch(function(t){console.error("shareAsync: "+t.message),i()})},canSubscribeBot:function(t){FbApi.initialized&&FbApi.isApiSupported("player.canSubscribeBotAsync")?FBInstant.player.canSubscribeBotAsync().then(function(n){t(n)}).catch(function(n){"INVALID_OPERATION"===n.code&&FbApi.savePlayerData({bot:!0}),t(!1)}):t(!1)},subscribeBot:function(t){FbApi.initialized&&FbApi.isApiSupported("player.subscribeBotAsync")?FBInstant.player.subscribeBotAsync().then(function(){t(!0)}).catch(function(n){t(!1)}):t(!1)},checkAndSubscribeBot:function(){FbApi.canSubscribeBot(function(t){console.log("canSubscribeBot: "+t),t&&FbApi.subscribeBot(function(t){FbApi.app.fire("bot:subscribe:result",PlayerData.botSubscription,t)})})},setSessionData:function(t){FbApi.initialized&&FBInstant.setSessionData(t)},chooseAsync:function(t,n){FbApi.initialized&&FbApi.isApiSupported("context.chooseAsync")?FBInstant.context.chooseAsync({maxSize:2}).then(function(n,e){t(FBInstant.context.getID())}).catch(function(t){console.error("chooseAsync: "+t.message),n()}):n()},canCreateShortcut:function(t){FbApi.initialized&&FbApi.isApiSupported("canCreateShortcutAsync")?FBInstant.canCreateShortcutAsync().then(function(n){t(n)}).catch(function(t){console.error("canCreateShortcutAsync: "+t.message)}):t(!1)},createShortcut:function(t){FbApi.initialized&&FbApi.isApiSupported("createShortcutAsync")?FBInstant.createShortcutAsync().then(function(){t(!0)}).catch(function(n){t(!1)}):t(!1)},setupBilling:function(t){if(!FbApi.initialized||!FbApi.isApiSupported("payments.purchaseAsync"))return console.log("billing not available"),void(t&&t(!1));FBInstant.payments.onReady(function(){console.log("Payments Ready!"),FbApi.billingAvailable=!0,FbApi.app.fire("store:billing_ready"),t&&t(!0)})},getStoreCatalogAsync:function(t){FbApi.billingAvailable?FBInstant.payments.getCatalogAsync().then(function(n){FbApi.storeCatalog=n,FbApi.app.fire("store:catalog_received",n),t&&t(n),console.log(n)}).catch(function(n){console.error(n),t&&t(null)}):(console.log("billing not available"),t&&t(null))},purchaseAsync:function(t,n,e){FbApi.billingAvailable?FBInstant.payments.purchaseAsync({productID:t,developerPayload:n}).then(function(t){console.log("purchaseAsync: "+t),FbApi.getStoreCatalogAsync(),FbApi.getPurchasesAsync(),e&&e(t)}).catch(function(t){console.error("purchaseAsync error: "+JSON.stringify(t)),e&&e(null)}):(console.log("billing not available"),e&&e(null))},getPurchasesAsync:function(t){FbApi.billingAvailable?FBInstant.payments.getPurchasesAsync().then(function(n){FbApi.purchases=n,FbApi.app.fire("store:purchases_received",n),console.log("getPurchasesAsync: "+n),t&&t(n)}).catch(function(n){console.error(n),t&&t(null)}):(console.log("billing not available"),t&&t(null))},consumePurchaseAsync:function(t,n){FbApi.billingAvailable?FBInstant.payments.consumePurchaseAsync(t).then(function(){console.log(t+" CONSUMED"),n&&n(t,!0)}).catch(function(e){console.error(e),n&&n(t,!1)}):(console.log("billing not available"),n&&n(t,!1))}};var uiControllerSelf,Uicontroller=pc.createScript("uicontroller");Uicontroller.attributes.add("gameController",{type:"entity"}),Uicontroller.attributes.add("loadingScreen",{type:"entity"}),Uicontroller.attributes.add("galleryScreen",{type:"entity"}),Uicontroller.attributes.add("gameScreen",{type:"entity"}),Uicontroller.attributes.add("rewardsScreen",{type:"entity"}),Uicontroller.attributes.add("subscribeBotPopup",{type:"entity"}),Uicontroller.attributes.add("botThanksPopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByPrevCollectionPopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByInAppPurchasePopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByBotSubscriptionPopup",{type:"entity"}),Uicontroller.attributes.add("collectionUnlockedPopup",{type:"entity"}),Uicontroller.attributes.add("levelLockedPopup",{type:"entity"}),Uicontroller.attributes.add("giftLevelLockedPopup",{type:"entity"}),Uicontroller.attributes.add("giftReceivedPopup",{type:"entity"}),Uicontroller.prototype.initialize=function(){this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:start",this.onGameStart),this.app.on("game:finish",this.onGameFinish),this.app.on("game:stop",this.onGameStop),this.app.on("game:replay",this.onGameStart),this.app.on("rewards:get",this.onGotRewards),this.app.on("bot:subscribe:popup",this.showSubscribeBotPopup),this.app.on("bot:subscribe:result",this.onSubscribeBotResult),this.app.on("collection:locked:popup:hide",this.hideCollectionLockedActivePopup),this.app.on("collection:locked:popup:show",this.showCollectionLockedPopup),this.app.on("collection:unlocked:popup:show",this.showCollectionUnlockedPopup),this.app.on("level:locked:popup:show",this.showLevelLockedPopup),this.app.on("gift:received:popup",this.showGiftReceivedPopup),this.currentScreen=null,uiControllerSelf=this,this.showScreen(this.loadingScreen)},Uicontroller.prototype.onGameLoaded=function(e){uiControllerSelf.showScreen(uiControllerSelf.galleryScreen)},Uicontroller.prototype.onGameStart=function(e,o){uiControllerSelf.showScreen(uiControllerSelf.gameScreen)},Uicontroller.prototype.onGameFinish=function(){uiControllerSelf.showScreen(uiControllerSelf.rewardsScreen)},Uicontroller.prototype.onGameStop=function(){uiControllerSelf.showScreen(uiControllerSelf.galleryScreen)},Uicontroller.prototype.onGotRewards=function(){if(uiControllerSelf.showScreen(uiControllerSelf.galleryScreen),GameData.showBotInvite){GameData.showBotInvite=!1;var e=BotSubscriptionType.Repeated;0===PlayerData.botInvitesCounter&&(e=BotSubscriptionType.First),uiControllerSelf.app.fire("bot:subscribe:popup",e)}GameData.showLevelFinishAds&&(GameData.showLevelFinishAds=!1,FbApi.showInterstitialAd(function(){},function(){}))},Uicontroller.prototype.showScreen=function(e){if(this.currentScreen){if(this.currentScreen===e)return;this.hideScreen(this.currentScreen)}this.currentScreen=e,e.enabled=!0},Uicontroller.prototype.hideScreen=function(e){this.currentScreen.enabled=!1,this.currentScreen=null},Uicontroller.prototype.showSubscribeBotPopup=function(e){switch(e){case BotSubscriptionType.First:uiControllerSelf.subscribeBotPopup.script.botPopupController.setFirstBotReplica();break;case BotSubscriptionType.Repeated:uiControllerSelf.subscribeBotPopup.script.botPopupController.setRepeatedBotReplica();break;case BotSubscriptionType.Manual:uiControllerSelf.subscribeBotPopup.script.botPopupController.setManualBotReplica()}uiControllerSelf.subscribeBotPopup.enabled=!0,playPopupAudio()},Uicontroller.prototype.onSubscribeBotResult=function(e,o){!e&&o&&(uiControllerSelf.botThanksPopup.enabled=!0,playPopupAudio())},Uicontroller.prototype.hideCollectionLockedActivePopup=function(){uiControllerSelf.activeCollectionLockedPopup&&(uiControllerSelf.activeCollectionLockedPopup.enabled=!1)},Uicontroller.prototype.showCollectionLockedPopup=function(e){switch(e){case CollectionLockReason.None:uiControllerSelf.activeCollectionLockedPopup=void 0;break;case CollectionLockReason.PreviousCollection:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByPrevCollectionPopup;break;case CollectionLockReason.InAppPurchase:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByInAppPurchasePopup;break;case CollectionLockReason.BotSubscription:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByBotSubscriptionPopup}uiControllerSelf.activeCollectionLockedPopup&&(uiControllerSelf.activeCollectionLockedPopup.enabled=!0)},Uicontroller.prototype.showLevelLockedPopup=function(e){switch(e){case CollectionType.Regular:case CollectionType.Tutorial:uiControllerSelf.levelLockedPopup.enabled=!0;break;case CollectionType.Gifts:uiControllerSelf.giftLevelLockedPopup.enabled=!0}playPopupAudio()},Uicontroller.prototype.showCollectionUnlockedPopup=function(){uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionUnlockedPopup,uiControllerSelf.collectionUnlockedPopup.enabled=!0,playPopupAudio()},Uicontroller.prototype.showGiftReceivedPopup=function(){uiControllerSelf.giftReceivedPopup.enabled=!0,playPopupAudio()};var PuzzleController=pc.createScript("puzzleController");PuzzleController.attributes.add("puzzleEntity",{type:"entity"}),PuzzleController.attributes.add("fracDistance",{type:"number",default:2}),PuzzleController.attributes.add("pairSearchGap",{type:"number",default:.01}),PuzzleController.attributes.add("gridSize",{type:"number",default:50}),PuzzleController.attributes.add("cellSizeGap",{type:"number",default:.2}),PuzzleController.attributes.add("bossSplit",{type:"number",default:3}),PuzzleController.attributes.add("partsDistance",{type:"number",default:40}),PuzzleController.attributes.add("difficulty",{type:"number",enum:[{easy_1:0},{easy_2:1},{medium:2},{hard:3}]}),PuzzleController.prototype.initialize=function(){this.puzzle=this.createPuzzle(),this.activePuzzle=this.puzzle,this.parts=[];for(var e=0;e<this.bossSplit;e++)this.parts.push(this.createPuzzle());this.usedCells=new HashSet,this.modelConfig=null,this.collectionConfig=null,this.ready=!1,this.cellSize=new pc.Vec3(0,0,0),this.tempVec3=new pc.Vec3(0,0,0),this.tempVec3_2=new pc.Vec3(0,0,0),this.tempVec3_3=new pc.Vec3(0,0,0),this.tempFrags=[],this.tempBb=new pc.BoundingBox,this.app.on("game:start",this.onGameStart.bind(this)),this.app.on("game:finish",this.onGameFinish.bind(this)),this.app.on("game:stop",this.onGameStop.bind(this)),this.app.on("game:replay",this.onGameReplay.bind(this)),this.app.on("rewards:get",this.onGetRewards.bind(this))},PuzzleController.prototype.resetData=function(){this.modelConfig&&this.modelConfig.model&&this.modelConfig.model.resource&&(this.puzzleEntity.model.model=null,this.modelConfig.model.unload(),this.app.batcher.generate()),this.cleanData(),this.modelConfig=null,this.ready=!1,console.log("resetData")},PuzzleController.prototype.load=function(e){e.ready(function(e){var t=this.puzzleEntity;t.model||t.addComponent("model"),t.model.model=e.resource,this.setup(),this.app.batcher.generate()}.bind(this)),this.app.assets.load(e)},PuzzleController.prototype.cleanData=function(){this.cleanPuzzle(this.puzzle);for(var e=0;e<this.parts.length;e++)this.cleanPuzzle(this.parts[e])},PuzzleController.prototype.setup=function(){this.cleanData(),this.findFragments(),this.resetPosition(this.puzzle,pc.Vec3.ZERO),this.findFragmentPairs(),this.computePuzzleGridSize(this.puzzle),this.configurePuzzle(),this.ready=!0,this.app.fire("game:ready")},PuzzleController.prototype.findFragments=function(){var e=this.puzzle.fragments,t=this.puzzleEntity.model.meshInstances;this.puzzle.meshes=t;for(var r=0;r<t.length;r++)t[r].material=r%2==0?this.collectionConfig.colorScheme.script.materialsConfig.baseMaterial.resource:this.collectionConfig.colorScheme.script.materialsConfig.fractureMaterial.resource,this.containsNode(t[r].node)||e.push(t[r])},PuzzleController.prototype.resetPosition=function(e,t){for(var r=e.fragments,a=0;a<r.length;a++)r[a].node.setLocalPosition(t)},PuzzleController.prototype.findFragmentPairs=function(){var e=this.puzzle.pairs,t=this.puzzle.fragments,r=[],a=0,n=0;for(a=0;a<t.length;a++){var o=[],i=t[a].mesh.vertexBuffer,s=new pc.VertexIterator(i),l=i.getNumVertices();for(n=0;n<l;n++){var h=s.element[pc.SEMANTIC_POSITION];o.push(new pc.Vec3(h.array[h.index],h.array[h.index+1],h.array[h.index+2])),s.next()}s.end(),r.push(o)}var p=this.pairSearchGap;for(a=0;a<r.length;a++){var c=r[a];for(n=a+1;n<r.length;n++)if(t[a].aabb.intersectsWithGap(t[n].aabb,p)&&this.meshesIntersect(c,r[n])){var u=this.createFragmentPair(t[a],t[n]);e.push(u)}}},PuzzleController.prototype.computePuzzleGridSize=function(e){var t=e.fragments,r=this.cellSize,a=this.tempBb;r.set(.1,.1,.1);for(var n=0;n<t.length;n++){var o=t[n].aabb;0===n?a.copy(o):a.add(o);var i=o.halfExtents;r.x<i.x&&(r.x=i.x),r.y<i.y&&(r.y=i.y),r.z<i.z&&(r.z=i.z)}r.add(r).plus(this.cellSizeGap)},PuzzleController.prototype.randomizeFragments=function(e){switch(this.difficulty){case 0:this.randomizeFragmentsAroundCenter(e);break;case 1:this.randomizeFragmentsOnSphere(e,!1);break;case 2:this.randomizeFragmentsOnSphere(e,!0);break;case 3:this.randomizeFragmentsRandomly(e)}},PuzzleController.prototype.randomizeFragmentsAroundCenter=function(e){var t=e.fragments,r=Math.floor(pc.math.random(0,t.length)),a=t[r].aabb.center,n=t[r].node.getLocalScale().x,o=this.fracDistance*n;e.origin.copy(a);for(var i=0;i<t.length;i++)if(r!=i){var s=t[i].aabb.center;t[i].node.setLocalPosition(this.tempVec3.copy(s).sub(a).mulBy(o).add(s).sub(this.tempVec3_2.copy(s).sub(t[i].node.getLocalPosition())))}},PuzzleController.prototype.randomizeFragmentsRandomly=function(e){this.usedCells.clear();var t=e.fragments,r=t[0].node.getLocalScale().x,a=this.fracDistance*r*.5,n=(this.app.graphicsDevice.width,this.app.graphicsDevice.height,Math.max(2,Math.ceil(Math.pow(t.length,1/3)))),o=Math.max(2,Math.ceil(1.5*n)),i=Math.max(n*n*o,t.length);this.updatePuzzleGridSize(n,o);for(var s=0;s<t.length;s++){for(var l=Math.floor(pc.math.random(0,i));this.usedCells.has(l);)l=Math.floor(pc.math.random(0,i));this.usedCells.add(l);var h=this.getCellCenter(l,n),p=this.tempVec3_3.copy(t[s].aabb.center);h.sub(t[s].aabb.center).mulBy(a).add(t[s].aabb.center).sub(p.sub(t[s].node.getLocalPosition())),t[s].node.setLocalPosition(h)}},PuzzleController.prototype.randomizeFragmentsOnSphere=function(e,t){this.usedCells.clear();var r=e.fragments,a=this.cellSize,n=this.tempBb,o=.5*a.length(),i=n.center,s=r[0].node.getLocalScale().x,l=this.fracDistance*s*.5,h=this.gridSize;this.updatePuzzleGridSize(h,h);for(var p=0;p<r.length;p++){var c=this.tempVec3.copy(r[p].aabb.center).sub(i).add(r[p].aabb.center);t&&c.add(this.tempVec3_2.set(Math.random(),Math.random(),Math.random()).normalize().mulBy(o));for(var u=this.getCellIndex(c,h);this.usedCells.has(u);)u=this.getCellIndex(c.add(this.tempVec3_2.copy(c).normalize().mulBy(o)),h);this.usedCells.add(u),c=this.getCellCenter(u,h);var z=this.tempVec3_3.copy(r[p].aabb.center);c.sub(r[p].aabb.center).mulBy(l).add(r[p].aabb.center).sub(z.sub(r[p].node.getLocalPosition())),r[p].node.setLocalPosition(c)}},PuzzleController.prototype.getCellIndex=function(e,t){var r=this.cellSize,a=this.tempBb.getMin();return e=this.tempVec3_2.copy(e).sub(a),Math.floor(e.x/r.x)+t*Math.floor(e.z/r.z)+t*t*Math.floor(e.y/r.y)},PuzzleController.prototype.getCellCenter=function(e,t){var r=this.cellSize,a=this.tempBb.getMin(),n=e%t,o=Math.floor(e/(t*t)),i=Math.floor(e%(t*t)/t),s=this.tempVec3_2.set(n*r.x,o*r.y,i*r.z).add(a);return s.x+=r.x*(i%2==1?1:.5),s.y+=r.y*(n%2==1?1:.5),s.z+=r.z*(n%2==1?1:.5),s},PuzzleController.prototype.updatePuzzleGridSize=function(e,t){var r=this.cellSize;this.tempBb.halfExtents.set(e*r.x*.5,t*r.y*.5,e*r.z*.5)},PuzzleController.prototype.configurePuzzle=function(){if(this.modelConfig.isBoss){var e=this.parts,t=0;for(this.splitPuzzle(this.bossSplit),t=0;t<e.length;t++){var r=e[t];this.computePuzzleGridSize(r),this.randomizeFragments(r)}if(e.every(function(e){return e.completed}))this.setActivePuzzle(this.puzzle);else{var a=Math.floor(pc.math.random(0,e.length));for(t=0;t<e.length;t++){var n=e[(a+t)%e.length];if(!n.completed){this.setActivePuzzle(n);break}}}}else this.randomizeFragments(this.puzzle),this.setActivePuzzle(this.puzzle)},PuzzleController.prototype.setActivePuzzle=function(e){this.activePuzzle=e,this.app.fire("camera:refreshView",this.ready)},PuzzleController.prototype.createFragmentPair=function(e,t){return{fragment1:e,fragment2:t,snapped:!1}},PuzzleController.prototype.cleanPuzzle=function(e){e.pairs=[],e.fragments=[],e.meshes=[],e.completed=!1},PuzzleController.prototype.createPuzzle=function(){return{pairs:[],fragments:[],meshes:[],origin:new pc.Vec3(0,0,0),completed:!1}},PuzzleController.prototype.getDistance3=function(e,t){return this.tempVec3.set(e.x-t.x,e.y-t.y,e.z-t.z),this.tempVec3.length()},PuzzleController.prototype.meshesIntersect=function(e,t){for(var r=this.pairSearchGap,a=0;a<e.length;a++)if(a%2!=1)for(var n=0;n<t.length;n++)if(this.getDistance3(e[a],t[n])<r)return!0;return!1},PuzzleController.prototype.containsNode=function(e){for(var t=this.puzzle.fragments,r=0;r<t.length;r++)if(t[r].node==e)return!0;return!1},PuzzleController.prototype.checkGameCompleted=function(){if(!this.ready)return!1;var e=0,t=this.activePuzzle.pairs;for(e=0;e<t.length;e++)if(!t[e].snapped)return!0;this.activePuzzle.completed=!0;var r=this.parts;for(e=0;e<r.length;e++)if(r[e].pairs.length>0&&!r[e].completed)return this.setActivePuzzle(r[e]),!1;if(!this.puzzle.completed){var a=this.activePuzzle;return this.app.fire("game:parts_completed",a),this.setActivePuzzle(this.puzzle),!1}return this.app.fire("game:finish",GameData.currentCollectionIndex,GameData.currentLevelIndex),!1},PuzzleController.prototype.onGameStart=function(e,t){console.log("base material = "+t.colorScheme.script.materialsConfig.baseMaterial.name),console.log("fracture material = "+t.colorScheme.script.materialsConfig.fractureMaterial.name),this.modelConfig=e,this.collectionConfig=t,this.load(e.model)},PuzzleController.prototype.onGameFinish=function(){this.ready=!1},PuzzleController.prototype.onGameStop=function(){this.resetData()},PuzzleController.prototype.onGameReplay=function(e,t){this.onGameStart(e,t)},PuzzleController.prototype.onGetRewards=function(){this.onGameStop()},PuzzleController.prototype.isAcceptablePair=function(e,t,r,a){return t>1&&(r.fragments.length<2&&-1==this.tempFrags.indexOf(a.fragment1)!=this.tempFrags.indexOf(a.fragment2)==-1||-1==r.fragments.indexOf(a.fragment1)||-1==r.fragments.indexOf(a.fragment2))||a.fragment1==e||a.fragment2==e},PuzzleController.prototype.getSearchVector=function(e){var t=e.halfExtents,r=t.x,a=t.y,n=t.z;return r>a&&r>n?pc.Vec3.RIGHT.clone():a>r&&a>n?pc.Vec3.UP.clone():pc.Vec3.BACK.clone()},PuzzleController.prototype.getStartFragment=function(e,t){for(var r,a=9007199254740991,n=0;n<t.length;n++){var o=t[n],i=this.getDistance3(o.aabb.center,e.center);(!r||i<a)&&(r=o,a=i)}return r},PuzzleController.prototype.splitPass1=function(e){var t=this.puzzle.fragments,r=this.parts,a=this.puzzle.pairs,n=this.getSearchVector(this.tempBb),o=this.getStartFragment(this.tempBb,t),i=t.length,s=Math.floor(i/e),l=i-s*e;s++;var h,p,c=0,u=0,z=0;for(c=0;c<i;c++){var m=Math.min(e-1,Math.floor(c/s));if(p=r[m],0!==c){var f=null,d=o.aabb.center;for(u=0;u<a.length;u++)if(h=a[u],this.isAcceptablePair(o,z,p,h)){var g=z>1?-1==p.fragments.indexOf(h.fragment1)&&-1===this.tempFrags.indexOf(h.fragment1)?h.fragment1:h.fragment2:o==h.fragment1?h.fragment2:h.fragment1,y=g.aabb.center;-1===this.tempFrags.indexOf(g)&&(!f||this.getDistance3(d,y)<this.getDistance3(d,f.aabb.center))&&this.tempVec3_3.copy(y).sub(d).dot(n)>=0&&(f=g)}f?(p.fragments.push(f),this.tempFrags.push(f),m===l&&(s=Math.floor(i/e)),o=f,f=null,z=0):(n.mulBy(-1),c--,z++)}else p.fragments.push(o),this.tempFrags.push(o),m===l&&(s=Math.floor(i/e))}this.tempFrags=[]},PuzzleController.prototype.findPairsForParts=function(){var e=this.puzzle.pairs,t=this.parts,r=0,a=0;for(r=0;r<e.length;r++)for(a=0;a<t.length;a++){pair=e[r];var n=t[a];if(n.fragments.indexOf(pair.fragment1)>-1&&n.fragments.indexOf(pair.fragment2)>-1){n.pairs.push(e[r]);break}}},PuzzleController.prototype.splitPass2=function(){var e=this.parts,t=0,r=0;for(t=0;t<e.length;t++){var a=e[t];if(!(a.fragments.length<2))for(r=0;r<a.fragments.length;r++)if(!this.fragmentConnected(a.fragments[r],a)){this.moveFragment(r,a,e);break}}},PuzzleController.prototype.spreadParts=function(){var e=this.tempBb,t=this.tempVec3_2.copy(e.center),r=this.puzzle.fragments[0].node.getLocalScale().x,a=this.partsDistance*r,n=this.parts,o=0,i=0;for(o=0;o<n.length;o++){var s=n[o];s.completed=s.pairs.length<1;var l=s.fragments;for(i=0;i<l.length;i++){var h=l[i].aabb;0===i?e.copy(h):e.add(h)}this.resetPosition(n[o],e.center.sub(t).normalize().mulBy(a))}for(o=0;o<n.length;o++)for(i=o+1;i<n.length;i++){var p=n[o].fragments[0].node.getLocalPosition(),c=n[i].fragments[0].node.getLocalPosition();this.resetPosition(n[i],t.copy(c).sub(p).normalize().mulBy(a).add(p))}},PuzzleController.prototype.splitPuzzle=function(e){this.splitPass1(e),this.findPairsForParts(),this.splitPass2(),this.splitMeshes(),this.spreadParts()},PuzzleController.prototype.splitMeshes=function(){var e,t,r,a=this.parts,n=this.puzzle.meshes,o=0,i=0,s=0,l=0;for(o=0;o<a.length;o++)for(t=(e=a[o]).fragments,i=0;i<t.length;i++)for(r=t[i],l=0,s=0;s<n.length&&(n[s].node==r.node&&(e.meshes.push(n[s]),l++),!(l>=2));s++);},PuzzleController.prototype.fragmentConnected=function(e,t){var r=t.pairs;for(i=0;i<r.length;i++){var a=r[i];if(a.fragment1==e||a.fragment2==e)return!0}return!1},PuzzleController.prototype.moveFragment=function(e,t,r){var a=t.fragments[e];t.fragments.splice(e,1);var n=this.puzzle.pairs;for(i=0;i<n.length;i++){var o=n[i];if(o.fragment1==a||o.fragmnt2==a)for(j=0;j<r.length;j++){var s=r[j];if(t!=s&&this.pairConnected(a,o,s))return s.fragments.push(a),void s.pairs.push(o)}}},PuzzleController.prototype.pairConnected=function(e,t,r){var a=t.fragment1==e?t.fragment2:t.frament1;return r.fragments.indexOf(a)>-1};var galleryScreenControllerSelf,GalleryScreenController=pc.createScript("galleryScreenController");GalleryScreenController.attributes.add("gameController",{type:"entity"}),GalleryScreenController.attributes.add("screenCaptionText",{type:"entity"}),GalleryScreenController.attributes.add("collectionNameText",{type:"entity"}),GalleryScreenController.attributes.add("itemsContainer",{type:"entity"}),GalleryScreenController.attributes.add("itemViewPrefab",{type:"entity"}),GalleryScreenController.attributes.add("bossItemViewPrefab",{type:"entity"}),GalleryScreenController.attributes.add("paginatorPointsContainer",{type:"entity"}),GalleryScreenController.attributes.add("paginatorPointPrefab",{type:"entity"}),GalleryScreenController.attributes.add("inactivePaginatorPointTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("activePaginatorPointTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("inactiveBonusPaginatorPointTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("activeBonusPaginatorPointTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("prevCollectionButton",{type:"entity"}),GalleryScreenController.attributes.add("nextCollectionButton",{type:"entity"}),GalleryScreenController.attributes.add("botButton",{type:"entity"}),GalleryScreenController.attributes.add("debugButton",{type:"entity"}),GalleryScreenController.attributes.add("debugScreen",{type:"entity"}),GalleryScreenController.attributes.add("soundButton",{type:"entity"}),GalleryScreenController.attributes.add("soundOnTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("soundOffTexture",{type:"asset",assetType:"texture"}),GalleryScreenController.attributes.add("inGameBg",{type:"entity"}),GalleryScreenController.attributes.add("colorTransitionTime",{type:"number",default:.2}),GalleryScreenController.attributes.add("tutorialText",{type:"entity"}),GalleryScreenController.prototype.initialize=function(){galleryScreenControllerSelf=this,this.itemViews=[],this.bossItemViews=[],this.initTopPanel(),this.itemViewPrefab.enabled=!1,this.bossItemViewPrefab.enabled=!1,this.initPaginator(),this.app.on("collections:update",this.onCollectionsUpdate),galleryScreenControllerSelf.botButton.enabled=!1,PlayerData.botSubscription||FbApi.canSubscribeBot(function(e){galleryScreenControllerSelf.botButton.enabled=e}),DEBUG&&(this.debugButton.enabled=!0,UIUtils.addClickListener(this.debugButton,function(){this.debugScreen.enabled=!0},this)),galleryScreenControllerSelf.showCollectionByIndex(GameData.selectedCollectionIndex)},GalleryScreenController.prototype.onCollectionsUpdate=function(){galleryScreenControllerSelf.showCollectionByIndex(GameData.selectedCollectionIndex)},GalleryScreenController.prototype.initTopPanel=function(){this.updateSoundIcon(),UIUtils.addClickListener(this.soundButton,function(){this.app.fire("set:sound",!PlayerData.sound),galleryScreenControllerSelf.updateSoundIcon()},this),UIUtils.addClickListener(this.botButton,function(){this.app.fire("bot:subscribe:popup",BotSubscriptionType.Manual)},this)},GalleryScreenController.prototype.updateSoundIcon=function(){this.soundButton.element.textureAsset=PlayerData.sound?this.soundOnTexture.id:this.soundOffTexture.id},GalleryScreenController.prototype.showCollectionByIndex=function(e){GameData.selectedCollectionIndex=e;var t=this.gameController.script.gameController.collections[e];this.showCollection(e,t),this.updatePaginatorPoints(e)},GalleryScreenController.prototype.showCollection=function(e,t){var l=t.script.collectionConfig;this.collectionNameText.element.text=l.collectionName,this.cleanupItemsContainer();for(var o=l.levels,r=0;r<o.length;r++)this.initModelView(o[r].script.levelConfig,l,e,r);switch(this.updateBg(l.colorScheme.script.bgColors),this.setCollectionAvailable(e,l.lockType),l.collectionType){case CollectionType.Regular:this.tutorialText.enabled=!1,this.screenCaptionText.element.text=this.getPlayerCollectionTitle();break;case CollectionType.Tutorial:this.tutorialText.enabled=!0,this.screenCaptionText.element.text=this.getPlayerCollectionTitle();break;case CollectionType.Gifts:this.tutorialText.enabled=!1,this.screenCaptionText.element.text="Gifts\nShop"}},GalleryScreenController.prototype.getPlayerCollectionTitle=function(){var e=FbApi.getPlayerName();return e.length>10&&(e=e.charAt(0)),e+"'s\nShop"},GalleryScreenController.prototype.setCollectionAvailable=function(e,t){switch(this.app.fire("collection:locked:popup:hide"),getCollectionState(e)){case CollectionItemState.Locked:this.app.fire("collection:locked:popup:show",t);break;case CollectionItemState.ReadyToUnlock:this.app.fire("collection:unlocked:popup:show",t)}},GalleryScreenController.prototype.updateBg=function(e){var t=this.inGameBg.script.inGameBg;this.updateBgElementColor(t.rootImage,e.rootImageColor,e.rootImageOpacity),this.updateBgElementColor(t.gradient,e.gradientColor,e.gradientOpacity),this.updateBgElementColor(t.glow1,e.glow1Color,e.glow1Opacity),this.updateBgElementColor(t.glow2,e.glow2Color,e.glow2Opacity),this.updateBgElementColor(t.glow3,e.glow3Color,e.glow3Opacity),this.updateBgElementColor(t.shadow,e.shadowColor,e.shadowOpacity),this.updateBgElementColor(t.vignette,e.vignetteColor,e.vignetteOpacity),this.app.scene.fogColor=e.fogColor},GalleryScreenController.prototype.backgroundUpdated=function(){this.app.fire("ui:bg_updated")},GalleryScreenController.prototype.updateBgElementColor=function(e,t,l){ImageUtils.tweenColorAndOpacity(e.element,e.element.color,t,e.element.opacity,l,galleryScreenControllerSelf.colorTransitionTime,pc.SineInOut,this.backgroundUpdated.bind(galleryScreenControllerSelf))},GalleryScreenController.prototype.initPaginator=function(){this.prevCollectionButton.element.on("click",function(e){playArrowTapAudio(),galleryScreenControllerSelf.showPrevCollection()},this),this.nextCollectionButton.element.on("click",function(e){playArrowTapAudio(),galleryScreenControllerSelf.showNextCollection()},this);var e=this.gameController.script.gameController.collections.length;function onPaginationPointClick(e){return function(){playArrowTapAudio(),galleryScreenControllerSelf.showCollectionByIndex(e)}}this.paginatorPoints=[];for(var t=0;t<e;t++){var l=this.paginatorPointPrefab.clone();this.paginatorPointsContainer.addChild(l),l.element.on("click",onPaginationPointClick(t),this),this.paginatorPoints.push(l)}this.paginatorPointPrefab.enabled=!1},GalleryScreenController.prototype.updatePaginatorPoints=function(e){for(var t=this.gameController.script.gameController.collections,l=0;l<this.paginatorPoints.length;l++)this.paginatorPoints[l].element.textureAsset=this.getPaginatorTexture(l===e,t[l].script.collectionConfig.collectionType==CollectionType.Gifts)},GalleryScreenController.prototype.getPaginatorTexture=function(e,t){return t?e?this.activeBonusPaginatorPointTexture.id:this.inactiveBonusPaginatorPointTexture.id:e?this.activePaginatorPointTexture.id:this.inactivePaginatorPointTexture.id},GalleryScreenController.prototype.updatePaginationButtons=function(){this.prevCollectionButton.enabled=GameData.selectedCollectionIndex>0,this.nextCollectionButton.enabled=GameData.selectedCollectionIndex<this.gameController.script.gameController.collections.length-1},GalleryScreenController.prototype.showPrevCollection=function(){var e=GameData.selectedCollectionIndex-1;e<0&&(e=this.gameController.script.gameController.collections.length-1),galleryScreenControllerSelf.showCollectionByIndex(e)},GalleryScreenController.prototype.showNextCollection=function(){var e=GameData.selectedCollectionIndex+1;e>this.gameController.script.gameController.collections.length-1&&(e=0),galleryScreenControllerSelf.showCollectionByIndex(e)},GalleryScreenController.prototype.initModelView=function(e,t,l,o){var r=this.getItemView(o,e.isBoss);r.enabled=!0,r.element.off("click"),r.element.on("click",function(n){if(playButtonTapAudio(),isLevelAvailable(l,o))galleryScreenControllerSelf.app.fire("game:start",r.script.levelConfig,t,l,o),e.isInterstitialStart&&FbApi.showInterstitialAd(function(){},function(){});else{var i=getCollectionState(l);i===CollectionItemState.Unlocked&&e.isAdUnlock?FbApi.showRewardedVideo(function(){galleryScreenControllerSelf.app.fire("level.unlocked",l,o),galleryScreenControllerSelf.app.fire("collections:update")},function(){}):i===CollectionItemState.Unlocked&&galleryScreenControllerSelf.app.fire("level:locked:popup:show",t.collectionType)}},this),r.script.galleryItemView.itemIcon.element.textureAsset=e.icon.id,r.script.levelConfig=e;var n=t.colorScheme.script.bgColors.itemViewShadowOpacity,i=1,a=getCollectionState(l);switch(getLevelState(l,o)){case CollectionItemState.Locked:r.script.galleryItemView.itemIcon.enabled=!1,r.script.galleryItemView.adsIcon.enabled=a===CollectionItemState.Unlocked&&e.isAdUnlock,i=r.script.galleryItemView.lockedFrameOpacity,n/=2.5,r.script.galleryItemView.unlockedNumber.enabled=!1,r.script.galleryItemView.unlockedGift.enabled=!1,t.collectionType==CollectionType.Gifts?(r.script.galleryItemView.lockedGift.enabled=!0,r.script.galleryItemView.lockedLocker.enabled=!1):(r.script.galleryItemView.lockedLocker.enabled=!0,r.script.galleryItemView.lockedGift.enabled=!1);break;case CollectionItemState.ReadyToUnlock:case CollectionItemState.Unlocked:r.script.galleryItemView.itemIcon.enabled=!1,r.script.galleryItemView.adsIcon.enabled=!1,i=r.script.galleryItemView.unlockedFrameOpacity,r.script.galleryItemView.lockedGift.enabled=!1,r.script.galleryItemView.lockedLocker.enabled=!1,t.collectionType==CollectionType.Gifts?(r.script.galleryItemView.unlockedGift.enabled=!0,r.script.galleryItemView.unlockedNumber.enabled=!1):(r.script.galleryItemView.unlockedGift.enabled=!1,r.script.galleryItemView.unlockedNumber.element.text=galleryScreenControllerSelf.levelIndexToString(o+1),r.script.galleryItemView.unlockedNumber.enabled=!0);break;case CollectionItemState.Completed:r.script.galleryItemView.itemIcon.enabled=!0,r.script.galleryItemView.adsIcon.enabled=!1,i=r.script.galleryItemView.unlockedFrameOpacity,r.script.galleryItemView.lockedGift.enabled=!1,r.script.galleryItemView.lockedLocker.enabled=!1,r.script.galleryItemView.unlockedGift.enabled=!1,r.script.galleryItemView.unlockedNumber.enabled=!1}r.script.galleryItemView.frame.element.opacity=i,ImageUtils.tweenColorAndOpacity(r.script.galleryItemView.bgBlur.element,r.script.galleryItemView.bgBlur.element.color,t.colorScheme.script.bgColors.itemViewShadowColor,r.script.galleryItemView.bgBlur.element.opacity,n,galleryScreenControllerSelf.colorTransitionTime,pc.SineInOut)},GalleryScreenController.prototype.levelIndexToString=function(e){switch(e){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV";case 5:return"V";case 6:return"VI";case 7:return"FINAL"}},GalleryScreenController.prototype.cleanupItemsContainer=function(){for(var e=0;e<this.itemViews.length;e++)this.itemViews[e].enabled=!1},GalleryScreenController.prototype.getItemView=function(e,t){if(this.itemViews.length>e)return this.itemViews[e];var l=t?this.bossItemViewPrefab.clone():this.itemViewPrefab.clone();return this.itemsContainer.addChild(l),this.itemViews.push(l),l},GalleryScreenController.prototype.onSubscribeBotResult=function(e,t){t&&(galleryScreenControllerSelf.botButton.enabled=!1)};var GalleryItemView=pc.createScript("galleryItemView");GalleryItemView.attributes.add("itemIcon",{type:"entity"}),GalleryItemView.attributes.add("adsIcon",{type:"entity"}),GalleryItemView.attributes.add("frame",{type:"entity"}),GalleryItemView.attributes.add("bgBlur",{type:"entity"}),GalleryItemView.attributes.add("lockedLocker",{type:"entity"}),GalleryItemView.attributes.add("unlockedNumber",{type:"entity"}),GalleryItemView.attributes.add("lockedGift",{type:"entity"}),GalleryItemView.attributes.add("unlockedGift",{type:"entity"}),GalleryItemView.attributes.add("lockedFrameOpacity",{type:"number",default:.5}),GalleryItemView.attributes.add("unlockedFrameOpacity",{type:"number",default:1});var RewardsScreenController=pc.createScript("rewardsScreenController");RewardsScreenController.attributes.add("gameController",{type:"entity"}),RewardsScreenController.attributes.add("sharingText",{type:"string",default:"Some sharing text"}),RewardsScreenController.attributes.add("replayButton",{type:"entity"}),RewardsScreenController.attributes.add("continueButton",{type:"entity"}),RewardsScreenController.attributes.add("shareButton",{type:"entity"}),RewardsScreenController.attributes.add("shareBg",{type:"asset",assetType:"texture"}),RewardsScreenController.attributes.add("shareAvatarBg",{type:"asset",assetType:"texture"}),RewardsScreenController.attributes.add("maleVisitorIcon",{type:"asset",assetType:"texture"}),RewardsScreenController.attributes.add("femaleVisitorIcon",{type:"asset",assetType:"texture"}),RewardsScreenController.attributes.add("visitorIconImage",{type:"entity"}),RewardsScreenController.attributes.add("visitorNameText",{type:"entity"}),RewardsScreenController.attributes.add("visitorReviewText",{type:"entity"}),RewardsScreenController.prototype.initialize=function(){var e=this;UIUtils.addClickListener(this.continueButton,function(){this.app.fire("rewards:get")},this),UIUtils.addClickListener(this.replayButton,function(){this.app.fire("game:replay",GameData.currentLevelConfig,GameData.currentCollectionConfig)},this),UIUtils.addClickListener(this.shareButton,function(){ImageUtils.createShareImage(e.shareBg.getFileUrl(),e.shareAvatarBg.getFileUrl(),FbApi.getPlayerAvatar(),function(t){FbApi.shareGameResult(t,e.sharingText,function(){console.log("shared")},function(){console.log("share failed")})})},this),this.app.on("game:finish",this.onGameFinish.bind(this)),this.onGameFinish(GameData.currentCollectionIndex,GameData.currentLevelIndex)},RewardsScreenController.prototype.onGameFinish=function(e,t){var r=this.gameController.script.gameController.collections[e].script.collectionConfig.levels[t].script.levelConfig;this.visitorIconImage.element.textureAsset=r.visitorGender===VisitorGender.Male?this.maleVisitorIcon.id:this.femaleVisitorIcon.id,this.visitorNameText.element.text=r.visitorName,this.visitorReviewText.element.text=r.visitorReview};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)},i=this.app.touch;i&&(i.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),i.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),i.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),i.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this),this.on("destroy",function(){i.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),i.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),i.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),i.off(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)}));var n=this.app.mouse;n&&(n.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),n.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),n.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){n.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),n.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),n.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),window.removeEventListener("mouseout",o,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,i=MouseInput.toWorldPoint,n=MouseInput.worldDiff,s=this.entity.camera,e=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,e,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,e,i),n.sub2(i,o),this.orbitCamera.pivotPoint.add(n)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1},MouseInput.prototype.onTouchStart=function(t){if(1===t.touches.length){var o=t.touches[0];this.lookButtonDown=!0,this.lastPoint.set(o.x,o.y)}},MouseInput.prototype.onTouchMove=function(t){var o=t.touches[0],i=o.x-this.lastPoint.x,n=o.y-this.lastPoint.y;this.orbitCamera.pitch-=n*this.orbitSensitivity,this.orbitCamera.yaw-=i*this.orbitSensitivity,this.lastPoint.set(o.x,o.y)},MouseInput.prototype.onTouchEnd=function(t){0===t.touches.length&&(this.lookButtonDown=!1)},MouseInput.prototype.onTouchCancel=function(t){0===t.touches.length&&(this.lookButtonDown=!1)};var self,OrbitCamera=pc.createScript("orbitCamera"),tweenOptions=[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}];OrbitCamera.attributes.add("orthoHeightAdd",{type:"number",default:0,title:"Ortho Height Add",description:"add specified value to computed model orthogrhaphic height"}),OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("partSwitchAnimTime",{type:"number",default:2}),OrbitCamera.attributes.add("partSwitchAnimEasing",{type:"string",default:"Linear",enum:tweenOptions}),OrbitCamera.attributes.add("finalRotationSpeed",{type:"number",default:15,min:0}),OrbitCamera.attributes.add("finalCameraYDif",{type:"number",default:1.2}),OrbitCamera.attributes.add("finalCameraAngle",{type:"vec3"}),OrbitCamera.attributes.add("cameraFocusTime",{type:"number",default:1}),OrbitCamera.attributes.add("finalCameraFocusTime",{type:"number",default:1}),OrbitCamera.attributes.add("cameraFocusAnimEasing",{type:"string",default:"Linear",enum:tweenOptions}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),OrbitCamera.attributes.add("cameraEntity",{type:"entity"}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype._computeDistance=function(){var t=this._modelsAabb.halfExtents,i=Math.max(t.x,Math.max(t.y,t.z));return i/=Math.tan(.5*this.camera.fov*pc.math.DEG_TO_RAD),i*=2},OrbitCamera.prototype._computeOrthoHeight=function(){var t=this._modelsAabb.halfExtents,i=Math.sqrt(t.x*t.x+t.z*t.z),e=(t.y,this.app.graphicsDevice.width,this.app.graphicsDevice.height,2*i+this.orthoHeightAdd);return this._orthoHeight>e?e:this._orthoHeight},OrbitCamera.prototype.finalFocus=function(){this._refreshAabb();var t=this._computeDistance(),i=this._computeOrthoHeight(),e=this.finalCameraFocusTime,a=this._modelsAabb.center.clone().sub(pc.Vec3.UP.clone().scale(this.finalCameraYDif));this.distance||(this.distance=0),this.app.tween(this).to({distance:t},e,pc.Linear).start(),this.app.tween(this).to({_orthoHeight:i},e,pc.Linear).start(),this.app.tween(this._pivotPoint).to(a,e,pc.Linear).start();var s=this.finalCameraAngle,n=pc.Quat.IDENTITY.clone().setFromEulerAngles(s.x,s.y,s.z),r=this.tempQuat.copy(this.entity.getRotation()),o={t:0},h=pc[this.cameraFocusAnimEasing];this.app.tween(o).to({t:1},e,h).on("update",function(t){this.tempQuat2.copy(r).rotateTowards(n,o.t),this.yaw=this._calcYaw(this.tempQuat2),this.pitch=this._calcPitch(this.tempQuat2,this.yaw)}.bind(this)).on("complete",function(t){var i=(this._targetYaw-this._yaw)%360;this.rotationSpeed=i>0?-Math.abs(this.finalRotationSpeed):Math.abs(this.finalRotationSpeed),this.rotate=!0}.bind(this)).start()},OrbitCamera.prototype.focus=function(t,i,e){t?this._buildAabb(t):this._refreshAabb();var a=this._computeDistance(),s=this._computeOrthoHeight();if(i){var n=this.cameraFocusTime,r=pc[this.cameraFocusAnimEasing];this.distance||(this.distance=0),this.app.tween(this).to({distance:a},n,r).start(),this.app.tween(this).to({_orthoHeight:s},n,r).start(),this.app.tween(this._pivotPoint).to(this._modelsAabb.center,n,r).start()}else this.distance=a,this._orthoHeight=s,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.prototype.refreshView=function(t){var i=self._orthoHeight;self._buildAabb(self.focusEntity);var e=self._computeDistance(),a=self._computeOrthoHeight();if(self._orthoHeight=i,t){self.stop=!0;var s=self.tempQuat.copy(self.entity.getRotation());self.entity.lookAt(self._modelsAabb.center);var n=self.tempQuat2.copy(self.entity.getRotation());self.entity.setRotation(s);var r=self.entity.getRotation(),o={t:0};self.pivotPoint.copy(self._modelsAabb.center);var h=pc[this.partSwitchAnimEasing];self.app.tween(self).to({_orthoHeight:a},.75*self.partSwitchAnimTime,pc.Linear).start(),self.app.tween(o).to({t:1},self.partSwitchAnimTime,h).on("update",function(t){self.entity.setRotation(r.copy(s).rotateTowards(n,o.t)),self.entity.camera.orthoHeight=self._orthoHeight}).on("complete",function(){self.resetAndLookAtPoint(self.entity.getLocalPosition(),self.pivotPoint),self.stop=!1}).start()}else console.log("refreshView: "+self._originalPoint),self.resetAndLookAtPoint(self._originalPoint,self._modelsAabb.center),self.distance=e,self._orthoHeight=a},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){self=this,this.camera=this.cameraEntity?this.cameraEntity.camera:this.entity.camera;var t=function(){self._checkAspectRatio()};window.addEventListener("resize",t,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center),this._originalPoint=new pc.Vec3,this._originalPoint.copy(this.entity.getPosition());var i=this.entity.getRotation();if(this.tempQuat=new pc.Quat(0,0,0,0),this.tempQuat2=new pc.Quat(0,0,0,0),this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._orthoHeight=1e6,this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.rotationSpeed=30,this.rotate=!1,this.frameOnStart)this.focus();else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",t,!1)}),this.app.on("camera:refreshFocus",this.refreshFocus.bind(this)),this.app.on("camera:refreshView",this.refreshView.bind(this)),this.app.on("game:finish",this.finalFocus.bind(this));var a=function(){this.rotate=!1}.bind(this);this.app.on("game:start",a),this.app.on("game:replay",a),this.stop=!1},OrbitCamera.prototype.update=function(t){if(!this.stop){this.rotate&&(this.yaw-=t*this.rotationSpeed);var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()}},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();switch(t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t),this.camera.projection){case pc.PROJECTION_ORTHOGRAPHIC:this.camera.orthoHeight=this._orthoHeight}},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t){this.meshes=[];var i,e=this.meshes,a=t.script.puzzleController.activePuzzle;if(a?i=a.fragments:t.model&&(i=t.model.meshInstances),i)for(var s=0;s<i.length;s++)this.containsNode(i,i[s].node,s)||e.push(i[s]);return this._orthoHeight=1e5,this._refreshAabb()},OrbitCamera.prototype._refreshAabb=function(){var t=this.meshes,e=0;for(i=0;i<t.length;i++)0===e?this._modelsAabb.copy(t[i].aabb):this._modelsAabb.add(t[i].aabb),e+=1;return e},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype.refreshFocus=function(t,i){self.focus(t?self.focusEntity:null,i)},OrbitCamera.prototype.containsNode=function(t,i,e){for(var a=0;a<e;a++)if(t[a].node==i)return!0;return!1};var ImageUtilsComponent=pc.createScript("imageUtilsComponent");ImageUtilsComponent.prototype.initialize=function(){ImageUtils.app=this.app,this.app.loader.getHandler("texture").crossOrigin="anonymous"};var ImageUtils={app:null,loadAndSetImage:function(e,t,a){if(null!==t){var n=ImageUtils.app.assets.find(e,"texture");if(void 0!==n)a.element.textureAsset=n.id;else{var o=new pc.Asset(e,"texture",{url:t});ImageUtils.app.assets.add(o),o.on("load",function(e){a.element.textureAsset=e.id}),ImageUtils.app.assets.load(o)}}},createShareImage:function(e,t,a,n){!function generate_fb_post_image_base(e,t,a,n){var o,i,s,l=new Image;function cleanup(){document.body.removeChild(o)}l.onload=function(){!function addHiddenCanvas(e,t){o=document.createElement("pre"),i=document.createElement("canvas"),s=i.getContext("2d"),i.style.padding=0,i.style.display="block",i.style.position="fixed",i.style.top="100%",i.style.overflow="hidden",i.width=e,i.height=t,o.appendChild(i),document.body.append(o)}(l.width,l.height),s.drawImage(l,0,0),console.log(a),null!==a?function drawAvatar(e,t,a){var n=200;s.save(),s.globalCompositeOperation="destination-out",s.beginPath(),s.arc(130,130,100,0,2*Math.PI,!1),s.fill(),s.restore();var o=new Image;o.crossOrigin="Anonymous",o.onload=function(){s.save(),s.globalCompositeOperation="destination-over",s.drawImage(o,0,0,o.width,o.height,30,30,n,n),s.restore();var e=new Image;e.onload=function(){s.drawImage(e,25,25,208,209),a(i.toDataURL()),cleanup()},e.src=t},o.src=e}(a,t,n):(n(i.toDataURL()),cleanup())},l.src=e}(e,t,a,n)},tweenColorAndOpacity:function(e,t,a,n,o,i,s,l){var r=t.clone(),p=this.app.tween(r).to(a,i,s).on("update",function(){e.color=r});l&&p.on("complete",l),p.start();var c={colorOpacity:n};this.app.tween(c).to({colorOpacity:o},i,s).on("update",function(){e.opacity=c.colorOpacity}).start()}};var GameScreenControllerSelf,GameScreenController=pc.createScript("gameScreenController");GameScreenController.attributes.add("homeButton",{type:"entity"}),GameScreenController.attributes.add("debugFinishButton",{type:"entity"}),GameScreenController.attributes.add("tip360",{type:"entity"}),GameScreenController.prototype.initialize=function(){GameScreenControllerSelf=this,UIUtils.addClickListener(this.homeButton,function(){this.app.fire("game:stop")},this),DEBUG&&(this.debugFinishButton.enabled=!0,this.debugFinishButton.element.on("click",function(e){this.app.fire("game:finish",GameData.currentCollectionIndex,GameData.currentLevelIndex)},this)),this.app.on("game:start",this.resetState),this.resetState()},GameScreenController.prototype.resetState=function(){GameScreenControllerSelf.tip360Tween&&GameScreenControllerSelf.tip360Tween.stop(),GameScreenControllerSelf.tip360.element.opacity=1;var e=GameScreenControllerSelf.app.touch;e?e.once(pc.EVENT_TOUCHSTART,GameScreenControllerSelf.onFirstTouch,GameScreenControllerSelf):GameScreenControllerSelf.app.mouse.once(pc.EVENT_MOUSEDOWN,GameScreenControllerSelf.onFirstTouch,GameScreenControllerSelf)},GameScreenController.prototype.fadeOutTip360=function(){var e={colorOpacity:1};GameScreenControllerSelf.tip360Tween=GameScreenControllerSelf.app.tween(e).to({colorOpacity:0},1,pc.SineInOut).on("update",function(){GameScreenControllerSelf.tip360.element.opacity=e.colorOpacity}).delay(2).start()},GameScreenController.prototype.onFirstTouch=function(e){this.fadeOutTip360()};pc.extend(pc,function(){var t=function(t){this._app=t,this._tweens=[],this._add=[]};t.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var i=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}},e=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};i.prototype={to:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this},from:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this._from=!0,this},rotate:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var n=function(t){return 1-s(1-t)},s=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:t,Tween:i,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){return t*t*(2.70158*t-1.70158)},BackOut:function(t){return--t*t*(2.70158*t+1.70158)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:n,BounceOut:s,BounceInOut:function(t){return t<.5?.5*n(2*t):.5*s(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",function(t){this._tweenManager.update(t)})},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.on("destroy",function(){e.stop()}),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();var CollectionConfig=pc.createScript("collectionConfig");CollectionConfig.attributes.add("collectionName",{type:"string"}),CollectionConfig.attributes.add("colorScheme",{type:"entity"}),CollectionConfig.attributes.add("collectionType",{type:"number",default:0,enum:[{Regular:0},{Tutorial:1},{Gifts:2}]}),CollectionConfig.attributes.add("lockType",{type:"number",default:0,enum:[{None:0},{ByPreviousCollection:1},{ByInAppPurchase:2},{ByBotSubscription:3}]}),CollectionConfig.attributes.add("levels",{type:"entity",array:!0});var CollectionLockReason={None:0,PreviousCollection:1,InAppPurchase:2,BotSubscription:3},CollectionType={Regular:0,Tutorial:1,Gifts:2};var botPopupControllerSelf,BotPopupController=pc.createScript("botPopupController");BotPopupController.attributes.add("firstBotReplica",{type:"string"}),BotPopupController.attributes.add("repeatedBotReplica",{type:"string"}),BotPopupController.attributes.add("manualBotReplica",{type:"string"}),BotPopupController.attributes.add("subscriptionText",{type:"entity"}),BotPopupController.attributes.add("subscribeBtn",{type:"entity"}),BotPopupController.attributes.add("cancelBtn",{type:"entity"}),BotPopupController.attributes.add("popupView",{type:"entity"});var BotSubscriptionType={First:0,Repeated:1,Manual:2};BotPopupController.prototype.initialize=function(){botPopupControllerSelf=this,UIUtils.addClickListener(this.subscribeBtn,function(){FbApi.checkAndSubscribeBot(),botPopupControllerSelf.entity.enabled=!1},this),UIUtils.addClickListener(this.cancelBtn,function(){botPopupControllerSelf.entity.enabled=!1},this)},BotPopupController.prototype.setBotReplica=function(t,e){this.subscriptionText.element.text=t.replaceAll("\\n","\n"),this.popupView.element.height=e},BotPopupController.prototype.setFirstBotReplica=function(){this.setBotReplica(this.firstBotReplica,550)},BotPopupController.prototype.setRepeatedBotReplica=function(){this.setBotReplica(this.repeatedBotReplica,520)},BotPopupController.prototype.setManualBotReplica=function(){this.setBotReplica(this.manualBotReplica,450)};pc.Entity.prototype.delayedExecute=function(t,e,i){for(var n=0;this["delayedExecuteTween"+n];)n++;var r="delayedExecuteTween"+n;return this[r]=this.tween(void 0).to(1,t,pc.Linear),this[r].start(),this[r].once("complete",function(){e.call(i),this[r]=null},this),this[r]},pc.BoundingBox.prototype.intersectsWithGap=function(t,e){var i=this.getMax(),n=this.getMin(),r=t.getMax(),o=t.getMin();return n.x-e<=r.x&&i.x+e>=o.x&&n.y-e<=r.y&&i.y+e>=o.y&&n.z-e<=r.z&&i.z+e>=o.z},pc.Vec3.prototype.mulBy=function(t){return this.x*=t,this.y*=t,this.z*=t,this},pc.Vec3.prototype.plus=function(t){return this.x+=t,this.y+=t,this.z+=t,this},pc.Vec3.prototype.getMax=function(){return Math.max(this.x,Math.max(this.y,this.z))},pc.Vec3.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},pc.Vec2.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},pc.GraphNode.prototype.tween=function(t,e){var i=pc.Application.getApplication();if(!i)throw new Error("Couldn't find current application");var n=i.tween(t);return n.entity=this,e&&e.element&&(n.element=e.element),n},pc.Quat.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},pc.Quat.prototype.difAngleDeg=function(t){var e=this.dot(t);if(this.equals(t))return 0;var i=1/(Math.PI/180);return 2*Math.acos(Math.min(Math.abs(e),1))*i},pc.Quat.prototype.rotateTowards=function(t,e){if(0!==this.difAngleDeg(t))return this.slerp(this,t,e)};var OrthoHeightToscaleController=pc.createScript("orthoHeightToscaleController");OrthoHeightToscaleController.attributes.add("cameraEntity",{type:"entity"}),OrthoHeightToscaleController.attributes.add("targetOrthoHeight",{type:"number",default:11}),OrthoHeightToscaleController.prototype.initialize=function(){this.camera=this.cameraEntity.camera},OrthoHeightToscaleController.prototype.update=function(t){var e=this.camera.orthoHeight/this.targetOrthoHeight;this.entity.setLocalScale(e,e,e)};var PlayFab=void 0!==PlayFab?PlayFab:{};PlayFab.settings||(PlayFab.settings={titleId:null,developerSecretKey:null,advertisingIdType:null,advertisingIdValue:null,GlobalHeaderInjection:null,disableAdvertising:!1,AD_TYPE_IDFA:"Idfa",AD_TYPE_ANDROID_ID:"Adid"}),PlayFab._internalSettings||(PlayFab._internalSettings={entityToken:null,sdkVersion:"1.38.190123",requestGetParams:{sdk:"JavaScriptSDK-1.38.190123"},sessionTicket:null,verticalName:null,productionServerUrl:".playfabapi.com",errorTitleId:"Must be have PlayFab.settings.titleId set to call this method",errorLoggedIn:"Must be logged in to call this method",errorEntityToken:"You must successfully call GetEntityToken before calling this",errorSecretKey:"Must have PlayFab.settings.developerSecretKey set to call this method",GetServerUrl:function(){return"http"!==PlayFab._internalSettings.productionServerUrl.substring(0,4)?PlayFab._internalSettings.verticalName?"https://"+PlayFab._internalSettings.verticalName+PlayFab._internalSettings.productionServerUrl:"https://"+PlayFab.settings.titleId+PlayFab._internalSettings.productionServerUrl:PlayFab._internalSettings.productionServerUrl},InjectHeaders:function(t,e){if(e)for(var n in e)try{t.setRequestHeader(gHeaderKey,e[n])}catch(t){console.log("Failed to append header: "+n+" = "+e[n]+"Error: "+t)}},ExecuteRequest:function(t,e,n,i,a,l,r){if(null!=a&&"function"!=typeof a)throw"Callback must be null of a function";null==e&&(e={});var s=new Date,o=JSON.stringify(e),g=[t],S=PlayFab._internalSettings.requestGetParams;if(null!=S){var y=!0;for(var P in S)y?(g.push("?"),y=!1):g.push("&"),g.push(P),g.push("="),g.push(S[P])}var u=g.join(""),b=new XMLHttpRequest;b.open("POST",u,!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("X-PlayFabSDK","JavaScriptSDK-"+PlayFab._internalSettings.sdkVersion),null!=n&&b.setRequestHeader(n,i),PlayFab._internalSettings.InjectHeaders(b,PlayFab.settings.GlobalHeaderInjection),PlayFab._internalSettings.InjectHeaders(b,r),b.onloadend=function(){if(null!=a){var t;try{t=JSON.parse(b.responseText)}catch(e){t={code:503,status:"Service Unavailable",error:"Connection error",errorCode:2,errorMessage:b.responseText}}t.CallBackTimeMS=new Date-s,t.Request=e,t.CustomData=l,200===t.code?a(t,null):a(null,t)}},b.onerror=function(){if(null!=a){var t;try{t=JSON.parse(b.responseText)}catch(e){t={code:503,status:"Service Unavailable",error:"Connection error",errorCode:2,errorMessage:b.responseText}}t.CallBackTimeMS=new Date-s,t.Request=e,t.CustomData=l,a(null,t)}},b.send(o)}}),PlayFab.buildIdentifier="jbuild_javascriptsdk__sdk-genericslave-3_1",PlayFab.sdkVersion="1.38.190123",PlayFab.GenerateErrorReport=function(t){if(null==t)return"";var e=t.errorMessage;for(var n in t.errorDetails)for(var i in t.errorDetails[n])e+="\n"+n+": "+t.errorDetails[n][i];return e},PlayFab.ClientApi={IsClientLoggedIn:function(){return null!=PlayFab._internalSettings.sessionTicket&&PlayFab._internalSettings.sessionTicket.length>0},ForgetAllCredentials:function(){PlayFab._internalSettings.sessionTicket=null,PlayFab._internalSettings.entityToken=null},AcceptTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AcceptTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddFriend:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddFriend",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddGenericID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddGenericID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddOrUpdateContactEmail:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddOrUpdateContactEmail",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddSharedGroupMembers:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddSharedGroupMembers",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddUsernamePassword:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddUsernamePassword",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddUserVirtualCurrency:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddUserVirtualCurrency",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AndroidDevicePushNotificationRegistration:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AndroidDevicePushNotificationRegistration",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AttributeInstall:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AttributeInstall",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,function(t,n){PlayFab.settings.advertisingIdType+="_Successful",null!=e&&"function"==typeof e&&e(t,n)},n,i)},CancelTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/CancelTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConfirmPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConfirmPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumeItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumeItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumePSNEntitlements:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumePSNEntitlements",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumeXboxEntitlements:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumeXboxEntitlements",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},CreateSharedGroup:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/CreateSharedGroup",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ExecuteCloudScript:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ExecuteCloudScript",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetAccountInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetAccountInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetAllUsersCharacters:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetAllUsersCharacters",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCatalogItems:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCatalogItems",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterInventory:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterInventory",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetContentDownloadUrl:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetContentDownloadUrl",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCurrentGames:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCurrentGames",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendLeaderboardAroundPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendLeaderboardAroundPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendsList:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendsList",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetGameServerRegions:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetGameServerRegions",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardAroundCharacter:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardAroundCharacter",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardAroundPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardAroundPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardForUserCharacters:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardForUserCharacters",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPaymentToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPaymentToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPhotonAuthenticationToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPhotonAuthenticationToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerCombinedInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerCombinedInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerProfile:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerProfile",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerSegments:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerSegments",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerStatisticVersions:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerStatisticVersions",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerTags:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerTags",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerTrades:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerTrades",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromFacebookIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromFacebookIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromFacebookInstantGamesIds:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromFacebookInstantGamesIds",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGameCenterIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGameCenterIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGenericIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGenericIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGoogleIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGoogleIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromKongregateIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromKongregateIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromNintendoSwitchDeviceIds:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromNintendoSwitchDeviceIds",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromPSNAccountIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromPSNAccountIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromSteamIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromSteamIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromTwitchIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromTwitchIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromXboxLiveIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromXboxLiveIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetSharedGroupData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetSharedGroupData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetStoreItems:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetStoreItems",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTime:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTime",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitleData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitleData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitleNews:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitleNews",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitlePublicKey:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitlePublicKey",t,null,null,e,n,i)},GetTradeStatus:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTradeStatus",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserInventory:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserInventory",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserPublisherReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserPublisherReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetWindowsHelloChallenge:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetWindowsHelloChallenge",t,null,null,e,n,i)},GrantCharacterToUser:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GrantCharacterToUser",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkAndroidDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkAndroidDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkCustomID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkCustomID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkFacebookAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkFacebookAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkFacebookInstantGamesId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkFacebookInstantGamesId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkGameCenterAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkGameCenterAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkGoogleAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkGoogleAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkIOSDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkIOSDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkKongregate:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkKongregate",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkNintendoSwitchDeviceId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkNintendoSwitchDeviceId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkOpenIdConnect:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkOpenIdConnect",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkPSNAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkPSNAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkSteamAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkSteamAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkTwitch:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkTwitch",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkWindowsHello:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkWindowsHello",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkXboxAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkXboxAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LoginWithAndroidDeviceID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithAndroidDeviceID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithCustomID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithCustomID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithEmailAddress:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithEmailAddress",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithFacebook:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithFacebook",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithFacebookInstantGamesId:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithFacebookInstantGamesId",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithGameCenter:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithGameCenter",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithGoogleAccount:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithGoogleAccount",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithIOSDeviceID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithIOSDeviceID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithKongregate:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithKongregate",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithNintendoSwitchDeviceId:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithNintendoSwitchDeviceId",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithOpenIdConnect:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithOpenIdConnect",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithPlayFab:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithPlayFab",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithPSN:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithPSN",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithSteam:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithSteam",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithTwitch:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithTwitch",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithWindowsHello:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithWindowsHello",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithXbox:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithXbox",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},Matchmake:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/Matchmake",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},OpenTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/OpenTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},PayForPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/PayForPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},PurchaseItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/PurchaseItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RedeemCoupon:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RedeemCoupon",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RefreshPSNAuthToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RefreshPSNAuthToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RegisterForIOSPushNotification:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterForIOSPushNotification",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RegisterPlayFabUser:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterPlayFabUser",t,null,null,function(t,n){null!=t&&null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket,PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},RegisterWithWindowsHello:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterWithWindowsHello",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},RemoveContactEmail:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveContactEmail",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveFriend:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveFriend",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveGenericID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveGenericID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveSharedGroupMembers:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveSharedGroupMembers",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ReportDeviceInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ReportDeviceInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ReportPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ReportPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RestoreIOSPurchases:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RestoreIOSPurchases",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SendAccountRecoveryEmail:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SendAccountRecoveryEmail",t,null,null,e,n,i)},SetFriendTags:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SetFriendTags",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SetPlayerSecret:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SetPlayerSecret",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},StartGame:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/StartGame",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},StartPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/StartPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SubtractUserVirtualCurrency:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SubtractUserVirtualCurrency",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkAndroidDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkAndroidDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkCustomID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkCustomID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkFacebookAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkFacebookAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkFacebookInstantGamesId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkFacebookInstantGamesId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkGameCenterAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkGameCenterAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkGoogleAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkGoogleAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkIOSDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkIOSDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkKongregate:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkKongregate",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkNintendoSwitchDeviceId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkNintendoSwitchDeviceId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkOpenIdConnect:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkOpenIdConnect",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkPSNAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkPSNAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkSteamAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkSteamAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkTwitch:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkTwitch",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkWindowsHello:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkWindowsHello",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkXboxAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkXboxAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlockContainerInstance:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlockContainerInstance",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlockContainerItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlockContainerItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateAvatarUrl:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateAvatarUrl",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateCharacterData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateCharacterData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateCharacterStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateCharacterStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdatePlayerStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdatePlayerStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateSharedGroupData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateSharedGroupData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserTitleDisplayName:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserTitleDisplayName",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateAmazonIAPReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateAmazonIAPReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateGooglePlayPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateGooglePlayPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateIOSReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateIOSReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateWindowsStoreReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateWindowsStoreReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WriteCharacterEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WriteCharacterEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WritePlayerEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WritePlayerEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WriteTitleEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WriteTitleEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},_MultiStepClientLogin:function(t){if(t&&!PlayFab.settings.disableAdvertising&&null!==PlayFab.settings.advertisingIdType&&null!==PlayFab.settings.advertisingIdValue){var e={};if(PlayFab.settings.advertisingIdType===PlayFab.settings.AD_TYPE_IDFA)e.Idfa=PlayFab.settings.advertisingIdValue;else{if(PlayFab.settings.advertisingIdType!==PlayFab.settings.AD_TYPE_ANDROID_ID)return;e.Adid=PlayFab.settings.advertisingIdValue}PlayFab.ClientApi.AttributeInstall(e,null)}}};var PlayFabClientSDK=PlayFab.ClientApi;PlayFab.RegisterWithPhaser=function(){"undefined"!=typeof Phaser&&(Phaser.Plugin.PlayFab=function(t,e){Phaser.Plugin.call(this,t,e)},Phaser.Plugin.PlayFab.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.PlayFab.prototype.constructor=Phaser.Plugin.PlayFab,Phaser.Plugin.PlayFab.prototype.PlayFab=PlayFab,Phaser.Plugin.PlayFab.prototype.settings=PlayFab.settings,Phaser.Plugin.PlayFab.prototype.ClientApi=PlayFab.ClientApi)},PlayFab.RegisterWithPhaser();var PuzzleSnapController=pc.createScript("puzzleSnapController");PuzzleSnapController.attributes.add("cameraHolder",{type:"entity"}),PuzzleSnapController.attributes.add("puzzleEntity",{type:"entity",description:"Entity with PuzzleController script"}),PuzzleSnapController.attributes.add("effectHolder",{type:"entity"}),PuzzleSnapController.attributes.add("snapDistancePxl",{type:"number",default:5}),PuzzleSnapController.attributes.add("snapTime",{type:"number",default:.5}),PuzzleSnapController.attributes.add("snapAnimTime",{type:"number",default:.5}),PuzzleSnapController.attributes.add("alertMaxDistPxl",{type:"number",default:30}),PuzzleSnapController.attributes.add("colorAnimTime",{type:"number",default:2}),PuzzleSnapController.attributes.add("conflictAnimTime",{type:"number",default:2}),PuzzleSnapController.attributes.add("conflictAnimEasing",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),PuzzleSnapController.attributes.add("snapIntensity",{type:"number",default:.5,min:0,max:.9}),PuzzleSnapController.attributes.add("hsvHolder",{type:"entity",array:!0}),PuzzleSnapController.prototype.initialize=function(){this.puzzle=this.puzzleEntity.script.puzzleController,this.input=this.cameraHolder.script.mouseInput,this.camera=this.cameraHolder.camera,this.snappedFragments=new HashSet,this.movingFragments=new HashSet,this.tempVec2=new pc.Vec2(0,0),this.tempVec3=new pc.Vec3(0,0,0),this.tempVec3_2=new pc.Vec3(0,0,0),this.tempBb=new pc.BoundingBox,this.time=0,this.snapBeginTime=0,this.activeDistance=0,this.activeStep=0,this.snapInProgress=!1,this.animColors=[];for(var t=0;t<this.hsvHolder.length;t++)this.animColors.push(this.hsvHolder[t].script.hsvColorDelta);this.app.on("game:start",this.onGameStart.bind(this))},PuzzleSnapController.prototype.update=function(t){this.time+=t,this.puzzle.ready&&(this.input.lookButtonDown&&this.checkSnapping(t),this.distanceToColor())},PuzzleSnapController.prototype.tweenColor=function(t,e,n){for(var i=this.animColors,a=0;a<i.length;a++)i[a].tweenColor(t,e,n)},PuzzleSnapController.prototype.distanceToColor=function(){var t=Math.floor(this.alertMaxDistPxl/this.snapDistancePxl),e=Math.min(Math.floor(this.activeDistance/this.snapDistancePxl),t);(e!=this.activeStep||0===e&&0===this.snapBeginTime)&&(this.activeStep=e,0===e&&0===this.snapBeginTime?this.tweenColor(0,!1,this.snapAnimTime+1):this.tweenColor((1-this.snapIntensity)*(1-e/t),!0,this.colorAnimTime))},PuzzleSnapController.prototype.checkSnapping=function(t){if(!this.snapInProgress){var e=this.puzzle.activePuzzle.pairs,n=!1,i=this.time;this.activeDistance=9007199254740991;for(var a=0;a<e.length;a++){var o=e[a];if(!o.snapped){var r=this.camera.worldToScreen(o.fragment1.node.getPosition()),s=this.camera.worldToScreen(o.fragment2.node.getPosition()),l=this.getDistance2(r,s);if(this.activeDistance>l&&(this.activeDistance=l),l<=this.snapDistancePxl){if(n=!0,0===this.snapBeginTime&&(this.snapBeginTime=i),i-this.snapBeginTime>=this.snapTime){n=!1,this.snappedFragments.clear();var p=r.z<s.z?o.fragment1:o.fragment2,c=r.z>=s.z?o.fragment1:o.fragment2,u=c.node.getLocalPosition();this.collectSnappedFragments(p,u);for(var h=this.snappedFragments.values(),d=0;d<h.length;d++){var m=h[d],z=m.node.getLocalPosition();m.node.tween(z).to(u,this.snapAnimTime,pc.Linear).start()}this.collectSnappedFragments(c),this.playSnapEffect(this.tempBb.center),this.detectCollisionAndMove(u),o.snapped=!0,this.snapInProgress=!0,this.entity.delayedExecute(this.snapAnimTime+.1,this.onSnap,this)}break}}}n||(this.snapBeginTime=0)}},PuzzleSnapController.prototype.playSnapEffect=function(t){this.effectHolder.setLocalPosition(t),this.effectHolder.particlesystem.reset(),this.effectHolder.particlesystem.play()},PuzzleSnapController.prototype.collectSnappedFragments=function(t,e){var n=this.puzzle.activePuzzle.pairs,i=this.snappedFragments,a=this.tempBb;e&&(this.tempVec3.copy(t.node.getLocalPosition()),t.node.setLocalPosition(e)),0===i.size()?a.copy(t.aabb):a.add(t.aabb),e&&t.node.setLocalPosition(this.tempVec3),i.add(t);for(var o=0;o<n.length;o++){var r=n[o];if(r.snapped&&(r.fragment1==t||r.fragment2==t)){var s=r.fragment1==t?r.fragment2:r.fragment1;i.has(s)||this.collectSnappedFragments(s,e)}}},PuzzleSnapController.prototype.snapConnectedFragments=function(){for(var t=this.puzzle.activePuzzle.pairs,e=0;e<t.length;e++){var n=t[e];!n.snapped&&n.fragment1.node.getLocalPosition().distance(n.fragment2.node.getLocalPosition())<1e-7&&(n.snapped=!0)}},PuzzleSnapController.prototype.onSnap=function(){this.snapConnectedFragments(),this.snapInProgress=!1,this.puzzle.checkGameCompleted()&&this.app.fire("camera:refreshFocus",!1,!0),playSnapAudio()},PuzzleSnapController.prototype.getDistance2=function(t,e){return this.tempVec2.set(t.x-e.x,t.y-e.y),this.tempVec2.length()},PuzzleSnapController.prototype.onGameStart=function(){this.activeDistance=9007199254740991,this.snapInProgress=!1},PuzzleSnapController.prototype.detectCollisionAndMove=function(t){var e,n=this.puzzle.activePuzzle.fragments,i=this.snappedFragments,a=this.movingFragments,o=this.tempBb,r=this.tempVec3,s=this.tempVec3_2,l=0,p=0,c=o.halfExtents.getMax(),u=n[0].node.getLocalScale().x;for(a.clear(),l=0;l<n.length;l++)if(e=n[l],!i.has(e)&&!a.has(e)&&o.intersects(e.aabb)){var h=[];s.copy(e.node.getLocalPosition()),e.node.setLocalPosition(t),r.copy(e.aabb.center),e.node.setLocalPosition(s),s.copy(r),r.sub(o.center).normalize();r.length();r.scale(c*u).add(s).sub(s.copy(e.aabb.center).sub(e.node.getLocalPosition())),this.collectConnectedFragments(e,a,h);var d=pc[this.conflictAnimEasing];for(p=0;p<h.length;p++){var m=(e=h[p]).node.getLocalPosition();e.node.tween(m).to(r.clone(),this.conflictAnimTime,d).start()}}},PuzzleSnapController.prototype.collectConnectedFragments=function(t,e,n){var i=this.puzzle.activePuzzle.pairs;e.add(t),n.push(t);for(var a=0;a<i.length;a++){var o=i[a];if(o.snapped&&(o.fragment1==t||o.fragment2==t)){var r=o.fragment1==t?o.fragment2:o.fragment1;e.has(r)||this.collectConnectedFragments(r,e,n)}}};function HashSet(n,t){var e=new Hashtable(n,t);this.add=function(n){e.put(n,!0)},this.addAll=function(n){for(var t=0,i=n.length;t<i;++t)e.put(n[t],!0)},this.values=function(){return e.keys()},this.remove=function(n){return e.remove(n)?n:null},this.contains=function(n){return e.containsKey(n)},this.has=function(n){return e.containsKey(n)},this.clear=function(){e.clear()},this.size=function(){return e.size()},this.isEmpty=function(){return e.isEmpty()},this.clone=function(){var i=new HashSet(n,t);return i.addAll(e.keys()),i},this.intersection=function(i){for(var s,r=new HashSet(n,t),u=i.values(),o=u.length;o--;)s=u[o],e.containsKey(s)&&r.add(s);return r},this.union=function(n){for(var t,i=this.clone(),s=n.values(),r=s.length;r--;)t=s[r],e.containsKey(t)||i.add(t);return i},this.isSubsetOf=function(n){for(var t=e.keys(),i=t.length;i--;)if(!n.contains(t[i]))return!1;return!0},this.complement=function(e){for(var i,s=new HashSet(n,t),r=this.values(),u=r.length;u--;)i=r[u],e.contains(i)||s.add(i);return s}}var Hashtable=function(e){var t="function",n="string";if("undefined"==typeof encodeURIComponent||Array.prototype.splice===e||Object.prototype.hasOwnProperty===e)return null;function toStr(e){return typeof e==n?e:""+e}function hashObject(e){var r;return typeof e==n?e:typeof e.hashCode==t?typeof(r=e.hashCode())==n?r:hashObject(r):toStr(e)}function equals_fixedValueHasEquals(e,t){return e.equals(t)}function equals_fixedValueNoEquals(e,n){return typeof n.equals==t?n.equals(e):e===n}function createKeyValCheck(t){return function(n){if(null===n)throw new Error("null is not a valid "+t);if(n===e)throw new Error(t+" must not be undefined")}}var r=createKeyValCheck("key"),u=createKeyValCheck("value");function Bucket(e,t,n,r){this[0]=e,this.entries=[],this.addEntry(t,n),null!==r&&(this.getEqualityFunction=function(){return r})}var i=0,a=1,s=2;function createBucketSearcher(e){return function(t){for(var n,r=this.entries.length,u=this.getEqualityFunction(t);r--;)if(u(t,(n=this.entries[r])[0]))switch(e){case i:return!0;case a:return n;case s:return[r,n[1]]}return!1}}function createBucketLister(e){return function(t){for(var n=t.length,r=0,u=this.entries,i=u.length;r<i;++r)t[n+r]=u[r][e]}}function getBucketForHash(e,t){var n=e[t];return n&&n instanceof Bucket?n:null}function Hashtable(){var t=[],n={},i={replaceDuplicateKey:!0,hashCode:hashObject,equals:null},a=arguments[0],s=arguments[1];s!==e?(i.hashCode=a,i.equals=s):a!==e&&function merge(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(i,a);var o=i.hashCode,c=i.equals;this.properties=i,this.put=function(e,a){r(e),u(a);var s,l,h=o(e),f=null;return(s=getBucketForHash(n,h))?(l=s.getEntryForKey(e))?(i.replaceDuplicateKey&&(l[0]=e),f=l[1],l[1]=a):s.addEntry(e,a):(s=new Bucket(h,e,a,c),t.push(s),n[h]=s),f},this.get=function(e){r(e);var t=o(e),u=getBucketForHash(n,t);if(u){var i=u.getEntryForKey(e);if(i)return i[1]}return null},this.containsKey=function(e){r(e);var t=o(e),u=getBucketForHash(n,t);return!!u&&u.containsKey(e)},this.containsValue=function(e){u(e);for(var n=t.length;n--;)if(t[n].containsValue(e))return!0;return!1},this.clear=function(){t.length=0,n={}},this.isEmpty=function(){return!t.length};var l=function(e){return function(){for(var n=[],r=t.length;r--;)t[r][e](n);return n}};this.keys=l("keys"),this.values=l("values"),this.entries=l("getEntries"),this.remove=function(e){r(e);var u,i=o(e),a=null,s=getBucketForHash(n,i);return s&&null!==(a=s.removeEntryForKey(e))&&0===s.entries.length&&(u=function searchBuckets(e,t){for(var n=e.length;n--;)if(t===e[n][0])return n;return null}(t,i),t.splice(u,1),delete n[i]),a},this.size=function(){for(var e=0,n=t.length;n--;)e+=t[n].entries.length;return e}}return Bucket.prototype={getEqualityFunction:function(e){return typeof e.equals==t?equals_fixedValueHasEquals:equals_fixedValueNoEquals},getEntryForKey:createBucketSearcher(a),getEntryAndIndexForKey:createBucketSearcher(s),removeEntryForKey:function(e){var t=this.getEntryAndIndexForKey(e);return t?(this.entries.splice(t[0],1),t[1]):null},addEntry:function(e,t){this.entries.push([e,t])},keys:createBucketLister(0),values:createBucketLister(1),getEntries:function(e){for(var t=e.length,n=0,r=this.entries,u=r.length;n<u;++n)e[t+n]=r[n].slice(0)},containsKey:createBucketSearcher(i),containsValue:function(e){for(var t=this.entries,n=t.length;n--;)if(e===t[n][1])return!0;return!1}},(Hashtable.prototype={each:function(e){for(var t,n=this.entries(),r=n.length;r--;)e((t=n[r])[0],t[1])},equals:function(e){var t,n,r,u=this.size();if(u==e.size()){for(t=this.keys();u--;)if(n=t[u],null===(r=e.get(n))||r!==this.get(n))return!1;return!0}return!1},putAll:function(e,n){for(var r,u,i,a,s=e.entries(),o=s.length,c=typeof n==t;o--;)u=(r=s[o])[0],i=r[1],c&&(a=this.get(u))&&(i=n(u,a,i)),this.put(u,i)},clone:function(){var e=new Hashtable(this.properties);return e.putAll(this),e}}).toQueryString=function(){for(var e,t=this.entries(),n=t.length,r=[];n--;)e=t[n],r[n]=encodeURIComponent(toStr(e[0]))+"="+encodeURIComponent(toStr(e[1]));return r.join("&")},Hashtable}();var audioControllerSelf,AudioController=pc.createScript("audioController");function canPlayAudio(){return PlayerData.sound&&!GameData.paused}function playAudio(o){canPlayAudio()&&audioControllerSelf.entity.sound.play(o)}function stopAudio(o){audioControllerSelf.entity.sound.stop(o)}function stopAllAudios(){stopAudio()}function playButtonTapAudio(){playAudio("ButtonTap")}function playSnapAudio(){playAudio("Snap")}function playLevelFinishAudio(){playAudio("LevelFinish")}function playPackUnlockAudio(){playAudio("PackUnlock")}function playInAppAudio(){playAudio("InApp")}function playGiftAudio(){playAudio("Gift")}function playArrowTapAudio(){playAudio("ArrowTap")}function playPopupAudio(){playAudio("Popup")}function playAmbientAudio(){playAudio("Ambient")}AudioController.prototype.initialize=function(){audioControllerSelf=this,this.app.on("game:pause",this.onGamePause),this.app.on("game:unpause",this.onGameUnpause)},AudioController.prototype.onGamePause=function(){stopAllAudios()},AudioController.prototype.onGameUnpause=function(){playAmbientAudio()};var InGameBg=pc.createScript("inGameBg");InGameBg.attributes.add("rootImage",{type:"entity"}),InGameBg.attributes.add("gradient",{type:"entity"}),InGameBg.attributes.add("glow1",{type:"entity"}),InGameBg.attributes.add("glow2",{type:"entity"}),InGameBg.attributes.add("glow3",{type:"entity"}),InGameBg.attributes.add("shadow",{type:"entity"}),InGameBg.attributes.add("vignette",{type:"entity"});var BgColors=pc.createScript("bgColors");BgColors.attributes.add("rootImageColor",{type:"rgb"}),BgColors.attributes.add("rootImageOpacity",{type:"number",default:1}),BgColors.attributes.add("gradientColor",{type:"rgb"}),BgColors.attributes.add("gradientOpacity",{type:"number",default:1}),BgColors.attributes.add("glow1Color",{type:"rgb"}),BgColors.attributes.add("glow1Opacity",{type:"number",default:1}),BgColors.attributes.add("glow2Color",{type:"rgb"}),BgColors.attributes.add("glow2Opacity",{type:"number",default:1}),BgColors.attributes.add("glow3Color",{type:"rgb"}),BgColors.attributes.add("glow3Opacity",{type:"number",default:1}),BgColors.attributes.add("shadowColor",{type:"rgb"}),BgColors.attributes.add("shadowOpacity",{type:"number",default:1}),BgColors.attributes.add("vignetteColor",{type:"rgb"}),BgColors.attributes.add("vignetteOpacity",{type:"number",default:1}),BgColors.attributes.add("itemViewShadowColor",{type:"rgb"}),BgColors.attributes.add("itemViewShadowOpacity",{type:"number",default:.3}),BgColors.attributes.add("fogColor",{type:"rgba",default:[.37,.64,.87,1]});var MaterialsConfig=pc.createScript("materialsConfig");MaterialsConfig.attributes.add("baseMaterial",{type:"asset",assetType:"material"}),MaterialsConfig.attributes.add("fractureMaterial",{type:"asset",assetType:"material"});var HsvColor=pc.createScript("hsvColor");Object.defineProperty(HsvColor.prototype,"hueAngle",{get:function(){return 360*this.h}}),HsvColor.prototype.initialize=function(){this.h=0,this.s=0,this.v=0,this.a=0,this.color=new pc.Color,this.entity.element&&this.linkColor(this.entity.element.color)},HsvColor.prototype.linkColor=function(t){var o=pc.math.clamp(t.r,0,1),i=pc.math.clamp(t.g,0,1),h=pc.math.clamp(t.b,0,1),s=Math.max(o,Math.max(i,h)),e=s-Math.min(o,Math.min(i,h));Math.abs(e)<.001?this.h=0:this.h=o>=i&&o>=h?(i-h)/e%6/6:i>=h?((h-o)/e+2)/6:((o-i)/e+4)/6,this.s=s>0?e/s:0,this.v=s,this.a=pc.math.clamp(t.a,0,1),this.normalize()},HsvColor.prototype.normalize=function(){this.h=this.h%1,this.h<0&&(this.h+=1),this.s=pc.math.clamp(this.s,0,1),this.v=pc.math.clamp(this.v,0,1),this.a=pc.math.clamp(this.a,0,1)},HsvColor.prototype.toColor=function(t){var o=this.h%1*360/60;o<0&&(o+=60);var i=this.v*this.s,h=i*(1-Math.abs(o%2-1)),s=0,e=0,r=0;switch(Math.floor(o)){case 0:s=i,e=h;break;case 1:s=h,e=i;break;case 2:e=i,r=h;break;case 3:e=h,r=i;break;case 4:s=h,r=i;break;case 5:s=i,r=h}var a=this.v-i;return t.set(s+a,e+a,r+a,this.a)},HsvColor.prototype.refreshColor=function(){this.entity.element&&this.linkColor(this.entity.element.color)},HsvColor.prototype.updateColor=function(t){if(this.entity.element){this.toColor(this.color);this.entity.element.color=this.toColor(this.color)}};var HsvColorDelta=pc.createScript("hsvColorDelta");HsvColorDelta.attributes.add("hueDelta",{type:"number",min:-1,max:1,description:"оттенок"}),HsvColorDelta.attributes.add("saturationDelta",{type:"number",min:-1,max:1,description:"насыщенность"}),HsvColorDelta.attributes.add("valueDelta",{type:"number",min:-1,max:1,description:"яркость"}),HsvColorDelta.attributes.add("alphaDelta",{type:"number",min:-1,max:1}),HsvColorDelta.attributes.add("testMode",{type:"boolean"}),HsvColorDelta.prototype.initialize=function(){this.hsvColor=this.entity.script.hsvColor,this.color={h:this.hsvColor.h,s:this.hsvColor.s,v:this.hsvColor.v,a:this.hsvColor.a},this.interruptable=!0,this.totalDiff={h:this.hueDelta,s:this.saturationDelta,v:this.valueDelta,a:this.alphaDelta},this.currentDiff={h:0,s:0,v:0,a:0},this.targetDiff={h:0,s:0,v:0,a:0},this.on("attr:hueDelta",function(t,o){this.totalDiff.h=t,this.testMode&&(this.hsvColor.h=pc.math.clamp(this.color.h+t,0,1),this.hsvColor.updateColor())}),this.on("attr:saturationDelta",function(t,o){this.totalDiff.s=t,this.testMode&&(this.hsvColor.s=pc.math.clamp(this.color.s+t,0,1),this.hsvColor.updateColor())}),this.on("attr:valueDelta",function(t,o){this.totalDiff.v=t,this.testMode&&(this.hsvColor.v=pc.math.clamp(this.color.v+t,0,1),this.hsvColor.updateColor())}),this.on("attr:alphaDelta",function(t,o){this.totalDiff.a=t,this.testMode&&(this.hsvColor.a=pc.math.clamp(this.color.a+t,0,1),this.hsvColor.updateColor())}),this.on("attr:testMode",function(t,o){t?(this.hsvColor.h=pc.math.clamp(this.color.h+this.hueDelta,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.saturationDelta,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.valueDelta,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.alphaDelta,0,1),this.hsvColor.updateColor()):(this.hsvColor.h=pc.math.clamp(this.color.h,0,1),this.hsvColor.s=pc.math.clamp(this.color.s,0,1),this.hsvColor.v=pc.math.clamp(this.color.v,0,1),this.hsvColor.a=pc.math.clamp(this.color.a,0,1),this.hsvColor.updateColor())}),this.app.on("ui:bg_updated",function(){this.hsvColor.refreshColor(),this.color.h=this.hsvColor.h,this.color.s=this.hsvColor.s,this.color.v=this.hsvColor.v,this.color.a=this.hsvColor.a,this.testMode&&(this.hsvColor.h=pc.math.clamp(this.color.h+this.hueDelta,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.saturationDelta,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.valueDelta,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.alphaDelta,0,1),this.hsvColor.updateColor())}.bind(this)),this.tween=this.app.tween(this.currentDiff),this.tween.on("update",this.updateColor.bind(this))},HsvColorDelta.prototype.tweenColor=function(t,o,s){var h=this.tween;h.playing&&!this.interruptable||(h.stop(),this.interruptable=o,this.targetDiff.h=this.totalDiff.h*t,this.targetDiff.s=this.totalDiff.s*t,this.targetDiff.v=this.totalDiff.v*t,this.targetDiff.a=this.totalDiff.a*t,h.to(this.targetDiff,s,pc.Linear),h.start())},HsvColorDelta.prototype.updateColor=function(){this.hsvColor.h=pc.math.clamp(this.color.h+this.currentDiff.h,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.currentDiff.s,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.currentDiff.v,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.currentDiff.a,0,1),this.hsvColor.updateColor()};var CollectionLockedBypurchasePopup=pc.createScript("collectionLockedBypurchasePopup");CollectionLockedBypurchasePopup.attributes.add("purchaseBtn",{type:"entity"}),CollectionLockedBypurchasePopup.attributes.add("purchaseBtnText",{type:"entity"}),CollectionLockedBypurchasePopup.attributes.add("productID",{type:"string"}),CollectionLockedBypurchasePopup.prototype.initialize=function(){this.product=null,UIUtils.addClickListener(this.purchaseBtn,this.onClick,this),this.onCatalogReceived(FbApi.storeCatalog),this.app.on("store:catalog_received",this.onCatalogReceived.bind(this))},CollectionLockedBypurchasePopup.prototype.onClick=function(e){FbApi.billingAvailable&&!this.purchasing&&(this.purchasing=!0,FbApi.purchaseAsync(this.productID,FbApi.getPlayerID(),this.onPurchase))},CollectionLockedBypurchasePopup.prototype.onCatalogReceived=function(e){var t=this.getProduct(e,this.productID);t&&FbApi.billingAvailable?(this.product=t,this.purchaseBtnText.element.text="BUY "+this.generateProductPriceView(t)):this.purchaseBtnText.element.text="UNAVAILABLE"},CollectionLockedBypurchasePopup.prototype.generateProductPriceView=function(e){return e.price.replace(/[^\d.-]/g,"")+" "+e.priceCurrencyCode},CollectionLockedBypurchasePopup.prototype.onPurchase=function(e){e?(playInAppAudio(),this.app.fire("collection.unlocked",GameData.selectedCollectionIndex),this.app.fire("collections:update"),this.entity.enabled=!1,console.log("onPurchase: success")):console.log("onPurchase: fail")},CollectionLockedBypurchasePopup.prototype.getProduct=function(e,t){if(!e)return null;for(var o=0;o<e.length;o++)if(e[o].productID==t)return e[o];return null},CollectionLockedBypurchasePopup.prototype.productExists=function(e,t){for(var o=0;o<e.length;o++)if(e[o].productID==t)return!0;return!1},CollectionLockedBypurchasePopup.prototype.productBuyed=function(e,t){return this.productExists(e,t)},CollectionLockedBypurchasePopup.prototype.productAvailable=function(e,t){return this.productExists(e,t)};var BossController=pc.createScript("bossController");BossController.attributes.add("puzzleHolder",{type:"entity"}),BossController.attributes.add("cameraHolder",{type:"entity"}),BossController.attributes.add("fogHolder",{type:"entity"}),BossController.attributes.add("finalPartsDistance",{type:"number",default:10}),BossController.attributes.add("fogAnimationTime",{type:"number",default:.5}),BossController.attributes.add("inactivePartsScale",{type:"number",default:.5}),BossController.prototype.initialize=function(){this.puzzle=this.puzzleHolder.script.puzzleController,this.camera=this.cameraHolder.camera,this.pivotPoint=null,this.partSwitchAnimTime=0,this.originalScale=new pc.Vec3(0,0,0),this.inactiveScale=new pc.Vec3(0,0,0),this.app.on("game:ready",this.setup.bind(this)),this.app.on("camera:refreshView",this.checkPuzzle.bind(this));var e=function(){this.enabled=!1,this.fogHolder.setLocalScale(pc.Vec3.ZERO)}.bind(this);this.app.on("game:finish",e),this.app.on("game:stop",e),this.app.on("rewards:get",e),this.app.on("game:parts_completed",this.shortenPartsDistance.bind(this)),this.enabled=!1,this.fogHolder.setLocalScale(pc.Vec3.ZERO)},BossController.prototype.setup=function(){var e=this.cameraHolder.script.orbitCamera;this.partSwitchAnimTime=e.partSwitchAnimTime,this.pivotPoint=e._pivotPoint,this.originalScale.copy(this.puzzle.puzzle.meshes[0].node.getLocalScale()),this.inactiveScale.copy(this.originalScale).scale(this.inactivePartsScale),this.enabled&&this.scaleIncactiveParts(!1),console.log("originalScale: "+this.originalScale)},BossController.prototype.checkPuzzle=function(){var e=this.puzzle.activePuzzle!=this.puzzle.puzzle,t=this.enabled;e&&e===t&&(this.enabled=!1,this.showMeshes(),this.scaleIncactiveParts(!0),this.entity.delayedExecute(this.partSwitchAnimTime,this.enableController,this)),e!==t&&(this.app.tween(this.fogHolder.localScale).to(e?pc.Vec3.ONE:pc.Vec3.ZERO,this.fogAnimationTime,pc.SineOut).on("update",function(){this.fogHolder.setLocalScale(this.fogHolder.localScale)}.bind(this)).start(),this.enabled=e,e||(this.showMeshes(),this.scaleMeshes(this.puzzle.activePuzzle.meshes,this.originalScale,!0)))},BossController.prototype.showMeshes=function(){for(var e=this.puzzle.puzzle.meshes,t=0;t<e.length;t++)e[t].visible=!0},BossController.prototype.enableController=function(){this.enabled=!0},BossController.prototype.scaleIncactiveParts=function(e){for(var t,s=this.puzzle.parts,o=0;o<s.length;o++)(t=s[o])==this.puzzle.activePuzzle?this.scaleMeshes(t.meshes,this.originalScale,!1):this.scaleMeshes(t.meshes,this.inactiveScale,e)},BossController.prototype.scaleMeshes=function(e,t,s){for(var o=0;o<e.length;o++){var i=e[o];s?i.node.tween(i.node.getLocalScale()).to(t,.5,pc.Linear).start():i.node.setLocalScale(t)}},BossController.prototype.shortenPartsDistance=function(e){for(var t,s=this.puzzle.parts,o=e.fragments[0].node.getLocalScale().x*this.finalPartsDistance,i=e.fragments[0].node.getLocalPosition(),a=new pc.Vec3(0,0,0),l=0;l<s.length;l++)if((t=s[l])!=e){var n=t.fragments[0].node.getLocalPosition();a.copy(n).sub(i);a.length();a.normalize().scale(o).add(i),this.movePartTo(t,a.clone())}},BossController.prototype.movePartTo=function(e,t){for(var s=e.fragments,o=0;o<s.length;o++){s[o].node.setLocalPosition(t)}};var CollectionLockedBybotSubcrPopup=pc.createScript("collectionLockedBybotSubcrPopup");CollectionLockedBybotSubcrPopup.attributes.add("subscribeBtn",{type:"entity"}),CollectionLockedBybotSubcrPopup.prototype.initialize=function(){UIUtils.addClickListener(this.subscribeBtn,function(){FbApi.checkAndSubscribeBot()},this)};var LevelConfig=pc.createScript("levelConfig");LevelConfig.attributes.add("isBoss",{type:"boolean"}),LevelConfig.attributes.add("icon",{type:"asset",assetType:"texture"}),LevelConfig.attributes.add("model",{type:"asset",assetType:"model"}),LevelConfig.attributes.add("visitorGender",{type:"number",default:0,enum:[{Male:0},{Female:1}]}),LevelConfig.attributes.add("visitorName",{type:"string",default:"John Galt"}),LevelConfig.attributes.add("visitorReview",{type:"string",default:"Lorem ipsum dolor sit amet"});var VisitorGender={Male:0,Female:1};String.prototype.replaceAll=function(t,i){return this.split(t).join(i)};var BotThanksPopup=pc.createScript("botThanksPopup");BotThanksPopup.attributes.add("continueBtn",{type:"entity"}),BotThanksPopup.prototype.initialize=function(){UIUtils.addClickListener(this.continueBtn,function(){this.entity.enabled=!1},this)};var DebugScreenController=pc.createScript("debugScreenController");DebugScreenController.attributes.add("closeBtn",{type:"entity"}),DebugScreenController.attributes.add("resetPlayerSaveBtn",{type:"entity"}),DebugScreenController.attributes.add("interstitialAdsBtn",{type:"entity"}),DebugScreenController.attributes.add("rewardedVideoBtn",{type:"entity"}),DebugScreenController.prototype.initialize=function(){this.closeBtn.element.on("click",function(e){this.entity.enabled=!1},this),this.resetPlayerSaveBtn.element.on("click",function(e){FbApi.resetPlayerData()},this),this.interstitialAdsBtn.element.on("click",function(e){playButtonTapAudio(),console.log("The element "+e.element.entity.name+" was clicked."),FbApi.showInterstitialAd(function(){console.log("int ad showed")},function(){console.log("int ad failed")})},this),this.rewardedVideoBtn.element.on("click",function(e){playButtonTapAudio(),console.log("The element "+e.element.entity.name+" was clicked."),FbApi.showRewardedVideo(function(){console.log("RewardedVideo showed")},function(){console.log("RewardedVideo failed")})},this)};var CollectionUlockedPopup=pc.createScript("collectionUlockedPopup");CollectionUlockedPopup.attributes.add("continueButton",{type:"entity"}),CollectionUlockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.continueButton,function(){playPackUnlockAudio(),this.app.fire("collection.unlocked",GameData.selectedCollectionIndex),this.app.fire("collections:update"),this.entity.enabled=!1},this)};var LevelLockedPopup=pc.createScript("levelLockedPopup");LevelLockedPopup.attributes.add("lockTextElement",{type:"entity"}),LevelLockedPopup.attributes.add("closeBtn",{type:"entity"}),LevelLockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.closeBtn,function(){this.entity.enabled=!1},this)};var SpriteFlipper=pc.createScript("spriteFlipper");SpriteFlipper.attributes.add("cullMode",{type:"number",enum:[{None:0},{FrontFace:1},{BackFace:2}]}),SpriteFlipper.prototype.initialize=function(){this.entity.element._image._material.cull=this.cullMode,this.on("attr:cullMode",function(e,t){this.entity.element._image._material.cull=e})};var GiftLevelLockedPopup=pc.createScript("giftLevelLockedPopup");GiftLevelLockedPopup.attributes.add("closeBtn",{type:"entity"}),GiftLevelLockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.closeBtn,function(){this.entity.enabled=!1},this)};var UIUtils={animatePressedButton:function(t,e){var n=t.getLocalScale(),o=1.03;t.tween(t.getLocalScale()).to(new pc.Vec3(n.x*o,n.y*o,n.z*o),.07,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){e()}).start()},onButtonPressed:function(t,e,n){e.stopPropagation(),playButtonTapAudio(),UIUtils.animatePressedButton(t,n)},addClickListener:function(t,e,n){t.element.on("click",function(o){UIUtils.onButtonPressed(t,o,e.bind(n))},n)}};var GiftReceivedPopup=pc.createScript("giftReceivedPopup");GiftReceivedPopup.attributes.add("claimButton",{type:"entity"}),GiftReceivedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.claimButton,function(){playGiftAudio(),this.entity.enabled=!1},this)};