var gameControllerSelf,GameController=pc.createScript("gameController");GameController.attributes.add("debug",{type:"boolean",default:!1}),GameController.attributes.add("debugLevelState",{type:"number",default:3,enum:[{Unlocked:2},{Completed:3}]}),GameController.attributes.add("configs",{type:"asset",assetType:"json"}),GameController.attributes.add("collections",{type:"entity",array:!0});var DEBUG=!1,GameData={buildType:null,buildVersion:null,curreentModel:null,currentCollectionConfig:null,currentCollectionIndex:-1,currentLevelIndex:-1,selectedCollectionIndex:0,paused:!1,showBotInvite:!1,showLevelFinishAds:!1},BuildType={DEV:"dev",PROD:"prod"};GameController.prototype.initialize=function(){DEBUG=this.debug,this.applyConfigs(),gameControllerSelf=this,this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:start",this.onGameStart),this.app.on("game:finish",this.onGameFinish),this.app.on("game:stop",this.onGameStop),this.app.on("game:replay",this.onGameReplay),this.app.on("game:pause",this.onGamePause),this.app.on("game:unpause",this.onGameResume),this.app.on("rewards:get",this.onGetRewards),this.subscribeToInputEvents(),this.subscribeToVisibilityChange()},GameController.prototype.applyConfigs=function(){var e=this.configs.resource;this.setBuildData(e);for(var t=this.collections.length,o=0,n=0;n<t;n++){var i=this.collections[n].script.collectionConfig;i.showVideoOnUnlock=e.ads.startCollection.includes(n),e.inApps.includes(n)&&(i.lockType=CollectionLockReason.InAppPurchase);for(var a=i.levels.length,l=0;l<a;l++){var s=i.levels[l].script.levelConfig;s.isAdUnlock=e.ads.unlockLevel.includes(o),s.isInterstitialStart=e.ads.startLevel.includes(o),s.isInterstitialFinish=e.ads.finishLevel.includes(o),s.isBotInvite=e.bot.includes(o),o++}}},GameController.prototype.setBuildData=function(e){GameData.buildType=e.buildType,GameData.buildType!==BuildType.DEV&&GameData.buildType!==BuildType.PROD&&(GameData.buildType=BuildType.DEV),GameData.buildVersion=e.buildVersion},GameController.prototype.subscribeToInputEvents=function(){var e=this.app.touch;e&&e.on(pc.EVENT_TOUCHSTART,this.onMouseDown,this);var t=this.app.mouse;t&&t.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this)},GameController.prototype.onGameLoaded=function(e){FbApi.loadInterstitialAd(),FbApi.loadRewardedVideo()},GameController.prototype.onGameStart=function(e,t,o,n){console.log("game:start"),GameData.currentLevelConfig=e,GameData.currentCollectionConfig=t,GameData.currentCollectionIndex=o,GameData.currentLevelIndex=n},GameController.prototype.onGameFinish=function(e,t){playLevelFinishAudio()},GameController.prototype.onGameStop=function(){console.log("game:stop")},GameController.prototype.onGameReplay=function(e,t){console.log("game:replay"),gameControllerSelf.onGameStart(e,t,GameData.currentCollectionIndex,GameData.currentLevelIndex)},GameController.prototype.onGetRewards=function(){console.log("rewards:get")},GameController.prototype.onGamePause=function(){GameData.paused=!0},GameController.prototype.onGameResume=function(){GameData.paused=!1},GameController.prototype.onMouseDown=function(){GameData.paused&&gameControllerSelf.app.fire("game:unpause")},GameController.prototype.subscribeToVisibilityChange=function(){var e=function(){this.app.isHidden()?GameData.paused||this.app.fire("game:pause"):GameData.paused&&this.app.fire("game:unpause")}.bind(this);void 0!==document.hidden?document.addEventListener("visibilitychange",e,!1):void 0!==document.mozHidden?document.addEventListener("mozvisibilitychange",e,!1):void 0!==document.msHidden?document.addEventListener("msvisibilitychange",e,!1):void 0!==document.webkitHidden&&document.addEventListener("webkitvisibilitychange",e,!1),this.on("destroy",function(){document.removeEventListener("visibilitychange",e,!1),document.removeEventListener("mozvisibilitychange",e,!1),document.removeEventListener("msvisibilitychange",e,!1),document.removeEventListener("webkitvisibilitychange",e,!1)}.bind(this))};var playerControllerSelf,PlayerController=pc.createScript("playerController");PlayerController.attributes.add("gameController",{type:"entity"}),PlayerController.attributes.add("showBotSubscribeFrequency",{type:"number",default:5});var PlayerData={playerName:"FooBar",sound:!1,canSubscribeToBot:!0,botSubscription:!1,botInvitesCounter:0,collectionsProgress:[],completedLevels:0,shortcutCreated:!1,sessionData:{},stats:{},dataKeys:["progress","sound","bot","botInvitesCount","shortcut","stats"],firstSession:!1,totalLevels:0},CollectionItemState={Locked:0,ReadyToUnlock:1,Unlocked:2,Completed:3};function getTotalProgress(){return DEBUG?1:PlayerData.completedLevels/PlayerData.totalLevels}function isCollectionAvailable(e){return!!DEBUG||getCollectionState(e)>CollectionItemState.Locked}function getCollectionState(e){return DEBUG?CollectionItemState.Completed:PlayerData.collectionsProgress[e].state}function getLevelState(e,l){return DEBUG?playerControllerSelf.gameController.script.gameController.debugLevelState:PlayerData.collectionsProgress[e].levels[l].state}function isLevelAvailable(e,l){return!!DEBUG||PlayerData.collectionsProgress[e].state>CollectionItemState.Locked&&PlayerData.collectionsProgress[e].levels[l].state>CollectionItemState.Locked}function isLevelCompleted(e,l){return!!DEBUG||PlayerData.collectionsProgress[e].state>CollectionItemState.Locked&&PlayerData.collectionsProgress[e].levels[l].state==CollectionItemState.Completed}PlayerController.prototype.initialize=function(){playerControllerSelf=this,PlayerData.stats=GlobalStats,this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:finish",this.onGameFinish),this.app.on("set:sound",this.onSetSound),this.app.on("bot:subscribe:result",this.onSubscribeBotResult),this.app.on("collection.unlocked",this.unlockCollection),this.app.on("level.unlocked",this.unlockLevel),this.app.on("bot:subscribe:popup",this.onShowSubscribeBotPopup),this.app.on("store:purchases_received",this.restorePurchases)},PlayerController.prototype.restorePurchases=function(e){for(var l=[],o=0;o<e.length;o++)e[o].productID&&l.push(e[o].productID);var t=playerControllerSelf.gameController.script.gameController.collections.length;for(o=0;o<t;o++){var r=playerControllerSelf.gameController.script.gameController.collections[o].script.collectionConfig;r.lockType===CollectionLockReason.InAppPurchase&&l.includes(r.inAppProductID)&&playerControllerSelf.unlockCollection(o)}},PlayerController.prototype.onGameLoaded=function(e){if(PlayerData.playerName=FbApi.getPlayerName(),void 0!==e.sound&&(PlayerData.sound=e.sound),PlayerData.botSubscription=!0===e.bot,PlayerData.botSubscription?PlayerData.canSubscribeToBot=!1:FbApi.canSubscribeBot(function(e){PlayerData.canSubscribeToBot=e}),void 0===e.progress&&(e.progress=[],PlayerData.firstSession=!0),void 0!==e.botInvitesCount&&(PlayerData.botInvitesCounter=e.botInvitesCount),void 0!==e.stats)for(var l in e.stats)PlayerData.stats[l]=e.stats[l];e.shortcut&&(PlayerData.shortcutCreated=e.shortcut);for(var o=playerControllerSelf.gameController.script.gameController.collections.length,t=0;t<o;t++){var r=playerControllerSelf.gameController.script.gameController.collections[t].script.collectionConfig,a=e.progress[t],n=void 0;switch(void 0!==a?n=playerControllerSelf.decodeCollectionState(a,r):(n=playerControllerSelf.createDefaultCollectionState(r)).state>CollectionItemState.Locked&&playerControllerSelf.unlockCollectionLevels(n,r),r.collectionType){case CollectionType.Gifts:PlayerData.botSubscription&&n.state===CollectionItemState.Locked&&(n.state=CollectionItemState.Unlocked,playerControllerSelf.unlockCollectionLevels(n,r))}PlayerData.collectionsProgress.push(n),PlayerData.totalLevels+=n.levels.length}GameData.selectedCollectionIndex=void 0,playerControllerSelf.handleEntryPointData(),GameData.selectedCollectionIndex||(GameData.selectedCollectionIndex=playerControllerSelf.findLastAvailableCollectionIndex()),playerControllerSelf.app.fire("collections:update"),PlayerData.firstSession||PlayerData.shortcutCreated||FbApi.canCreateShortcut(function(e){e&&FbApi.createShortcut(function(e){e&&(PlayerData.shortcutCreated=!0,FbApi.savePlayerData({shortcut:!0}))})}),playAmbientAudio()},PlayerController.prototype.decodeCollectionState=function(e,l){for(var o=3&e,t=l.levels.length,r={state:o,levels:[],totalLevels:t},a=0;a<t;a++){var n=2*(a+1),i=(e&3<<n)>>n;i===CollectionItemState.Completed&&PlayerData.completedLevels++,r.levels.push({state:i})}return r},PlayerController.prototype.encodeCollectionsProgresses=function(){for(var e=PlayerData.collectionsProgress,l=[],o=0;o<e.length;o++)l[o]=this.encodeCollectionState(e[o]);return{progress:l}},PlayerController.prototype.encodeCollectionState=function(e){for(var l=e.totalLevels,o=e.state,t=0;t<l;t++){var r=2*(t+1);o|=e.levels[t].state<<r}return o},PlayerController.prototype.createDefaultCollectionState=function(e){for(var l=e.levels.length,o={state:e.lockType==CollectionLockReason.None?CollectionItemState.Unlocked:CollectionItemState.Locked,levels:[],totalLevels:l},t=0;t<l;t++){e.levels[t].script.levelConfig;o.levels.push({state:CollectionItemState.Locked})}return o},PlayerController.prototype.defineDefaultLevelState=function(e,l,o){if(l.isAdUnlock)return CollectionItemState.Locked;switch(o.collectionType){case CollectionType.Regular:return l.isBoss?CollectionItemState.Locked:CollectionItemState.Unlocked;case CollectionType.Tutorial:case CollectionType.Gifts:return 0===e?CollectionItemState.Unlocked:CollectionItemState.Locked}},PlayerController.prototype.handleEntryPointData=function(){var e=FbApi.getEntryPointData();if(e){var l=e.giftItemId;if(l)playerControllerSelf.unlockGiftLevel(l)&&(PlayerData.sessionData.receivedGiftId=l,FbApi.setSessionData(PlayerData.sessionData),playerControllerSelf.saveCollectionsProgress(),GameData.selectedCollectionIndex=playerControllerSelf.getGiftCollectionId(),playerControllerSelf.app.fire("gift:received:popup"))}},PlayerController.prototype.onGameFinish=function(e,l){if(playerControllerSelf.updateCollectionProgress(e,l)){playerControllerSelf.saveCollectionsProgress();var o=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig.levels[l].script.levelConfig;!PlayerData.botSubscription&&PlayerData.canSubscribeToBot&&o.isBotInvite&&(GameData.showBotInvite=!0),o.isInterstitialFinish&&(GameData.showLevelFinishAds=!0)}},PlayerController.prototype.saveCollectionsProgress=function(e,l){var o=playerControllerSelf.encodeCollectionsProgresses();FbApi.savePlayerData(o)},PlayerController.prototype.updateCollectionProgress=function(e,l){if(isLevelCompleted(e,l))return!1;PlayerData.completedLevels++,PlayerData.collectionsProgress[e].levels[l].state=CollectionItemState.Completed;var o=PlayerData.collectionsProgress[e],t=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig;switch(t.collectionType){case CollectionType.Regular:t.levels[l].script.levelConfig.isBoss?(playerControllerSelf.checkAndUnlockNextCollection(e),playerControllerSelf.app.fire("collection.completed",e)):playerControllerSelf.countCollectionCompletedLevels(o)==o.totalLevels-1&&playerControllerSelf.unlockLevel(e,playerControllerSelf.getBossLevelIndex(t),"progress");break;case CollectionType.Tutorial:l+1>=o.totalLevels?(playerControllerSelf.checkAndUnlockNextCollection(e),playerControllerSelf.app.fire("collection.completed",e)):playerControllerSelf.unlockLevel(e,l+1,"progress");break;case CollectionType.Gifts:}return playerControllerSelf.app.fire("collections:update"),playerControllerSelf.app.fire("level:completed",e,l),!0},PlayerController.prototype.getBossLevelIndex=function(e){for(var l=e.levels.length,o=0;o<l;o++)if(e.levels[o].script.levelConfig.isBoss)return o;return-1},PlayerController.prototype.countCollectionCompletedLevels=function(e){for(var l=e.levels.length,o=0,t=0;t<l;t++)e.levels[t].state==CollectionItemState.Completed&&o++;return o},PlayerController.prototype.checkAndUnlockNextCollection=function(e){var l=e+1;void 0!==PlayerData.collectionsProgress[l]&&(isCollectionAvailable(l)||playerControllerSelf.gameController.script.gameController.collections[l].script.collectionConfig.lockType===CollectionLockReason.PreviousCollection&&playerControllerSelf.prepareCollectionToUnlock(l))},PlayerController.prototype.prepareCollectionToUnlock=function(e){PlayerData.collectionsProgress[e].state=CollectionItemState.ReadyToUnlock,playerControllerSelf.saveCollectionsProgress(),playerControllerSelf.app.fire("collection.ready_to_unlock",e)},PlayerController.prototype.unlockCollection=function(e){var l=PlayerData.collectionsProgress[e];if(!(l.state>CollectionItemState.ReadyToUnlock)){l.state=CollectionItemState.Unlocked;var o=playerControllerSelf.gameController.script.gameController.collections[e].script.collectionConfig;playerControllerSelf.unlockCollectionLevels(l,o),playerControllerSelf.saveCollectionsProgress(),o.showVideoOnUnlock&&FbApi.showRewardedVideo(function(){},function(){},"unlock_collection")}},PlayerController.prototype.unlockLevel=function(e,l,o){var t=PlayerData.collectionsProgress[e].levels[l];t.state>CollectionItemState.ReadyToUnlock||(t.state=CollectionItemState.Unlocked,playerControllerSelf.saveCollectionsProgress(),playerControllerSelf.app.fire("figure:unlocked",e,l,o))},PlayerController.prototype.unlockCollectionLevels=function(e,l){for(var o=e.totalLevels,t=0;t<o;t++){var r=l.levels[t].script.levelConfig;e.levels[t].state=playerControllerSelf.defineDefaultLevelState(t,r,l)}},PlayerController.prototype.unlockGiftCollection=function(){GameData.selectedCollectionIndex=playerControllerSelf.getGiftCollectionId(),playerControllerSelf.unlockCollection(GameData.selectedCollectionIndex),playerControllerSelf.app.fire("collections:update")},PlayerController.prototype.getGiftCollectionId=function(){for(var e=playerControllerSelf.gameController.script.gameController.collections.length,l=0;l<e;l++){if(playerControllerSelf.gameController.script.gameController.collections[l].script.collectionConfig.collectionType==CollectionType.Gifts)return l}},PlayerController.prototype.unlockGiftLevel=function(e){if(e<=0)return!1;var l=playerControllerSelf.getGiftCollectionId();return!!isLevelAvailable(l,e-1)&&(!isLevelAvailable(l,e)&&(playerControllerSelf.unlockLevel(l,e,"bot_gift"),playerControllerSelf.app.fire("collections:update"),!0))},PlayerController.prototype.onSetSound=function(e){PlayerData.sound=e,FbApi.savePlayerData({sound:e}),e?playAmbientAudio():stopAllAudios()},PlayerController.prototype.onSubscribeBotResult=function(e,l){!e&&l&&(PlayerData.botSubscription=!0,FbApi.savePlayerData({bot:!0}),playerControllerSelf.unlockGiftCollection())},PlayerController.prototype.onShowSubscribeBotPopup=function(e){switch(e){case BotSubscriptionType.First:case BotSubscriptionType.Repeated:PlayerData.botInvitesCounter++,FbApi.savePlayerData({botInvitesCount:PlayerData.botInvitesCounter})}},PlayerController.prototype.findLastAvailableCollectionIndex=function(){for(var e=0,l=this.gameController.script.gameController.collections,o=0;o<l.length;o++){switch(l[o].script.collectionConfig.collectionType){case CollectionType.Tutorial:case CollectionType.Regular:isCollectionAvailable(o)&&(e=o)}}return e};var proxy,AnalyticsController=pc.createScript("analyticsController");AnalyticsController.prototype.initialize=function(){proxy=this,store.get("user_id")||store.set("user_id",uuid.v4()),EventLogger._producer=EventLogger._createEventProducer(),this.figureStats=store.get("figure_stats")||{},this.app.on("game:loaded",function(){EventLogger._setupFbLogger(),sbjs.init()}.bind(this)),this.app.on("game:pause",function(){1===GlobalStats.sessionCount&&EventLogger.logEvent("RETENTION_M10",{minute:Math.min(Math.round(SessionStats.sessionTime/60),10)}),EventLogger.logEvent("SESSION_END"),GlobalStats.playedTime+=SessionStats.sessionTime,SessionStats.sessionTime=0,FbApi.savePlayerData({stats:GlobalStats}),store.set("figure_stats",this.figureStats)}.bind(this)),this.app.on("game:unpause",function(){GlobalStats.sessionCount++,FbApi.savePlayerData({stats:GlobalStats}),EventLogger.logEvent("SESSION_START",{trfTyp:sbjs.get.current.typ,trfSrc:sbjs.get.current.src,trfMdm:sbjs.get.current.mdm,trfCmp:sbjs.get.current.cmp,trfCnt:sbjs.get.current.cnt,trfTrm:sbjs.get.current.trm})}.bind(this)),this.app.on("game:finish",function(t,e){GlobalStats.puzzlesCount++;var n=this.getLevelStats(t,e);EventLogger.logEvent("PUZZLE_FINISHED",{attempt:n.attempt,timeSpent:Math.floor(1e3*(SessionStats.sessionTime-SessionStats.puzzleStartTime)),stepsCount:SessionStats.puzzleSteps}),FbApi.savePlayerData({stats:GlobalStats})}.bind(this)),this.app.on("ads:watched",function(t){GlobalStats.adsWatched++,EventLogger.logEvent("ADS_WATCHED",t),FbApi.savePlayerData({stats:GlobalStats})}.bind(this)),this.app.on("bot:subscribe:result",function(t,e){GlobalStats.botAttempt++,EventLogger.logEvent("BOT_SUBSCRIBE",{result:e,attempt:GlobalStats.botAttempt}),FbApi.savePlayerData({stats:GlobalStats})}.bind(this)),this.app.on("fb:share",function(){GlobalStats.botAttempt++,EventLogger.logEvent("FIGURE_SHARED")}.bind(this)),this.app.on("store:purchase",function(t){EventLogger.logEvent("INAPP_PURCHASE",{productId:t.productID,usPrice:PurchasePrice[t.productID]||PurchasePrice.default})}.bind(this)),this.app.on("tutorial:level:completed",function(t,e){EventLogger.logEvent("TUTORIAL_STEP_COMPLETED",{stepNumber:DefaultParams.level()})}.bind(this)),this.app.on("figure:unlocked",function(t,e,n){EventLogger.logEvent("FIGURE_UNLOCKED",{figureIndex:e,collectionIndex:t,context:n})}.bind(this)),this.app.on("game:start",function(t,e,n,s){var r=this.getLevelStats(n,s);r.attempt++,SessionStats.puzzleSteps=0,SessionStats.puzzleStartTime=SessionStats.sessionTime,EventLogger.logEvent("PUZZLE_STARTED",{figureIndex:s,collectionIndex:n,attempt:r.attempt})}.bind(this)),this.app.on("game:fragment:snapped",function(){SessionStats.puzzleSteps++}.bind(this)),this.app.on("button:clicked",function(t){EventLogger.logEvent("UI_OPENED",{viewOpened:t,previousView:SessionStats.currentUi}),SessionStats.currentUi=t}.bind(this))},AnalyticsController.prototype.getLevelStats=function(t,e){var n=this.figureStats;n[t]||(n[t]={});var s=n[t];return s[e]||(s[e]={}),s[e].attempt||(s[e].attempt=0),s[e]},AnalyticsController.prototype.update=function(t){SessionStats.sessionTime+=t};var SessionStats={sessionTime:0,countryCode:null,puzzleStartTime:0,puzzleSteps:0,currentUi:"MainGallery"},GlobalStats={playedTime:0,sessionCount:0,puzzlesCount:0,adsWatched:0,botAttempt:0},EventLogger={_producer:null,_fbProducer:null,_userId:"",logEvent:function(t,e){e=EventLogger._getDefaultParams(e),EventLogger._fbProducer&&EventLogger._fbProducer.logEvent(t,null,e),e=EventLogger._getKafkaParams(e,t),EventLogger._producer.send(e)},_getDefaultParams:function(t){for(var e in t||(t={}),DefaultParams)t[e]=DefaultParams[e]();return t},_getKafkaParams:function(t,e){for(var n in t||(t={}),t.type=e,KafkaParams)t[n]=KafkaParams[n]();return t},_createEventProducer:function(){return new EventProducer({endpoint:"ec2-52-55-165-80.compute-1.amazonaws.com",topic:"fracturez_"+GameData.buildType,user:"rnd-user",pasw:"go7shi2raeCh+e7"})},_setupFbLogger:function(){EventLogger._fbProducer="FBInstant"in window?FBInstant:null,EventLogger._userId=EventLogger._fbProducer?FBInstant.player.getID():store.get("user_id")}},KafkaParams={ts:function(){return(new Date).getTime()},country:function(){return SessionStats.countryCode},lang:function(){return platform.lang},os:function(){return platform.os.family},osVer:function(){return platform.os.ver}},DefaultParams={appVer:function(){return GameData.buildVersion},playedTime:function(){return Math.floor(1e3*(GlobalStats.playedTime+SessionStats.sessionTime))},sessionTime:function(){return Math.floor(1e3*SessionStats.sessionTime)},userId:function(){return EventLogger._userId},lastCollection:function(){return GameData.currentCollectionIndex+1},lastFigure:function(){return GameData.currentLevelIndex+1},debug:function(){return DEBUG},sumPaid:function(){return FbApi.getPurchaseSum()},countPaid:function(){return FbApi.purchases.length},adsWatched:function(){return GlobalStats.adsWatched},totalProgress:function(){return getTotalProgress()},sessionIndex:function(){return GlobalStats.sessionCount},trafficSource:function(){},advertisingId:function(){return EventLogger._userId},puzzlesCount:function(){return GlobalStats.puzzlesCount},level:function(){return PlayerData.completedLevels},fps:function(){return proxy.app.stats.frame.fps}};window.onanyerror=function(t,e,n,s,r){if(t instanceof XMLHttpRequest)t.status,t.responseURL;else if(t instanceof Event){var o=t.currentTarget;o.responseText,o.statusText,o.readyState}else t||(t="unknown"),e||(e="unknown"),n||(n="unknown"),s||(s="unknown"),EventLogger.logEvent("ERROR",{msg:t,url:e.substring(0,e.indexOf("?",0)),pos:[n,s]})};var playFabControllerSelf,PlayFabController=pc.createScript("playFabController");PlayFabController.prototype.initialize=function(){playFabControllerSelf=this,PlayFab.settings.titleId="F07D",this.app.on("game:loaded",this.loginToPlayfab)},PlayFabController.prototype.loginToPlayfab=function(a){FbApi.getPlayerSignature(function(a){null!==a?PlayFabClientSDK.LoginWithFacebookInstantGamesId({FacebookInstantGamesSignature:a,CreateAccount:!0,InfoRequestParameters:{GetPlayerProfile:!0,ProfileConstraints:{ShowDisplayName:!1,ShowCreated:!1,ShowOrigination:!1,ShowLastLogin:!1,ShowBannedUntil:!1,ShowStatistics:!1,ShowCampaignAttributions:!1,ShowPushNotificationRegistrations:!1,ShowLinkedAccounts:!1,ShowContactEmailAddresses:!1,ShowTotalValueToDateInUsd:!1,ShowValuesToDate:!1,ShowVirtualCurrencyBalances:!1,ShowTags:!1,ShowLocations:!0,ShowAvatarUrl:!1,ShowMemberships:!1}}},playFabControllerSelf.onPlayFabLoginResponse):playFabControllerSelf.sendLocationEvent(void 0)})},PlayFabController.prototype.onPlayFabLoginResponse=function(a,o){if(playFabControllerSelf.onPlayFabResponse(a,o),a){var e=a.data;e.NewlyCreated&&(PlayFabClientSDK.UpdateUserTitleDisplayName({DisplayName:FbApi.getPlayerName()},playFabControllerSelf.onPlayFabResponse),PlayFabClientSDK.UpdateAvatarUrl({ImageUrl:FbApi.getPlayerAvatar()},playFabControllerSelf.onPlayFabResponse)),e.InfoResultPayload&&e.InfoResultPayload.PlayerProfile&&e.InfoResultPayload.PlayerProfile.Locations&&e.InfoResultPayload.PlayerProfile.Locations[0]}playFabControllerSelf.sendLocationEvent()},PlayFabController.prototype.onPlayFabResponse=function(a,o){},PlayFabController.prototype.sendLocationEvent=function(a){playFabControllerSelf.app.fire("player:location",a)};var Fbcontroller=pc.createScript("fbcontroller");Fbcontroller.prototype.postInitialize=function(){"FBInstant"in window?FBState.initialized?this.startFBGame():this.app.on("fb:initialized",this.startFBGame.bind(this)):FbApi.fireGameLoaded({},this.app)},Fbcontroller.prototype.startFBGame=function(){FbApi.startGame(this.app)};var PurchasePrice={default:.99,exclusive_pack_1:.99},FbApi={initialized:!1,app:null,supportedAPIs:null,entryPoint:null,REWARDED_VIDEO_PLACEMENT:"1045588595649752_1048424095366202",INTERSTITIAL_AD_PLACEMENT:"1045588595649752_1048423892032889",interstitialAdInstance:null,interstitialAdAvailable:!1,rewardedVideoInstance:null,rewardedVideoAvailable:!1,billingAvailable:!1,storeCatalog:[],purchases:[],startGame:function(t){FBInstant.startGameAsync().then(function(){FbApi.initialized=!0,FbApi.app=t,FbApi.getSupportedAPIs(),FbApi.onPause(),FbApi.getAllPlayerData(function(e){FbApi.fireGameLoaded(e,t)}),FbApi.setupBilling(function(t){FbApi.getStoreCatalogAsync(),FbApi.getPurchasesAsync()})}).catch(function(t){console.error("startGameAsync: "+t.message)})},fireGameLoaded:function(t,e){e.fire("game:loaded",t),e.fire("game:unpause")},getPlayerSignature:function(t){FbApi.initialized?FBInstant.player.getSignedPlayerInfoAsync(FbApi.getPlayerID()).then(function(e){t(e.getSignature())}):t(null)},getSupportedAPIs:function(){if(FbApi.initialized)try{FbApi.supportedAPIs=FBInstant.getSupportedAPIs()}catch(t){FbApi.supportedAPIs=null}},isApiSupported:function(t){return!!FbApi.initialized&&FbApi.supportedAPIs.indexOf(t)>-1},onPause:function(){FbApi.initialized&&FBInstant.onPause(function(){console.debug("FB Game Paused"),FbApi.app.fire("game:pause")})},getPlayerID:function(){return FbApi.initialized?FBInstant.player.getID():"42"},getPlayerName:function(){return FbApi.initialized?FBInstant.player.getName():"Player"},getPlayerAvatar:function(){return FbApi.initialized?FBInstant.player.getPhoto():null},getConnectedPlayers:function(){FbApi.initialized?FBInstant.player.getConnectedPlayersAsync().then(function(t){FbApi.app.fire("fb:connectedPlayers",t)}):FbApi.app.fire("fb:connectedPlayers",{})},getAllPlayerData:function(t){FbApi.initialized?FBInstant.player.getDataAsync(PlayerData.dataKeys).then(function(e){console.log("player fb data: "+JSON.stringify(e)),t(e)}).catch(function(e){console.error("getDataAsync: "+e.message),t({})}):t({})},savePlayerData:function(t){FbApi.initialized&&FBInstant.player.setDataAsync(t).then(function(){console.log("PlayerDataSaved = "+JSON.stringify(t))}).catch(function(t){console.error("setDataAsync: "+t.message)})},resetPlayerData:function(){FbApi.initialized&&FbApi.savePlayerData({progress:[],botInvitesCount:0,shortcut:!1})},getLocale:function(){return FbApi.initialized?FBInstant.getLocale():null},getPlatform:function(){return FbApi.initialized?FBInstant.getPlatform():null},getSDKVersion:function(){return FbApi.initialized?FBInstant.getSDKVersion():null},getEntryPointData:function(){return FbApi.initialized?FBInstant.getEntryPointData():{}},getEntryPointAsync:function(){if(FbApi.initialized)try{FBInstant.getEntryPointAsync().then(function(t){console.debug("FBInstant.getEntryPointAsync",t),FbApi.entryPoint=t})}catch(t){}},getContextID:function(){return FbApi.initialized?FBInstant.context.getID():null},getContextType:function(){return FbApi.initialized?FBInstant.context.getType():"SOLO"},loadInterstitialAd:function(){FbApi.initialized&&FbApi.isApiSupported("getInterstitialAdAsync")&&(FbApi.interstitialAdAvailable||FBInstant.getInterstitialAdAsync(FbApi.INTERSTITIAL_AD_PLACEMENT).then(function(t){return console.log("getInterstitialAdAsync OK"),FbApi.interstitialAdInstance=t,t.loadAsync()}).then(function(){console.log("interstitialAd loadAsync OK"),FbApi.interstitialAdAvailable=!0}).catch(function(t){console.error("getInterstitialAdAsync: "+t.message)}))},showInterstitialAd:function(t,e,n){console.log("try show int ads"),FbApi.initialized&&(FbApi.interstitialAdAvailable?FbApi.interstitialAdInstance.showAsync().then(function(){console.log("Interstitial ad finished successfully"),FbApi.interstitialAdAvailable=!1,FbApi.interstitialAdInstance=null,FbApi.loadInterstitialAd(),FbApi.app.fire("ads:watched",{type:"interstitial",context:n}),t()}).catch(function(t){console.error("interstitial.showAsync: "+t.message),e()}):(console.error("interstitial ads not available: "),e()))},loadRewardedVideo:function(){FbApi.initialized&&FbApi.isApiSupported("getRewardedVideoAsync")&&(FbApi.rewardedVideoAvailable||FBInstant.getRewardedVideoAsync(FbApi.REWARDED_VIDEO_PLACEMENT).then(function(t){return console.log("getRewardedVideoAsync OK"),FbApi.rewardedVideoInstance=t,t.loadAsync()}).then(function(){console.log("rewarded video loadAsync OK"),FbApi.rewardedVideoAvailable=!0}).catch(function(t){console.error("getRewardedVideoAsync: "+t.message)}))},showRewardedVideo:function(t,e,n){console.log("try show rewarded video"),FbApi.initialized&&(FbApi.rewardedVideoAvailable?FbApi.rewardedVideoInstance.showAsync().then(function(){console.log("rewardedVideo finished successfully"),FbApi.rewardedVideoAvailable=!1,FbApi.rewardedVideoInstance=null,FbApi.loadRewardedVideo(),FbApi.app.fire("ads:watched",{type:"video",context:n}),t()}).catch(function(t){console.error("rewardedVideo.showAsync: "+t.message),e()}):(console.error("rewardedVideo not available: "),e()))},shareGameResult:function(t,e,n,i){FbApi.initialized&&FBInstant.shareAsync({intent:"SHARE",image:t,text:e,data:{myReplayData:"..."}}).then(function(){FbApi.app.fire("fb:share"),n()}).catch(function(t){console.error("shareAsync: "+t.message),i()})},canSubscribeBot:function(t){FbApi.initialized&&FbApi.isApiSupported("player.canSubscribeBotAsync")?FBInstant.player.canSubscribeBotAsync().then(function(e){t(e)}).catch(function(e){"INVALID_OPERATION"===e.code&&FbApi.savePlayerData({bot:!0}),t(!1)}):t(!1)},subscribeBot:function(t){FbApi.initialized&&FbApi.isApiSupported("player.subscribeBotAsync")?FBInstant.player.subscribeBotAsync().then(function(){t(!0)}).catch(function(e){t(!1)}):t(!1)},checkAndSubscribeBot:function(){FbApi.canSubscribeBot(function(t){console.log("canSubscribeBot: "+t),t&&FbApi.subscribeBot(function(t){FbApi.app.fire("bot:subscribe:result",PlayerData.botSubscription,t)})})},setSessionData:function(t){FbApi.initialized&&FBInstant.setSessionData(t)},chooseAsync:function(t,e){FbApi.initialized&&FbApi.isApiSupported("context.chooseAsync")?FBInstant.context.chooseAsync({maxSize:2}).then(function(e,n){t(FBInstant.context.getID())}).catch(function(t){console.error("chooseAsync: "+t.message),e()}):e()},canCreateShortcut:function(t){FbApi.initialized&&FbApi.isApiSupported("canCreateShortcutAsync")?FBInstant.canCreateShortcutAsync().then(function(e){t(e)}).catch(function(t){console.error("canCreateShortcutAsync: "+t.message)}):t(!1)},createShortcut:function(t){FbApi.initialized&&FbApi.isApiSupported("createShortcutAsync")?FBInstant.createShortcutAsync().then(function(){t(!0)}).catch(function(e){t(!1)}):t(!1)},setupBilling:function(t){if(!FbApi.initialized||!FbApi.isApiSupported("payments.purchaseAsync"))return console.log("billing not available"),void(t&&t(!1));FBInstant.payments.onReady(function(){console.log("Payments Ready!"),FbApi.billingAvailable=!0,FbApi.app.fire("store:billing_ready"),t&&t(!0)})},getStoreCatalogAsync:function(t){FbApi.billingAvailable?FBInstant.payments.getCatalogAsync().then(function(e){FbApi.storeCatalog=e,FbApi.app.fire("store:catalog_received",e),t&&t(e),console.log(e)}).catch(function(e){console.error(e),t&&t(null)}):(console.log("billing not available"),t&&t(null))},purchaseAsync:function(t,e,n){FbApi.billingAvailable?FBInstant.payments.purchaseAsync({productID:t,developerPayload:e}).then(function(t){console.log("purchaseAsync: "+t),FbApi.getStoreCatalogAsync(),FbApi.getPurchasesAsync(),FbApi.app.fire("store:purchase",t),n&&n(t)}).catch(function(t){console.error("purchaseAsync error: "+JSON.stringify(t)),n&&n(null)}):(console.log("billing not available"),n&&n(null))},getPurchasesAsync:function(t){FbApi.billingAvailable?FBInstant.payments.getPurchasesAsync().then(function(e){FbApi.purchases=e,FbApi.app.fire("store:purchases_received",e),console.log("getPurchasesAsync: "+e),t&&t(e)}).catch(function(e){console.error(e),t&&t(null)}):(console.log("billing not available"),t&&t(null))},consumePurchaseAsync:function(t,e){FbApi.billingAvailable?FBInstant.payments.consumePurchaseAsync(t).then(function(){console.log(t+" CONSUMED"),e&&e(t,!0)}).catch(function(n){console.error(n),e&&e(t,!1)}):(console.log("billing not available"),e&&e(t,!1))},getPurchaseSum:function(){for(var t=0,e=FbApi.purchases,n=0;n<e.length;n++)t+=PurchasePrice[e[n].productID]||PurchasePrice.default;return t}};var uiControllerSelf,Uicontroller=pc.createScript("uicontroller");Uicontroller.attributes.add("gameController",{type:"entity"}),Uicontroller.attributes.add("loadingScreen",{type:"entity"}),Uicontroller.attributes.add("galleryScreen",{type:"entity"}),Uicontroller.attributes.add("gameScreen",{type:"entity"}),Uicontroller.attributes.add("rewardsScreen",{type:"entity"}),Uicontroller.attributes.add("subscribeBotPopup",{type:"entity"}),Uicontroller.attributes.add("botThanksPopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByPrevCollectionPopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByInAppPurchasePopup",{type:"entity"}),Uicontroller.attributes.add("collectionLockedByBotSubscriptionPopup",{type:"entity"}),Uicontroller.attributes.add("collectionUnlockedPopup",{type:"entity"}),Uicontroller.attributes.add("levelLockedPopup",{type:"entity"}),Uicontroller.attributes.add("giftLevelLockedPopup",{type:"entity"}),Uicontroller.attributes.add("giftReceivedPopup",{type:"entity"}),Uicontroller.prototype.initialize=function(){this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:start",this.onGameStart),this.app.on("game:finish",this.onGameFinish),this.app.on("game:stop",this.onGameStop),this.app.on("game:replay",this.onGameStart),this.app.on("rewards:get",this.onGotRewards),this.app.on("collection.ready_to_unlock",this.onCollectionReadyToUnlock),this.app.on("bot:subscribe:popup",this.showSubscribeBotPopup),this.app.on("bot:subscribe:result",this.onSubscribeBotResult),this.app.on("collection:locked:popup:hide",this.hideCollectionLockedActivePopup),this.app.on("collection:locked:popup:show",this.showCollectionLockedPopup),this.app.on("collection:unlocked:popup:show",this.showCollectionUnlockedPopup),this.app.on("level:locked:popup:show",this.showLevelLockedPopup),this.app.on("gift:received:popup",this.showGiftReceivedPopup),this.currentScreen=null,(uiControllerSelf=this).onGame=!1,this.showScreen(this.loadingScreen)},Uicontroller.prototype.onGameLoaded=function(o){uiControllerSelf.onGame||uiControllerSelf.showScreen(uiControllerSelf.galleryScreen)},Uicontroller.prototype.onGameStart=function(o,e){uiControllerSelf.showScreen(uiControllerSelf.gameScreen),uiControllerSelf.onGame=!0},Uicontroller.prototype.onGameFinish=function(){uiControllerSelf.showScreen(uiControllerSelf.rewardsScreen)},Uicontroller.prototype.onGameStop=function(){uiControllerSelf.showScreen(uiControllerSelf.galleryScreen)},Uicontroller.prototype.onGotRewards=function(){if(uiControllerSelf.showScreen(uiControllerSelf.galleryScreen),GameData.showBotInvite){GameData.showBotInvite=!1;var o=BotSubscriptionType.Repeated;0===PlayerData.botInvitesCounter&&(o=BotSubscriptionType.First),uiControllerSelf.app.fire("bot:subscribe:popup",o)}GameData.showLevelFinishAds&&(GameData.showLevelFinishAds=!1,FbApi.showInterstitialAd(function(){},function(){},"level_finish_ads")),uiControllerSelf.collectionToUnlockIndex&&(uiControllerSelf.showCollectionUnlockedPopup(uiControllerSelf.collectionToUnlockIndex,!0),uiControllerSelf.collectionToUnlockIndex=void 0)},Uicontroller.prototype.onCollectionReadyToUnlock=function(o){uiControllerSelf.collectionToUnlockIndex=o},Uicontroller.prototype.showScreen=function(o){if(this.currentScreen){if(this.currentScreen===o)return;this.hideScreen(this.currentScreen)}this.currentScreen=o,o.enabled=!0},Uicontroller.prototype.hideScreen=function(o){this.currentScreen.enabled=!1,this.currentScreen=null},Uicontroller.prototype.showSubscribeBotPopup=function(o){switch(o){case BotSubscriptionType.First:uiControllerSelf.subscribeBotPopup.script.botPopupController.setFirstBotReplica();break;case BotSubscriptionType.Repeated:uiControllerSelf.subscribeBotPopup.script.botPopupController.setRepeatedBotReplica();break;case BotSubscriptionType.Manual:uiControllerSelf.subscribeBotPopup.script.botPopupController.setManualBotReplica()}uiControllerSelf.subscribeBotPopup.enabled=!0,playPopupAudio()},Uicontroller.prototype.onSubscribeBotResult=function(o,e){!o&&e&&(uiControllerSelf.botThanksPopup.enabled=!0,playPopupAudio())},Uicontroller.prototype.hideCollectionLockedActivePopup=function(){uiControllerSelf.activeCollectionLockedPopup&&(uiControllerSelf.activeCollectionLockedPopup.enabled=!1)},Uicontroller.prototype.showCollectionLockedPopup=function(o){switch(o){case CollectionLockReason.None:uiControllerSelf.activeCollectionLockedPopup=void 0;break;case CollectionLockReason.PreviousCollection:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByPrevCollectionPopup;break;case CollectionLockReason.InAppPurchase:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByInAppPurchasePopup;break;case CollectionLockReason.BotSubscription:uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionLockedByBotSubscriptionPopup}uiControllerSelf.activeCollectionLockedPopup&&(uiControllerSelf.activeCollectionLockedPopup.enabled=!0)},Uicontroller.prototype.showLevelLockedPopup=function(o){switch(o){case CollectionType.Regular:case CollectionType.Tutorial:uiControllerSelf.levelLockedPopup.enabled=!0;break;case CollectionType.Gifts:uiControllerSelf.giftLevelLockedPopup.enabled=!0}playPopupAudio()},Uicontroller.prototype.showCollectionUnlockedPopup=function(o,e){uiControllerSelf.activeCollectionLockedPopup=uiControllerSelf.collectionUnlockedPopup,uiControllerSelf.collectionUnlockedPopup.script.collectionUlockedPopup.collectionIndex=o,uiControllerSelf.collectionUnlockedPopup.script.collectionUlockedPopup.closeButton.enabled=e,uiControllerSelf.collectionUnlockedPopup.enabled=!0,playPopupAudio()},Uicontroller.prototype.showGiftReceivedPopup=function(){uiControllerSelf.giftReceivedPopup.enabled=!0,playPopupAudio()};var tutorialControllerSelf,TutorialController=pc.createScript("tutorialController");function isTutorialLevel(t,e){for(var r=tutorialControllerSelf.rewardSteps,l=0;l<r.length;l++){var o=r[l].script.tutorialRewardStep;if(o.collectionIndex===t&&o.levelIndex===e)return!0}return!1}TutorialController.attributes.add("gameController",{type:"entity"}),TutorialController.attributes.add("tutorialLevelScreen",{type:"entity"}),TutorialController.attributes.add("tutorialRewardScreen",{type:"entity"}),TutorialController.attributes.add("tutorialGalleryScreen",{type:"entity"}),TutorialController.attributes.add("gallerySteps",{type:"entity",array:!0}),TutorialController.attributes.add("levelSteps",{type:"entity",array:!0}),TutorialController.attributes.add("rewardSteps",{type:"entity",array:!0}),TutorialController.prototype.initialize=function(){tutorialControllerSelf=this,DEBUG?this.entity.enabled=!1:(this.app.on("game:loaded",this.onGameLoaded),this.app.on("game:start",this.onGameStart),this.app.on("game:finish",this.onGameFinish),this.app.on("game:stop",this.onGameStop),this.app.on("game:replay",this.onGameReplay),this.app.on("rewards:get",this.onGetRewards),this.app.on("level:completed",this.onLevelCompleted))},TutorialController.prototype.onGameLoaded=function(t){tutorialControllerSelf.checkStartGalleryStep()},TutorialController.prototype.onGameStart=function(t,e,r,l){tutorialControllerSelf.tutorialGalleryScreen.activeScreen&&(tutorialControllerSelf.tutorialGalleryScreen.activeScreen.enabled=!1);for(var o=tutorialControllerSelf.levelSteps,a=0;a<o.length;a++){var n=o[a].script.tutorialGameStep;if(n.collectionIndex===r&&n.levelIndex===l){tutorialControllerSelf.startTutorialLevelStep(n);break}}},TutorialController.prototype.startTutorialLevelStep=function(t){tutorialControllerSelf.tutorialLevelScreen.script.tutorialLevelScreen.active=!0,tutorialControllerSelf.tutorialLevelScreen.script.tutorialLevelScreen.userInputsAmount=t.userInputsAmount,tutorialControllerSelf.tutorialLevelScreen.enabled=!0},TutorialController.prototype.onGameFinish=function(t,e){for(var r=tutorialControllerSelf.rewardSteps,l=0;l<r.length;l++){var o=r[l].script.tutorialRewardStep;if(o.collectionIndex===t&&o.levelIndex===e){tutorialControllerSelf.startTutorialRewardStep(o);break}}},TutorialController.prototype.startTutorialRewardStep=function(t){tutorialControllerSelf.tutorialLevelScreen.enabled=!1;var e=tutorialControllerSelf.tutorialRewardScreen.script.tutorialRewardScreen;e.hintText.element.text=t.hint,tutorialControllerSelf.tutorialRewardScreen.enabled=!0,ImageUtils.tweenPos(e.hintTextPanel,e.startHintTextPos,e.hintTextPanel,e.hintAnimDuration,e.hintAnimDelay,pc.SineInOut,!1,!1)},TutorialController.prototype.onGameStop=function(){tutorialControllerSelf.tutorialLevelScreen.enabled=!1,tutorialControllerSelf.checkStartGalleryStep()},TutorialController.prototype.onGameReplay=function(t,e){tutorialControllerSelf.tutorialRewardScreen.enabled=!1,tutorialControllerSelf.onGameStart(t,e,GameData.currentCollectionIndex,GameData.currentLevelIndex)},TutorialController.prototype.onGetRewards=function(){tutorialControllerSelf.tutorialRewardScreen.enabled=!1,tutorialControllerSelf.checkStartGalleryStep()},TutorialController.prototype.checkStartGalleryStep=function(){for(var t=tutorialControllerSelf.gallerySteps,e=0;e<t.length;e++){var r=t[e].script.tutorialGalleryStep;if(!isLevelCompleted(r.collectionIndex,r.levelIndex)){tutorialControllerSelf.startTutorialGalleryStep(r);break}}},TutorialController.prototype.startTutorialGalleryStep=function(t){tutorialControllerSelf.tutorialLevelScreen.enabled=!1,tutorialControllerSelf.tutorialRewardScreen.enabled=!1,tutorialControllerSelf.tutorialGalleryScreen.activeScreen&&(tutorialControllerSelf.tutorialGalleryScreen.activeScreen.enabled=!1),tutorialControllerSelf.tutorialGalleryScreen.activeScreen=t.ui,t.ui.enabled=!0},TutorialController.prototype.onLevelCompleted=function(t,e){isTutorialLevel(t,e)&&tutorialControllerSelf.app.fire("tutorial:level:completed",t,e)};var PuzzleController=pc.createScript("puzzleController");PuzzleController.attributes.add("puzzleEntity",{type:"entity"}),PuzzleController.attributes.add("fracDistance",{type:"number",default:2}),PuzzleController.attributes.add("pairSearchGap",{type:"number",default:.01}),PuzzleController.attributes.add("gridSize",{type:"number",default:50}),PuzzleController.attributes.add("cellSizeGap",{type:"number",default:.2}),PuzzleController.attributes.add("bossSplit",{type:"number",default:3}),PuzzleController.attributes.add("partsDistance",{type:"number",default:40}),PuzzleController.attributes.add("difficulty",{type:"number",enum:[{easy_1:0},{easy_2:1}]}),PuzzleController.prototype.initialize=function(){this.localCenter=new pc.Vec3(0,0,0),this.puzzle=this.createPuzzle(),this.activePuzzle=this.puzzle,this.parts=[];for(var e=0;e<this.bossSplit;e++)this.parts.push(this.createPuzzle());this.usedCells=new HashSet,this.modelConfig=null,this.collectionConfig=null,this.ready=!1,this.cellSize=new pc.Vec3(0,0,0),this.tempVec3=new pc.Vec3(0,0,0),this.tempVec3_2=new pc.Vec3(0,0,0),this.tempVec3_3=new pc.Vec3(0,0,0),this.tempFrags=[],this.tempBb=new pc.BoundingBox,this.app.on("game:start",this.onGameStart.bind(this)),this.app.on("game:finish",this.onGameFinish.bind(this)),this.app.on("game:stop",this.onGameStop.bind(this)),this.app.on("game:replay",this.onGameReplay.bind(this)),this.app.on("rewards:get",this.onGetRewards.bind(this))},PuzzleController.prototype.resetData=function(){this.modelConfig&&this.modelConfig.model&&this.modelConfig.model.resource&&(this.puzzleEntity.model.model=null,this.modelConfig.model.unload(),this.app.batcher.generate()),this.cleanData(),this.modelConfig=null,this.ready=!1,console.log("resetData")},PuzzleController.prototype.load=function(e){e.ready(function(e){var t=this.puzzleEntity;t.model||t.addComponent("model"),t.model.model=e.resource,this.setup(),this.app.batcher.generate()}.bind(this)),this.app.assets.load(e)},PuzzleController.prototype.cleanData=function(){this.cleanPuzzle(this.puzzle);for(var e=0;e<this.parts.length;e++)this.cleanPuzzle(this.parts[e])},PuzzleController.prototype.setup=function(){this.cleanData(),this.findFragments(),this.resetPosition(this.puzzle,pc.Vec3.ZERO),this.findFragmentPairs(),this.computePuzzleGridSize(this.puzzle),this.configurePuzzle(),this.ready=!0,this.app.fire("game:ready")},PuzzleController.prototype.findFragments=function(){var e=this.puzzle.fragments,t=this.puzzleEntity.model.meshInstances;this.puzzle.meshes=t;for(var r=0;r<t.length;r++)t[r].material=r%2==0?this.collectionConfig.colorScheme.script.materialsConfig.baseMaterial.resource:this.collectionConfig.colorScheme.script.materialsConfig.fractureMaterial.resource,this.containsNode(t[r].node)||e.push(t[r])},PuzzleController.prototype.resetPosition=function(e,t){for(var r=e.fragments,a=0;a<r.length;a++)r[a].node.setLocalPosition(t)},PuzzleController.prototype.findFragmentPairs=function(){var e=this.puzzle.pairs,t=this.puzzle.fragments,r=[],a=0,o=0;for(a=0;a<t.length;a++){var n=[],i=t[a].mesh.vertexBuffer,s=new pc.VertexIterator(i),l=i.getNumVertices();for(o=0;o<l;o++){var h=s.element[pc.SEMANTIC_POSITION];n.push(new pc.Vec3(h.array[h.index],h.array[h.index+1],h.array[h.index+2])),s.next()}s.end(),r.push(n)}var p=this.pairSearchGap;for(a=0;a<r.length;a++){var c=r[a];for(o=a+1;o<r.length;o++)if(t[a].aabb.intersectsWithGap(t[o].aabb,p)&&this.meshesIntersect(c,r[o])){var u=this.createFragmentPair(t[a],t[o]);e.push(u)}}},PuzzleController.prototype.computePuzzleGridSize=function(e){var t=e.fragments,r=this.cellSize,a=this.tempBb;r.set(.1,.1,.1);for(var o=0;o<t.length;o++){var n=t[o].aabb;0===o?a.copy(n):a.add(n);var i=n.halfExtents;r.x<i.x&&(r.x=i.x),r.y<i.y&&(r.y=i.y),r.z<i.z&&(r.z=i.z)}r.add(r).plus(this.cellSizeGap),this.localCenter.copy(a.center)},PuzzleController.prototype.randomizeFragments=function(e){switch(this.difficulty){case 0:this.randomizeFragmentsAroundCenter(e);break;case 1:this.randomizeFragmentsOnSphere(e,!1)}},PuzzleController.prototype.randomizeFragmentsSmart=function(e){var t=e.fragments,r=Math.floor(pc.math.random(0,t.length)),a=(t[r].aabb.center,t[r].node.getLocalScale().x),o=(this.cellSize,this.fracDistance*a),n=this.tempBb,i=this.tempVec3_2.copy(n.center),s=0;for(s=0;s<t.length;s++){var l=t[s].aabb.center;t[s].node.setLocalPosition(this.tempVec3.copy(l).sub(i).normalize().scale(o).add(l).sub(this.tempVec3_2.copy(l).sub(t[s].node.getLocalPosition())))}},PuzzleController.prototype.randomizeFragmentsAroundCenter=function(e){var t=e.fragments,r=Math.floor(pc.math.random(0,t.length)),a=t[r].aabb.center,o=t[r].node.getLocalScale().x,n=this.fracDistance*o;e.origin.copy(a);for(var i=0;i<t.length;i++)if(r!==i){var s=t[i].aabb.center;t[i].node.setLocalPosition(this.tempVec3.copy(s).sub(a).scale(n).add(s).sub(this.tempVec3_2.copy(s).sub(t[i].node.getLocalPosition())))}},PuzzleController.prototype.randomizeFragmentsRandomly=function(e){this.usedCells.clear();var t=e.fragments,r=t[0].node.getLocalScale().x,a=this.fracDistance*r*.5,o=(this.app.graphicsDevice.width,this.app.graphicsDevice.height,Math.max(2,Math.ceil(Math.pow(t.length,1/3)))),n=Math.max(2,Math.ceil(1.5*o)),i=Math.max(o*o*n,t.length);this.updatePuzzleGridSize(o,n);for(var s=0;s<t.length;s++){for(var l=Math.floor(pc.math.random(0,i));this.usedCells.has(l);)l=Math.floor(pc.math.random(0,i));this.usedCells.add(l);var h=this.getCellCenter(l,o),p=this.tempVec3_3.copy(t[s].aabb.center);h.sub(t[s].aabb.center).mulBy(a).add(t[s].aabb.center).sub(p.sub(t[s].node.getLocalPosition())),t[s].node.setLocalPosition(h)}},PuzzleController.prototype.randomizeFragmentsOnSphere=function(e,t){this.usedCells.clear();var r=e.fragments,a=this.cellSize,o=this.tempBb,n=.5*a.length(),i=o.center,s=r[0].node.getLocalScale().x,l=this.fracDistance*s*.5,h=this.gridSize;this.updatePuzzleGridSize(h,h);for(var p=0;p<r.length;p++){var c=this.tempVec3.copy(r[p].aabb.center).sub(i).add(r[p].aabb.center);t&&c.add(this.tempVec3_2.set(Math.random(),Math.random(),Math.random()).normalize().mulBy(n));for(var u=this.getCellIndex(c,h);this.usedCells.has(u);)u=this.getCellIndex(c.add(this.tempVec3_2.copy(c).normalize().mulBy(n)),h);this.usedCells.add(u),c=this.getCellCenter(u,h);var z=this.tempVec3_3.copy(r[p].aabb.center);c.sub(r[p].aabb.center).mulBy(l).add(r[p].aabb.center).sub(z.sub(r[p].node.getLocalPosition())),r[p].node.setLocalPosition(c)}},PuzzleController.prototype.getCellIndex=function(e,t){var r=this.cellSize,a=this.tempBb.getMin();return e=this.tempVec3_2.copy(e).sub(a),Math.floor(e.x/r.x)+t*Math.floor(e.z/r.z)+t*t*Math.floor(e.y/r.y)},PuzzleController.prototype.getCellCenter=function(e,t){var r=this.cellSize,a=this.tempBb.getMin(),o=e%t,n=Math.floor(e/(t*t)),i=Math.floor(e%(t*t)/t),s=this.tempVec3_2.set(o*r.x,n*r.y,i*r.z).add(a);return s.x+=r.x*(i%2==1?1:.5),s.y+=r.y*(o%2==1?1:.5),s.z+=r.z*(o%2==1?1:.5),s},PuzzleController.prototype.updatePuzzleGridSize=function(e,t){var r=this.cellSize;this.tempBb.halfExtents.set(e*r.x*.5,t*r.y*.5,e*r.z*.5)},PuzzleController.prototype.configurePuzzle=function(){if(this.modelConfig.isBoss){var e=this.parts,t=0;for(this.splitPuzzle(this.bossSplit),t=0;t<e.length;t++){var r=e[t];this.computePuzzleGridSize(r),this.randomizeFragments(r)}if(e.every(function(e){return e.completed}))this.setActivePuzzle(this.puzzle);else{var a=Math.floor(pc.math.random(0,e.length));for(t=0;t<e.length;t++){var o=e[(a+t)%e.length];if(!o.completed){this.setActivePuzzle(o);break}}}}else this.randomizeFragments(this.puzzle),this.setActivePuzzle(this.puzzle)},PuzzleController.prototype.setActivePuzzle=function(e){this.activePuzzle=e,this.app.fire("camera:refreshView",this.ready)},PuzzleController.prototype.createFragmentPair=function(e,t){return{fragment1:e,fragment2:t,snapped:!1}},PuzzleController.prototype.cleanPuzzle=function(e){e.pairs=[],e.fragments=[],e.meshes=[],e.completed=!1},PuzzleController.prototype.createPuzzle=function(){return{pairs:[],fragments:[],meshes:[],origin:new pc.Vec3(0,0,0),completed:!1}},PuzzleController.prototype.getDistance3=function(e,t){return this.tempVec3.set(e.x-t.x,e.y-t.y,e.z-t.z),this.tempVec3.length()},PuzzleController.prototype.meshesIntersect=function(e,t){for(var r=this.pairSearchGap,a=0;a<e.length;a++)if(a%2!=1)for(var o=0;o<t.length;o++)if(this.getDistance3(e[a],t[o])<r)return!0;return!1},PuzzleController.prototype.containsNode=function(e){for(var t=this.puzzle.fragments,r=0;r<t.length;r++)if(t[r].node==e)return!0;return!1},PuzzleController.prototype.checkGameCompleted=function(){if(!this.ready)return!1;var e=0,t=this.activePuzzle.pairs;for(e=0;e<t.length;e++)if(!t[e].snapped)return!0;this.activePuzzle.completed=!0;var r=this.parts;for(e=0;e<r.length;e++)if(r[e].pairs.length>0&&!r[e].completed)return this.setActivePuzzle(r[e]),!1;if(!this.puzzle.completed){var a=this.activePuzzle;return this.app.fire("game:parts_completed",a),this.setActivePuzzle(this.puzzle),!1}return this.app.fire("game:finish",GameData.currentCollectionIndex,GameData.currentLevelIndex),!1},PuzzleController.prototype.onGameStart=function(e,t){console.log("base material = "+t.colorScheme.script.materialsConfig.baseMaterial.name),console.log("fracture material = "+t.colorScheme.script.materialsConfig.fractureMaterial.name),this.modelConfig=e,this.collectionConfig=t,this.load(e.model)},PuzzleController.prototype.onGameFinish=function(){this.ready=!1,this.resetPosition(this.puzzle,this.activePuzzle.fragments[0].node.getLocalPosition())},PuzzleController.prototype.onGameStop=function(){this.resetData()},PuzzleController.prototype.onGameReplay=function(e,t){this.onGameStop(),this.onGameStart(e,t)},PuzzleController.prototype.onGetRewards=function(){this.onGameStop()},PuzzleController.prototype.isAcceptablePair=function(e,t,r,a){return t>1&&(r.fragments.length<2&&-1==this.tempFrags.indexOf(a.fragment1)!=this.tempFrags.indexOf(a.fragment2)==-1||-1==r.fragments.indexOf(a.fragment1)||-1==r.fragments.indexOf(a.fragment2))||a.fragment1==e||a.fragment2==e},PuzzleController.prototype.getSearchVector=function(e){var t=e.halfExtents,r=t.x,a=t.y,o=t.z;return r>a&&r>o?pc.Vec3.RIGHT.clone():a>r&&a>o?pc.Vec3.UP.clone():pc.Vec3.BACK.clone()},PuzzleController.prototype.getStartFragment=function(e,t){for(var r,a=9007199254740991,o=0;o<t.length;o++){var n=t[o],i=this.getDistance3(n.aabb.center,e.center);(!r||i<a)&&(r=n,a=i)}return r},PuzzleController.prototype.splitPass1=function(e){var t=this.puzzle.fragments,r=this.parts,a=this.puzzle.pairs,o=this.getSearchVector(this.tempBb),n=this.getStartFragment(this.tempBb,t),i=t.length,s=Math.floor(i/e),l=i-s*e;s++;var h,p,c=0,u=0,z=0;for(c=0;c<i;c++){var m=Math.min(e-1,Math.floor(c/s));if(p=r[m],0!==c){var f=null,d=n.aabb.center;for(u=0;u<a.length;u++)if(h=a[u],this.isAcceptablePair(n,z,p,h)){var g=z>1?-1==p.fragments.indexOf(h.fragment1)&&-1===this.tempFrags.indexOf(h.fragment1)?h.fragment1:h.fragment2:n==h.fragment1?h.fragment2:h.fragment1,P=g.aabb.center;-1===this.tempFrags.indexOf(g)&&(!f||this.getDistance3(d,P)<this.getDistance3(d,f.aabb.center))&&this.tempVec3_3.copy(P).sub(d).dot(o)>=0&&(f=g)}f?(p.fragments.push(f),this.tempFrags.push(f),m===l&&(s=Math.floor(i/e)),n=f,f=null,z=0):(o.mulBy(-1),c--,z++)}else p.fragments.push(n),this.tempFrags.push(n),m===l&&(s=Math.floor(i/e))}this.tempFrags=[]},PuzzleController.prototype.findPairsForParts=function(){var e=this.puzzle.pairs,t=this.parts,r=0,a=0;for(r=0;r<e.length;r++)for(a=0;a<t.length;a++){pair=e[r];var o=t[a];if(o.fragments.indexOf(pair.fragment1)>-1&&o.fragments.indexOf(pair.fragment2)>-1){o.pairs.push(e[r]);break}}},PuzzleController.prototype.splitPass2=function(){var e=this.parts,t=0,r=0;for(t=0;t<e.length;t++){var a=e[t];if(!(a.fragments.length<2))for(r=0;r<a.fragments.length;r++)if(!this.fragmentConnected(a.fragments[r],a)){this.moveFragment(r,a,e);break}}},PuzzleController.prototype.spreadParts=function(){var e=this.tempBb,t=this.tempVec3_2.copy(e.center),r=this.puzzle.fragments[0].node.getLocalScale().x,a=this.partsDistance*r,o=this.parts,n=0,i=0;for(n=0;n<o.length;n++){var s=o[n];s.completed=s.pairs.length<1;var l=s.fragments;for(i=0;i<l.length;i++){var h=l[i].aabb;0===i?e.copy(h):e.add(h)}this.resetPosition(o[n],e.center.sub(t).normalize().mulBy(a))}for(n=0;n<o.length;n++)for(i=n+1;i<o.length;i++){var p=o[n].fragments[0].node.getLocalPosition(),c=o[i].fragments[0].node.getLocalPosition();this.resetPosition(o[i],t.copy(c).sub(p).normalize().mulBy(a).add(p))}},PuzzleController.prototype.splitPuzzle=function(e){this.splitPass1(e),this.findPairsForParts(),this.splitPass2(),this.splitMeshes(),this.spreadParts()},PuzzleController.prototype.splitMeshes=function(){var e,t,r,a=this.parts,o=this.puzzle.meshes,n=0,i=0,s=0,l=0;for(n=0;n<a.length;n++)for(t=(e=a[n]).fragments,i=0;i<t.length;i++)for(r=t[i],l=0,s=0;s<o.length&&(o[s].node==r.node&&(e.meshes.push(o[s]),l++),!(l>=2));s++);},PuzzleController.prototype.fragmentConnected=function(e,t){var r=t.pairs;for(i=0;i<r.length;i++){var a=r[i];if(a.fragment1==e||a.fragment2==e)return!0}return!1},PuzzleController.prototype.moveFragment=function(e,t,r){var a=t.fragments[e];t.fragments.splice(e,1);var o=this.puzzle.pairs;for(i=0;i<o.length;i++){var n=o[i];if(n.fragment1==a||n.fragmnt2==a)for(j=0;j<r.length;j++){var s=r[j];if(t!=s&&this.pairConnected(a,n,s))return s.fragments.push(a),void s.pairs.push(n)}}},PuzzleController.prototype.pairConnected=function(e,t,r){var a=t.fragment1==e?t.fragment2:t.frament1;return r.fragments.indexOf(a)>-1};var galleryScreenControllerSelf,GalleryScreenController=pc.createScript("galleryScreenController");GalleryScreenController.attributes.add("gameController",{type:"entity"}),GalleryScreenController.attributes.add("screenCaptionText",{type:"entity"}),GalleryScreenController.attributes.add("collectionNameText",{type:"entity"}),GalleryScreenController.attributes.add("settingsPanel",{type:"entity"}),GalleryScreenController.attributes.add("itemsContainer",{type:"entity"}),GalleryScreenController.attributes.add("itemViewPrefab",{type:"entity"}),GalleryScreenController.attributes.add("bossItemViewPrefab",{type:"entity"}),GalleryScreenController.attributes.add("paginatorPointsContainer",{type:"entity"}),GalleryScreenController.attributes.add("paginatorPointPrefab",{type:"entity"}),GalleryScreenController.attributes.add("prevCollectionButton",{type:"entity"}),GalleryScreenController.attributes.add("nextCollectionButton",{type:"entity"}),GalleryScreenController.attributes.add("botButton",{type:"entity"}),GalleryScreenController.attributes.add("debugButton",{type:"entity"}),GalleryScreenController.attributes.add("debugScreen",{type:"entity"}),GalleryScreenController.attributes.add("soundOnButton",{type:"entity"}),GalleryScreenController.attributes.add("soundOffButton",{type:"entity"}),GalleryScreenController.attributes.add("inGameBg",{type:"entity"}),GalleryScreenController.attributes.add("colorTransitionTime",{type:"number",default:.2}),GalleryScreenController.attributes.add("tutorialText",{type:"entity"}),GalleryScreenController.prototype.initialize=function(){galleryScreenControllerSelf=this,this.itemViews=[],this.bossItemViews=[],this.initTopPanel(),this.itemViewPrefab.enabled=!1,this.bossItemViewPrefab.enabled=!1,this.initPaginator(),this.app.on("collections:update",this.onCollectionsUpdate),this.app.on("collection:select",this.showCollectionByIndex),this.entity.script.on("state",function(e){this.settingsPanel.enabled=e}.bind(this)),this.settingsPanel.enabled=!0,galleryScreenControllerSelf.botButton.enabled=!1,PlayerData.botSubscription||FbApi.canSubscribeBot(function(e){galleryScreenControllerSelf.botButton.enabled=e}),DEBUG&&(this.debugButton.enabled=!0,UIUtils.addClickListener(this.debugButton,function(){this.debugScreen.enabled=!0},this)),galleryScreenControllerSelf.showCollectionByIndex(GameData.selectedCollectionIndex)},GalleryScreenController.prototype.onCollectionsUpdate=function(){galleryScreenControllerSelf.showCollectionByIndex(GameData.selectedCollectionIndex)},GalleryScreenController.prototype.initTopPanel=function(){this.updateSoundIcon(),UIUtils.addClickListener(this.soundOnButton,this.onSoundButtonClick,this),UIUtils.addClickListener(this.soundOffButton,this.onSoundButtonClick,this),UIUtils.addClickListener(this.botButton,function(){this.app.fire("bot:subscribe:popup",BotSubscriptionType.Manual)},this)},GalleryScreenController.prototype.onSoundButtonClick=function(){this.app.fire("set:sound",!PlayerData.sound),this.updateSoundIcon()},GalleryScreenController.prototype.updateSoundIcon=function(){this.soundOnButton.enabled=PlayerData.sound,this.soundOffButton.enabled=!PlayerData.sound},GalleryScreenController.prototype.showCollectionByIndex=function(e){GameData.selectedCollectionIndex=e;var t=galleryScreenControllerSelf.gameController.script.gameController.collections[e];galleryScreenControllerSelf.showCollection(e,t),galleryScreenControllerSelf.updatePaginatorPoints(e)},GalleryScreenController.prototype.showCollection=function(e,t){var l=t.script.collectionConfig;this.collectionNameText.element.text=l.collectionName,this.cleanupItemsContainer();for(var o=l.levels,n=0;n<o.length;n++)this.initModelView(o[n].script.levelConfig,l,e,n);switch(this.updateBg(l.colorScheme.script.bgColors),this.setCollectionAvailable(e,l.lockType),l.collectionType){case CollectionType.Regular:this.tutorialText.enabled=!1,this.screenCaptionText.element.text=this.getPlayerCollectionTitle();break;case CollectionType.Tutorial:this.tutorialText.enabled=!0,this.screenCaptionText.element.text=this.getPlayerCollectionTitle();break;case CollectionType.Gifts:this.tutorialText.enabled=!1,this.screenCaptionText.element.text="Gifts\nShop"}this.app.fire("collection:selected",e)},GalleryScreenController.prototype.getPlayerCollectionTitle=function(){var e=FbApi.getPlayerName();return e.length>10&&(e=e.charAt(0)),e+"'s\nShop"},GalleryScreenController.prototype.setCollectionAvailable=function(e,t){switch(this.app.fire("collection:locked:popup:hide"),getCollectionState(e)){case CollectionItemState.Locked:this.app.fire("collection:locked:popup:show",t);break;case CollectionItemState.ReadyToUnlock:this.app.fire("collection:unlocked:popup:show",e,!1)}},GalleryScreenController.prototype.updateBg=function(e){var t=this.inGameBg.script.inGameBg;this.updateBgElementColor(t.rootImage,e.rootImageColor,e.rootImageOpacity),this.updateBgElementColor(t.gradient,e.gradientColor,e.gradientOpacity),this.updateBgElementColor(t.glow1,e.glow1Color,e.glow1Opacity),this.updateBgElementColor(t.glow2,e.glow2Color,e.glow2Opacity),this.updateBgElementColor(t.glow3,e.glow3Color,e.glow3Opacity),this.updateBgElementColor(t.shadow,e.shadowColor,e.shadowOpacity),this.updateBgElementColor(t.vignette,e.vignetteColor,e.vignetteOpacity),this.app.scene.fogColor=e.fogColor},GalleryScreenController.prototype.backgroundUpdated=function(){this.app.fire("ui:bg_updated")},GalleryScreenController.prototype.updateBgElementColor=function(e,t,l){ImageUtils.tweenColorAndOpacity(e.element,e.element.color,t,e.element.opacity,l,galleryScreenControllerSelf.colorTransitionTime,pc.SineInOut,this.backgroundUpdated.bind(galleryScreenControllerSelf))},GalleryScreenController.prototype.initPaginator=function(){this.prevCollectionButton.element.on("click",function(e){playArrowTapAudio(),UIUtils.fireButtonClicked(galleryScreenControllerSelf.prevCollectionButton.name),galleryScreenControllerSelf.showPrevCollection()}.bind(this),this),this.nextCollectionButton.element.on("click",function(e){playArrowTapAudio(),UIUtils.fireButtonClicked(galleryScreenControllerSelf.nextCollectionButton.name),galleryScreenControllerSelf.showNextCollection()},this);var e=this.gameController.script.gameController.collections.length;function onPaginationPointClick(e){return function(){playArrowTapAudio(),UIUtils.fireButtonClicked("buttonShowCollection_"+e),galleryScreenControllerSelf.showCollectionByIndex(e)}}this.paginatorPoints=[];for(var t=0;t<e;t++){var l=this.paginatorPointPrefab.clone();this.paginatorPointsContainer.addChild(l),l.element.on("click",onPaginationPointClick(t),this),this.paginatorPoints.push(l)}this.paginatorPointPrefab.enabled=!1},GalleryScreenController.prototype.updatePaginatorPoints=function(e){for(var t=this.gameController.script.gameController.collections,l=0;l<this.paginatorPoints.length;l++)this.updatePaginatorPoint(this.paginatorPoints[l].script.paginationPoint,l===e,t[l].script.collectionConfig.collectionType==CollectionType.Gifts)},GalleryScreenController.prototype.updatePaginatorPoint=function(e,t,l){e.inactivePaginatorPoint.enabled=!l&&!t,e.activePaginatorPoint.enabled=!l&&t,e.inactiveBonusPaginatorPoint.enabled=l&&!t,e.activeBonusPaginatorPoint.enabled=l&&t},GalleryScreenController.prototype.updatePaginationButtons=function(){this.prevCollectionButton.enabled=GameData.selectedCollectionIndex>0,this.nextCollectionButton.enabled=GameData.selectedCollectionIndex<this.gameController.script.gameController.collections.length-1},GalleryScreenController.prototype.showPrevCollection=function(){var e=GameData.selectedCollectionIndex-1;e<0&&(e=this.gameController.script.gameController.collections.length-1),galleryScreenControllerSelf.showCollectionByIndex(e)},GalleryScreenController.prototype.showNextCollection=function(){var e=GameData.selectedCollectionIndex+1;e>this.gameController.script.gameController.collections.length-1&&(e=0),galleryScreenControllerSelf.showCollectionByIndex(e)},GalleryScreenController.prototype.initModelView=function(e,t,l,o){var n=this.getItemView(o,e.isBoss);n.enabled=!0,n.element.off("click"),n.element.on("click",function(r){if(playButtonTapAudio(),isLevelAvailable(l,o))UIUtils.fireButtonClicked("startPuzzle:collection:"+l+":figure:"+o),galleryScreenControllerSelf.app.fire("game:start",n.script.levelConfig,t,l,o),e.isInterstitialStart&&FbApi.showInterstitialAd(function(){},function(){},"start_puzzle");else{var i=getCollectionState(l);i===CollectionItemState.Unlocked&&e.isAdUnlock?(UIUtils.fireButtonClicked("showRewardedVideo:collection:"+l+":figure:"+o),FbApi.showRewardedVideo(function(){galleryScreenControllerSelf.app.fire("level.unlocked",l,o,"video_ads"),galleryScreenControllerSelf.app.fire("collections:update")},function(){},"unlock_figure")):i===CollectionItemState.Unlocked&&(UIUtils.fireButtonClicked("showFigureLockedPopup:collection:"+l+":figure:"+o),galleryScreenControllerSelf.app.fire("level:locked:popup:show",t.collectionType))}},this);var r=n.script.galleryItemView.itemIcon.element;r.spriteAsset=e.iconSprite.id;var i=ImageUtils.getSpriteRect(e.iconSprite),a=i[2],c=i[3],s=c/a;c>a?(r.height=r.originalHeight,r.width=r.originalHeight/s):(r.height=r.originalWidth*s,r.width=r.originalWidth),n.script.levelConfig=e;var p=t.colorScheme.script.bgColors.itemViewShadowOpacity,d=1,y=getCollectionState(l);switch(getLevelState(l,o)){case CollectionItemState.Locked:n.script.galleryItemView.itemIcon.enabled=!1,n.script.galleryItemView.adsIcon.enabled=y===CollectionItemState.Unlocked&&e.isAdUnlock,d=n.script.galleryItemView.lockedFrameOpacity,p/=2.5,n.script.galleryItemView.unlockedNumber.enabled=!1,n.script.galleryItemView.unlockedGift.enabled=!1,t.collectionType==CollectionType.Gifts?(n.script.galleryItemView.lockedGift.enabled=!0,n.script.galleryItemView.lockedLocker.enabled=!1):(n.script.galleryItemView.lockedLocker.enabled=!0,n.script.galleryItemView.lockedGift.enabled=!1);break;case CollectionItemState.ReadyToUnlock:case CollectionItemState.Unlocked:n.script.galleryItemView.itemIcon.enabled=!1,n.script.galleryItemView.adsIcon.enabled=!1,d=n.script.galleryItemView.unlockedFrameOpacity,n.script.galleryItemView.lockedGift.enabled=!1,n.script.galleryItemView.lockedLocker.enabled=!1,t.collectionType==CollectionType.Gifts?(n.script.galleryItemView.unlockedGift.enabled=!0,n.script.galleryItemView.unlockedNumber.enabled=!1):(n.script.galleryItemView.unlockedGift.enabled=!1,n.script.galleryItemView.unlockedNumber.element.text=galleryScreenControllerSelf.levelIndexToString(o+1),n.script.galleryItemView.unlockedNumber.enabled=!0);break;case CollectionItemState.Completed:n.script.galleryItemView.itemIcon.enabled=!0,n.script.galleryItemView.adsIcon.enabled=!1,d=n.script.galleryItemView.unlockedFrameOpacity,n.script.galleryItemView.lockedGift.enabled=!1,n.script.galleryItemView.lockedLocker.enabled=!1,n.script.galleryItemView.unlockedGift.enabled=!1,n.script.galleryItemView.unlockedNumber.enabled=!1}n.script.galleryItemView.frame.element.opacity=d,ImageUtils.tweenColorAndOpacity(n.script.galleryItemView.bgBlur.element,n.script.galleryItemView.bgBlur.element.color,t.colorScheme.script.bgColors.itemViewShadowColor,n.script.galleryItemView.bgBlur.element.opacity,p,galleryScreenControllerSelf.colorTransitionTime,pc.SineInOut)},GalleryScreenController.prototype.levelIndexToString=function(e){switch(e){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV";case 5:return"V";case 6:return"VI";case 7:return"FINAL"}},GalleryScreenController.prototype.cleanupItemsContainer=function(){for(var e=0;e<this.itemViews.length;e++)this.itemViews[e].enabled=!1},GalleryScreenController.prototype.getItemView=function(e,t){if(this.itemViews.length>e)return this.itemViews[e];var l=t?this.bossItemViewPrefab.clone():this.itemViewPrefab.clone();return l.script.galleryItemView.itemIcon.element.originalWidth=l.script.galleryItemView.itemIcon.element.width,l.script.galleryItemView.itemIcon.element.originalHeight=l.script.galleryItemView.itemIcon.element.height,this.itemsContainer.addChild(l),this.itemViews.push(l),l},GalleryScreenController.prototype.onSubscribeBotResult=function(e,t){t&&(galleryScreenControllerSelf.botButton.enabled=!1)};var GalleryItemView=pc.createScript("galleryItemView");GalleryItemView.attributes.add("itemIcon",{type:"entity"}),GalleryItemView.attributes.add("adsIcon",{type:"entity"}),GalleryItemView.attributes.add("frame",{type:"entity"}),GalleryItemView.attributes.add("bgBlur",{type:"entity"}),GalleryItemView.attributes.add("lockedLocker",{type:"entity"}),GalleryItemView.attributes.add("unlockedNumber",{type:"entity"}),GalleryItemView.attributes.add("lockedGift",{type:"entity"}),GalleryItemView.attributes.add("unlockedGift",{type:"entity"}),GalleryItemView.attributes.add("lockedFrameOpacity",{type:"number",default:.5}),GalleryItemView.attributes.add("unlockedFrameOpacity",{type:"number",default:1});var RewardsScreenController=pc.createScript("rewardsScreenController");RewardsScreenController.attributes.add("gameController",{type:"entity"}),RewardsScreenController.attributes.add("tutorialRewardScreen",{type:"entity"}),RewardsScreenController.attributes.add("sharingText",{type:"string",default:"Some sharing text"}),RewardsScreenController.attributes.add("buttonsPanel",{type:"entity"}),RewardsScreenController.attributes.add("startButtonsPos",{type:"entity"}),RewardsScreenController.attributes.add("replayButton",{type:"entity"}),RewardsScreenController.attributes.add("continueButton",{type:"entity"}),RewardsScreenController.attributes.add("shareButton",{type:"entity"}),RewardsScreenController.attributes.add("imageToShare",{type:"entity"}),RewardsScreenController.attributes.add("maleVisitorSprite",{type:"asset",assetType:"sprite"}),RewardsScreenController.attributes.add("femaleVisitorSprite",{type:"asset",assetType:"sprite"}),RewardsScreenController.attributes.add("visitorReviewPanel",{type:"entity"}),RewardsScreenController.attributes.add("startVisitorReviewPos",{type:"entity"}),RewardsScreenController.attributes.add("visitorIconImage",{type:"entity"}),RewardsScreenController.attributes.add("visitorNameText",{type:"entity"}),RewardsScreenController.attributes.add("visitorReviewText",{type:"entity"}),RewardsScreenController.attributes.add("visitorReviewAnimDuration",{type:"number",default:1}),RewardsScreenController.attributes.add("visitorReviewAnimDelay",{type:"number",default:0}),RewardsScreenController.attributes.add("buttonsAnimDuration",{type:"number",default:1}),RewardsScreenController.attributes.add("buttonsAnimDelay",{type:"number",default:.7}),RewardsScreenController.prototype.initialize=function(){UIUtils.addClickListener(this.continueButton,function(){this.app.fire("rewards:get")},this),UIUtils.addClickListener(this.replayButton,function(){this.app.fire("game:replay",GameData.currentLevelConfig,GameData.currentCollectionConfig)},this),UIUtils.addClickListener(this.shareButton,function(){this.share()},this),this.app.on("game:finish",this.onGameFinish.bind(this)),this.onGameFinish(GameData.currentCollectionIndex,GameData.currentLevelIndex)},RewardsScreenController.prototype.share=function(){var e=this.imageToShare.script.imageToshare,t=GameData.currentCollectionConfig.colorScheme.script.bgColors,i=[];!function addBgImageLayers(e,t){addImageLayer(e.bg,t.rootImageColor,t.rootImageOpacity),addImageLayer(e.gradient,t.gradientColor,t.gradientOpacity),addImageLayer(e.glow1,t.glow1Color,t.glow1Opacity),addImageLayer(e.glow2,t.glow2Color,t.glow2Opacity),addImageLayer(e.glow3,t.glow3Color,t.glow3Opacity),addImageLayer(e.vignette,t.vignetteColor,t.vignetteOpacity)}(e,t),function addFlourishImageLayers(e){for(var t=0;t<e.length;t++){var i=e[t];i.element.color,i.element.opacity;addImageLayer(i,i.element.color,i.element.opacity)}}(e.flourishImageLayers),function addLevelIconShareData(){var t,r,a=e.levelIconImage.getLocalPosition(),o=e.levelIconImage.element,n=ImageUtils.getSpriteRect(GameData.currentLevelConfig.iconSprite),s=n[2],l=n[3],d=l/s;l>s?(r=o.height,t=o.height/d):(r=o.width*d,t=o.width);var c=(t-o.width)/2,m=(r-o.height)/2,h=ImageUtils.createSpriteShareImageData(GameData.currentLevelConfig.iconSprite.id,ImageUtils.createDestinationRect(a.x-c,-a.y-m,t,r));i.push(h)}();var r=[];function addImageLayer(e,t,r){var a,o=e.getLocalPosition(),n=ImageUtils.createDestinationRect(o.x,-o.y,e.element.width,e.element.height);return null!==e.element.spriteAsset?(a=ImageUtils.createSpriteShareImageData(e.element.spriteAsset,n,t,r),void i.push(a)):null!==e.element.textureAsset?(a=ImageUtils.createTextureShareImageData(e.element.textureAsset,n,t,r),void i.push(a)):(a=ImageUtils.createSolidShareImageData(n,t,r),void i.push(a))}!function addTextLayers(e){r.push(ImageUtils.createShareTextData(GameData.currentLevelConfig.visitorReview,e.visitorReviewText,"center",e.visitorReviewFontType,e.visitorReviewFontWeight,e.visitorReviewFontFamily,!0))}(e),function addVisitiorTopLayout(t,a,o){var n=t.visitorNameText.element;n.text=GameData.currentLevelConfig.visitorName.toUpperCase();var s=n.textWidth,l=n.textHeight,d=t.visitorBackImage,c=d.element.width,m=t.visitorTopRect,h=m.getLocalPosition(),g=m.element.width,u=new pc.Vec3(h.x+g/2,h.y-m.element.height/2,0),p=c+t.visitorTopSpacing+s,v=new pc.Vec3(u.x-p/2-c/4,u.y+d.element.height/2,0),y=new pc.Vec3(v.x+c+t.visitorTopSpacing,u.y+l/2,0);d.setLocalPosition(v),addImageLayer(d,d.color,d.opacity),function addVisitorIconShareData(t,r,a,o,n){var s=GameData.currentLevelConfig.visitorGender===VisitorGender.Male?o:n,l=e.visitorIconImage.element;t.x=t.x+r/2,t.y=t.y-a/2;var d=l.width,c=l.height,m=t.x-d/2,h=t.y+c/2,g=ImageUtils.createDestinationRect(m,-h,d,c),u=l.color,p=l.opacity,v=ImageUtils.createSpriteShareImageData(s.id,g,u,p);i.push(v)}(v,c,d.element.height,a,o),t.visitorNameText.setLocalPosition(y),r.push(ImageUtils.createShareTextData(n.text,t.visitorNameText,"left",t.visitorNameFontType,t.visitorNameFontWeight,t.visitorNameFontFamily,!1))}(e,this.maleVisitorSprite,this.femaleVisitorSprite),ImageUtils.createShareImage(e.screenshotWidth,e.screenshotHeight,i,r,function(e){FbApi.shareGameResult(e,this.sharingText,function(){console.log("shared")},function(){console.log("share failed")})}.bind(this))},RewardsScreenController.prototype.onGameFinish=function(e,t){var i=this.gameController.script.gameController.collections[e].script.collectionConfig.levels[t].script.levelConfig;i.visitorGender===VisitorGender.Male?(this.visitorIconImage.element.spriteAsset=this.maleVisitorSprite.id,this.visitorIconImage.element.spriteFrame=this.maleVisitorSprite.data.frameKeys[0]):(this.visitorIconImage.element.spriteAsset=this.femaleVisitorSprite.id,this.visitorIconImage.element.spriteFrame=this.femaleVisitorSprite.data.frameKeys[0]),this.visitorNameText.element.text=i.visitorName,this.visitorReviewText.element.text=i.visitorReview;var r=this.visitorReviewAnimDelay,a=this.buttonsAnimDelay;isTutorialLevel(e,t)&&(r=this.tutorialRewardScreen.script.tutorialRewardScreen.visitorReviewAnimDelay,a=this.tutorialRewardScreen.script.tutorialRewardScreen.buttonsAnimDelay),ImageUtils.tweenPos(this.visitorReviewPanel,this.startVisitorReviewPos,this.visitorReviewPanel,this.visitorReviewAnimDuration,r,pc.SineOut,!1,!1),ImageUtils.tweenPos(this.buttonsPanel,this.startButtonsPos,this.buttonsPanel,this.buttonsAnimDuration,a,pc.SineOut,!1,!1)};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)},i=this.app.touch;i&&(i.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),i.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),i.on(pc.EVENT_TOUCHEND,this.onTouchEnd,this),i.on(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this),this.on("destroy",function(){i.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),i.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),i.off(pc.EVENT_TOUCHEND,this.onTouchEnd,this),i.off(pc.EVENT_TOUCHCANCEL,this.onTouchCancel,this)}));var n=this.app.mouse;n&&(n.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),n.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),n.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){n.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),n.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),n.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),window.removeEventListener("mouseout",o,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,i=MouseInput.toWorldPoint,n=MouseInput.worldDiff,s=this.entity.camera,e=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,e,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,e,i),n.sub2(i,o),this.orbitCamera.pivotPoint.add(n)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1},MouseInput.prototype.onTouchStart=function(t){if(1===t.touches.length){var o=t.touches[0];this.lookButtonDown=!0,this.lastPoint.set(o.x,o.y)}},MouseInput.prototype.onTouchMove=function(t){var o=t.touches[0],i=o.x-this.lastPoint.x,n=o.y-this.lastPoint.y;this.orbitCamera.pitch-=n*this.orbitSensitivity,this.orbitCamera.yaw-=i*this.orbitSensitivity,this.lastPoint.set(o.x,o.y)},MouseInput.prototype.onTouchEnd=function(t){0===t.touches.length&&(this.lookButtonDown=!1)},MouseInput.prototype.onTouchCancel=function(t){0===t.touches.length&&(this.lookButtonDown=!1)};var self,OrbitCamera=pc.createScript("orbitCamera"),tweenOptions=[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}];OrbitCamera.attributes.add("orthoHeightAdd",{type:"number",default:0,title:"Ortho Height Add",description:"add specified value to computed model orthogrhaphic height"}),OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("partSwitchAnimTime",{type:"number",default:2}),OrbitCamera.attributes.add("partSwitchAnimEasing",{type:"string",default:"Linear",enum:tweenOptions}),OrbitCamera.attributes.add("finalRotationSpeed",{type:"number",default:15,min:0}),OrbitCamera.attributes.add("finalCameraYDif",{type:"number",default:1.2}),OrbitCamera.attributes.add("finalCameraAngle",{type:"vec3"}),OrbitCamera.attributes.add("cameraFocusTime",{type:"number",default:1}),OrbitCamera.attributes.add("finalCameraFocusTime",{type:"number",default:1}),OrbitCamera.attributes.add("cameraFocusAnimEasing",{type:"string",default:"Linear",enum:tweenOptions}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),OrbitCamera.attributes.add("cameraEntity",{type:"entity"}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype._computeDistance=function(){var t=this._modelsAabb.halfExtents,i=Math.max(t.x,Math.max(t.y,t.z));return i/=Math.tan(.5*this.camera.fov*pc.math.DEG_TO_RAD),i*=2},OrbitCamera.prototype._computeOrthoHeight=function(){var t=this._modelsAabb.halfExtents,i=Math.sqrt(t.x*t.x+t.z*t.z),e=t.y,a=Math.min(this.app.graphicsDevice.width/this.app.graphicsDevice.height,0,5625),s=2*(e*a>i?e*a:i)+this.orthoHeightAdd;return this._orthoHeight>s?s:this._orthoHeight},OrbitCamera.prototype.finalFocus=function(){this._refreshAabb();var t=this._computeDistance(),i=this._computeOrthoHeight(),e=this.finalCameraFocusTime,a=this._modelsAabb.center.clone().sub(pc.Vec3.UP.clone().scale(this.finalCameraYDif)),s=this.finalCameraAngle,n=pc.Quat.IDENTITY.clone().setFromEulerAngles(s.x,s.y,s.z),r=this.tempQuat.copy(this.entity.getRotation()).normalize();this.entity.setRotation(r);var o=pc[this.cameraFocusAnimEasing];this.distance||(this.distance=0),this.reset(this._calcYaw(r),this._calcPitch(r,this.yaw),this.distance),this.resetAnimations(),this.tweenDistance.to({distance:t},e,o).start(),this.tweenOrthoHeight.to({_orthoHeight:i},e,o).start(),this.tweenPivot.to(a,e,o).start(),this.tweenProgress.to({progress:1},e,o).on("update",function(t){this.tempQuat2.copy(r).rotateTowards(n,this.progress),this.yaw=this._calcYaw(this.tempQuat2),this.pitch=this._calcPitch(this.tempQuat2,this.yaw)}.bind(this)).on("complete",function(t){var i=(this._targetYaw-this._yaw)%360;this.rotationSpeed=i>0?-Math.abs(this.finalRotationSpeed):Math.abs(this.finalRotationSpeed),this.rotate=!0}.bind(this)).start()},OrbitCamera.prototype.focus=function(t,i,e){t?this._buildAabb(t):this._refreshAabb();var a=this._computeDistance(),s=this._computeOrthoHeight();if(i){var n=this.cameraFocusTime,r=pc[this.cameraFocusAnimEasing];this.distance||(this.distance=0),this.resetAnimations(),this.tweenDistance.to({distance:a},n,r).start(),this.tweenOrthoHeight.to({_orthoHeight:s},n,r).start(),this.tweenPivot.to(this._modelsAabb.center,n,r).start()}else this.distance=a,this._orthoHeight=s,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.prototype.refreshView=function(t){var i=self._orthoHeight;self._buildAabb(self.focusEntity);var e=self._computeDistance(),a=self._computeOrthoHeight();if(self._orthoHeight=i,t){self.stop=!0;var s=self.tempQuat.copy(self.entity.getRotation());self.entity.lookAt(self._modelsAabb.center);var n=self.tempQuat2.copy(self.entity.getRotation());self.entity.setRotation(s);var r=self.entity.getRotation();self.pivotPoint.copy(self._modelsAabb.center);var o=pc[this.partSwitchAnimEasing];self.resetAnimations(),self.tweenOrthoHeight.to({_orthoHeight:a},.75*self.partSwitchAnimTime,pc.Linear).start(),self.tweenProgress.to({progress:1},self.partSwitchAnimTime,o).on("update",function(t){self.entity.setRotation(r.copy(s).rotateTowards(n,self.progress)),self.entity.camera.orthoHeight=self._orthoHeight}).on("complete",function(){self.resetAndLookAtPoint(self.entity.getLocalPosition(),self.pivotPoint),self.stop=!1}).start()}else self.resetAndLookAtPoint(self._originalPoint,self._modelsAabb.center),self.distance=e,self._orthoHeight=a},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){self=this,this.camera=this.cameraEntity?this.cameraEntity.camera:this.entity.camera;var t=function(){self._checkAspectRatio()};window.addEventListener("resize",t,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center),this._originalPoint=new pc.Vec3,this._originalPoint.copy(this.entity.getPosition());var i=this.entity.getRotation();if(this.tempQuat=new pc.Quat(0,0,0,0),this.tempQuat2=new pc.Quat(0,0,0,0),this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._orthoHeight=1e6,this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.rotationSpeed=30,this.rotate=!1,this.frameOnStart)this.focus();else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",t,!1)}),this.app.on("camera:refreshFocus",this.refreshFocus.bind(this)),this.app.on("camera:refreshView",this.refreshView.bind(this)),this.app.on("game:finish",this.finalFocus.bind(this));var a=function(){this.rotate=!1}.bind(this);this.app.on("game:start",a),this.app.on("game:replay",a),this.stop=!1,this.progress=0,this.tweenDistance=this.app.tween(this),this.tweenOrthoHeight=this.app.tween(this),this.tweenPivot=this.app.tween(this._pivotPoint),this.tweenProgress=this.app.tween(this),this.activeTweens=[],this.activeTweens.push(this.tweenDistance),this.activeTweens.push(this.tweenOrthoHeight),this.activeTweens.push(this.tweenPivot),this.activeTweens.push(this.tweenProgress)},OrbitCamera.prototype.resetAnimations=function(){this.progress=0;for(var t=this.activeTweens,i=0;i<t.length;i++){var e=t[i];e.stop(),e.off("update"),e.off("complete")}},OrbitCamera.prototype.update=function(t){if(!this.stop){this.rotate&&(this.yaw-=t*this.rotationSpeed);var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()}},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();switch(t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t),this.camera.projection){case pc.PROJECTION_ORTHOGRAPHIC:this.camera.orthoHeight=this._orthoHeight}},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t){this.meshes=[];var i,e=this.meshes,a=t.script.puzzleController.activePuzzle;if(a?i=a.fragments:t.model&&(i=t.model.meshInstances),i)for(var s=0;s<i.length;s++)this.containsNode(i,i[s].node,s)||e.push(i[s]);return this._orthoHeight=1e5,this._refreshAabb()},OrbitCamera.prototype._refreshAabb=function(){for(var t=this.meshes,i=0,e=0;e<t.length;e++)0===i?this._modelsAabb.copy(t[e].aabb):this._modelsAabb.add(t[e].aabb),i+=1;return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.normalize(),t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return t},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.normalize(),e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype.refreshFocus=function(t,i){self.focus(t?self.focusEntity:null,i)},OrbitCamera.prototype.containsNode=function(t,i,e){for(var a=0;a<e;a++)if(t[a].node==i)return!0;return!1};var ImageUtilsComponent=pc.createScript("imageUtilsComponent");ImageUtilsComponent.prototype.initialize=function(){ImageUtils.app=this.app,this.app.loader.getHandler("texture").crossOrigin="anonymous"};var ImageUtils={app:null,loadAndSetImage:function(t,e,a){if(null!==e){var i=ImageUtils.app.assets.find(t,"texture");if(void 0!==i)a.element.textureAsset=i.id;else{var n=new pc.Asset(t,"texture",{url:e});ImageUtils.app.assets.add(n),n.on("load",function(t){a.element.textureAsset=t.id}),ImageUtils.app.assets.load(n)}}},createShareImage:function(t,e,a,i,n){var o,r;function drawWrappedText(t,e,a,i,n,o){for(var r=e.split(" "),c=[],s="",d=0;d<r.length;d++){var l=s+r[d]+" ";t.measureText(l).width>n&&d>0?(c.push({line:s,x:a,y:i}),s=r[d]+" ",i+=o):s=l}c.push({line:s,x:a,y:i});for(var p=o*(c.length-1),g=0;g<c.length;g++){var u=c[g];t.fillText(u.line,u.x,u.y-p/2)}}function addHiddenCanvas(t,e,a){var i=document.createElement(a),n=document.createElement("canvas"),o=n.getContext("2d");return n.style.padding=0,n.style.display="block",n.style.position="fixed",n.style.top="100%",n.style.overflow="hidden",n.width=t,n.height=e,i.appendChild(n),document.body.append(i),{pre:i,canvas:n,ctx:o}}!function preloadImages(t,e){for(var a=0,i=t.length,n=0;n<i;n++){var o=t[n];if(o.imgUrl){var r=new Image;r.onload=function(){++a===i&&e()},r.src=o.imgUrl,o.image=r}else a++}}(a,function(){o=addHiddenCanvas(t,e,"mainCanvas"),r=addHiddenCanvas(t,e,"tintCanvas"),function drawImageLayers(a){for(var i=a.length,n=0;n<i;n++){var c=a[n];c.imgUrl?c.color?(r.ctx.globalCompositeOperation="source-over",r.ctx.fillStyle=c.color,r.ctx.fillRect(0,0,t,e),r.ctx.globalCompositeOperation="destination-atop",drawCanvasImage(r,c),o.ctx.globalAlpha=c.opacity,o.ctx.drawImage(r.canvas,0,0)):(o.ctx.globalAlpha=c.opacity,drawCanvasImage(o,c)):(o.ctx.fillStyle=c.color,o.ctx.globalAlpha=c.opacity,o.ctx.fillRect(c.destRect.dx,c.destRect.dy,c.destRect.dWidth,c.destRect.dHeight))}function drawCanvasImage(t,e){e.sourceRect?t.ctx.drawImage(e.image,e.sourceRect.sx,e.sourceRect.sy,e.sourceRect.sWidth,e.sourceRect.sHeight,e.destRect.dx,e.destRect.dy,e.destRect.dWidth,e.destRect.dHeight):t.ctx.drawImage(e.image,e.destRect.dx,e.destRect.dy,e.destRect.dWidth,e.destRect.dHeight)}}(a),function drawTextLayers(t){var e=t.length;o.ctx.fillStyle="#ffffff",o.ctx.textBaseline="middle";for(var a=0;a<e;a++){var i=t[a];if(o.ctx.font=i.font.cssFont,o.ctx.textAlign=i.horizontalAlign,i.wrap)drawWrappedText(o.ctx,i.text,i.destRect.dx+i.destRect.dWidth/2,-i.destRect.dy+i.destRect.dHeight/2,i.destRect.dWidth,i.font.lineHeight);else{var n="center"===i.horizontalAlign?i.destRect.dWidth/2:0;o.ctx.fillText(i.text,i.destRect.dx+n,-i.destRect.dy+i.destRect.dHeight/2)}}}(i);var c=o.canvas.toDataURL();!function cleanup(){document.body.removeChild(o.pre),document.body.removeChild(r.pre)}(),n(c)})},createSpriteShareImageData:function(t,e,a,i){var n=this.app.assets.get(t),o=this.app.assets.get(n.data.textureAtlasAsset),r=o.getFileUrl(),c=o.resource.texture.height,s=n.data.frameKeys[0],d=o.data.frames[s].rect,l=d[2],p=d[3],g=d[0],u=c-d[1]-p,m=ImageUtils.createSourceRect(g,u,l,p);return ImageUtils.createShareImageData(r,m,e,a,i)},createTextureShareImageData:function(t,e,a,i){var n=this.app.assets.get(t).getFileUrl();return ImageUtils.createShareImageData(n,void 0,e,a,i)},createSolidShareImageData:function(t,e,a){return ImageUtils.createShareImageData(void 0,void 0,t,e,a)},createShareImageData:function(t,e,a,i,n){var o;return i&&(o=1===i.r&&1===i.r&&1===i.r?void 0:"rgba("+255*i.r+","+255*i.g+","+255*i.b+", 1)"),{imgUrl:t,sourceRect:e,destRect:a,color:o,opacity:n||1}},createShareTextData:function(t,e,a,i,n,o,r){var c=e.getLocalPosition(),s="";return i&&(s+=i+" "),n&&(s+=n+" "),{text:t,horizontalAlign:a,font:{cssFont:s+=e.element.fontSize+"px "+o,size:e.element.fontSize,lineHeight:e.element.lineHeight},destRect:ImageUtils.createDestinationRect(c.x,c.y,e.element.width,e.element.height),wrap:r}},createDestinationRect:function(t,e,a,i){return{dx:t,dy:e,dWidth:a,dHeight:i}},createSourceRect:function(t,e,a,i){return{sx:t,sy:e,sWidth:a,sHeight:i}},tweenColorAndOpacity:function(t,e,a,i,n,o,r,c){var s=e.clone(),d=this.app.tween(s).to(a,o,r).on("update",function(){t.color=s});c&&d.on("complete",c),d.start();var l={colorOpacity:i};this.app.tween(l).to({colorOpacity:n},o,r).on("update",function(){t.opacity=l.colorOpacity}).start()},tweenOpacity:function(t,e,a,i,n){var o={colorOpacity:e};return this.app.tween(o).to({colorOpacity:a},i,n).on("update",function(){t.opacity=o.colorOpacity}).start()},tweenPos:function(t,e,a,i,n,o,r,c){var s=e.getLocalPosition().clone(),d=a.getLocalPosition().clone();return t.setLocalPosition(s),t.tween(t.getLocalPosition()).to(d,i,o).loop(r).yoyo(c).delay(n).start()},getSpriteRect:function(t){var e=this.app.assets.get(t.id),a=this.app.assets.get(t.data.textureAtlasAsset),i=e.data.frameKeys[0];return a.data.frames[i].rect}};var gameScreenControllerSelf,GameScreenController=pc.createScript("gameScreenController");GameScreenController.attributes.add("homeButton",{type:"entity"}),GameScreenController.attributes.add("debugFinishButton",{type:"entity"}),GameScreenController.prototype.initialize=function(){gameScreenControllerSelf=this,UIUtils.addClickListener(this.homeButton,function(){this.app.fire("game:stop")},this),DEBUG&&(this.debugFinishButton.enabled=!0,this.debugFinishButton.element.on("click",function(e){this.app.fire("game:finish",GameData.currentCollectionIndex,GameData.currentLevelIndex)},this)),this.app.on("game:start",this.resetState),this.resetState()},GameScreenController.prototype.resetState=function(){},GameScreenController.prototype.fadeOutTip360=function(){},GameScreenController.prototype.onFirstTouch=function(e){};pc.extend(pc,function(){var t=function(t){this._app=t,this._tweens=[],this._add=[]};t.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var i=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}},e=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};i.prototype={to:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this},from:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this._from=!0,this},rotate:function(t,i,n,s,r,h){return this._properties=e(t),this.duration=i,n&&(this.easing=n),s&&this.delay(s),r&&this.repeat(r),h&&this.yoyo(h),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var n=function(t){return 1-s(1-t)},s=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:t,Tween:i,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){return t*t*(2.70158*t-1.70158)},BackOut:function(t){return--t*t*(2.70158*t+1.70158)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:n,BounceOut:s,BounceInOut:function(t){return t<.5?.5*n(2*t):.5*s(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",function(t){this._tweenManager.update(t)})},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.on("destroy",function(){e.stop()}),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();var CollectionConfig=pc.createScript("collectionConfig");CollectionConfig.attributes.add("collectionName",{type:"string"}),CollectionConfig.attributes.add("colorScheme",{type:"entity"}),CollectionConfig.attributes.add("collectionType",{type:"number",default:0,enum:[{Regular:0},{Tutorial:1},{Gifts:2}]}),CollectionConfig.attributes.add("lockType",{type:"number",default:0,enum:[{None:0},{ByPreviousCollection:1},{ByInAppPurchase:2},{ByBotSubscription:3}]}),CollectionConfig.attributes.add("inAppProductID",{type:"string"}),CollectionConfig.attributes.add("levels",{type:"entity",array:!0});var CollectionLockReason={None:0,PreviousCollection:1,InAppPurchase:2,BotSubscription:3},CollectionType={Regular:0,Tutorial:1,Gifts:2};var botPopupControllerSelf,BotPopupController=pc.createScript("botPopupController");BotPopupController.attributes.add("firstBotReplica",{type:"string"}),BotPopupController.attributes.add("repeatedBotReplica",{type:"string"}),BotPopupController.attributes.add("manualBotReplica",{type:"string"}),BotPopupController.attributes.add("subscriptionText",{type:"entity"}),BotPopupController.attributes.add("subscribeBtn",{type:"entity"}),BotPopupController.attributes.add("cancelBtn",{type:"entity"}),BotPopupController.attributes.add("popupView",{type:"entity"});var BotSubscriptionType={First:0,Repeated:1,Manual:2};BotPopupController.prototype.initialize=function(){botPopupControllerSelf=this,UIUtils.addClickListener(this.subscribeBtn,function(){FbApi.checkAndSubscribeBot(),botPopupControllerSelf.entity.enabled=!1},this),UIUtils.addClickListener(this.cancelBtn,function(){botPopupControllerSelf.entity.enabled=!1},this)},BotPopupController.prototype.setBotReplica=function(t,e){this.subscriptionText.element.text=t.replaceAll("\\n","\n"),this.popupView.element.height=e},BotPopupController.prototype.setFirstBotReplica=function(){this.setBotReplica(this.firstBotReplica,550)},BotPopupController.prototype.setRepeatedBotReplica=function(){this.setBotReplica(this.repeatedBotReplica,520)},BotPopupController.prototype.setManualBotReplica=function(){this.setBotReplica(this.manualBotReplica,450)};pc.Entity.prototype.delayedExecute=function(t,e,i){for(var n=0;this["delayedExecuteTween"+n];)n++;var r="delayedExecuteTween"+n;return this[r]=this.tween(void 0).to(1,t,pc.Linear),this[r].start(),this[r].once("complete",function(){e.call(i),this[r]=null},this),this[r]},pc.BoundingBox.prototype.intersectsWithGap=function(t,e){var i=this.getMax(),n=this.getMin(),r=t.getMax(),o=t.getMin();return n.x-e<=r.x&&i.x+e>=o.x&&n.y-e<=r.y&&i.y+e>=o.y&&n.z-e<=r.z&&i.z+e>=o.z},pc.Vec3.prototype.mulBy=function(t){return this.x*=t,this.y*=t,this.z*=t,this},pc.Vec3.prototype.divide=function(t){return this.x/=t,this.y/=t,this.z/=t,this},pc.Vec3.prototype.plus=function(t){return this.x+=t,this.y+=t,this.z+=t,this},pc.Vec3.prototype.getMax=function(){return Math.max(this.x,Math.max(this.y,this.z))},pc.Vec3.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},pc.Vec2.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},pc.GraphNode.prototype.tween=function(t,e){var i=pc.Application.getApplication();if(!i)throw new Error("Couldn't find current application");var n=i.tween(t);return n.entity=this,e&&e.element&&(n.element=e.element),n},pc.Quat.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},pc.Quat.prototype.difAngleDeg=function(t){var e=this.dot(t);if(this.equals(t))return 0;var i=1/(Math.PI/180);return 2*Math.acos(Math.min(Math.abs(e),1))*i},pc.Quat.prototype.rotateTowards=function(t,e){if(0!==this.difAngleDeg(t))return this.slerp(this,t,e)};var OrthoHeightToscaleController=pc.createScript("orthoHeightToscaleController");OrthoHeightToscaleController.attributes.add("cameraEntity",{type:"entity"}),OrthoHeightToscaleController.attributes.add("targetOrthoHeight",{type:"number",default:11}),OrthoHeightToscaleController.prototype.initialize=function(){this.camera=this.cameraEntity.camera},OrthoHeightToscaleController.prototype.update=function(t){var e=this.camera.orthoHeight/this.targetOrthoHeight;this.entity.setLocalScale(e,e,e)};var PlayFab=void 0!==PlayFab?PlayFab:{};PlayFab.settings||(PlayFab.settings={titleId:null,developerSecretKey:null,advertisingIdType:null,advertisingIdValue:null,GlobalHeaderInjection:null,disableAdvertising:!1,AD_TYPE_IDFA:"Idfa",AD_TYPE_ANDROID_ID:"Adid"}),PlayFab._internalSettings||(PlayFab._internalSettings={entityToken:null,sdkVersion:"1.38.190123",requestGetParams:{sdk:"JavaScriptSDK-1.38.190123"},sessionTicket:null,verticalName:null,productionServerUrl:".playfabapi.com",errorTitleId:"Must be have PlayFab.settings.titleId set to call this method",errorLoggedIn:"Must be logged in to call this method",errorEntityToken:"You must successfully call GetEntityToken before calling this",errorSecretKey:"Must have PlayFab.settings.developerSecretKey set to call this method",GetServerUrl:function(){return"http"!==PlayFab._internalSettings.productionServerUrl.substring(0,4)?PlayFab._internalSettings.verticalName?"https://"+PlayFab._internalSettings.verticalName+PlayFab._internalSettings.productionServerUrl:"https://"+PlayFab.settings.titleId+PlayFab._internalSettings.productionServerUrl:PlayFab._internalSettings.productionServerUrl},InjectHeaders:function(t,e){if(e)for(var n in e)try{t.setRequestHeader(gHeaderKey,e[n])}catch(t){console.log("Failed to append header: "+n+" = "+e[n]+"Error: "+t)}},ExecuteRequest:function(t,e,n,i,a,l,r){if(null!=a&&"function"!=typeof a)throw"Callback must be null of a function";null==e&&(e={});var s=new Date,o=JSON.stringify(e),g=[t],S=PlayFab._internalSettings.requestGetParams;if(null!=S){var y=!0;for(var P in S)y?(g.push("?"),y=!1):g.push("&"),g.push(P),g.push("="),g.push(S[P])}var u=g.join(""),b=new XMLHttpRequest;b.open("POST",u,!0),b.setRequestHeader("Content-Type","application/json"),b.setRequestHeader("X-PlayFabSDK","JavaScriptSDK-"+PlayFab._internalSettings.sdkVersion),null!=n&&b.setRequestHeader(n,i),PlayFab._internalSettings.InjectHeaders(b,PlayFab.settings.GlobalHeaderInjection),PlayFab._internalSettings.InjectHeaders(b,r),b.onloadend=function(){if(null!=a){var t;try{t=JSON.parse(b.responseText)}catch(e){t={code:503,status:"Service Unavailable",error:"Connection error",errorCode:2,errorMessage:b.responseText}}t.CallBackTimeMS=new Date-s,t.Request=e,t.CustomData=l,200===t.code?a(t,null):a(null,t)}},b.onerror=function(){if(null!=a){var t;try{t=JSON.parse(b.responseText)}catch(e){t={code:503,status:"Service Unavailable",error:"Connection error",errorCode:2,errorMessage:b.responseText}}t.CallBackTimeMS=new Date-s,t.Request=e,t.CustomData=l,a(null,t)}},b.send(o)}}),PlayFab.buildIdentifier="jbuild_javascriptsdk__sdk-genericslave-3_1",PlayFab.sdkVersion="1.38.190123",PlayFab.GenerateErrorReport=function(t){if(null==t)return"";var e=t.errorMessage;for(var n in t.errorDetails)for(var i in t.errorDetails[n])e+="\n"+n+": "+t.errorDetails[n][i];return e},PlayFab.ClientApi={IsClientLoggedIn:function(){return null!=PlayFab._internalSettings.sessionTicket&&PlayFab._internalSettings.sessionTicket.length>0},ForgetAllCredentials:function(){PlayFab._internalSettings.sessionTicket=null,PlayFab._internalSettings.entityToken=null},AcceptTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AcceptTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddFriend:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddFriend",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddGenericID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddGenericID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddOrUpdateContactEmail:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddOrUpdateContactEmail",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddSharedGroupMembers:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddSharedGroupMembers",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddUsernamePassword:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddUsernamePassword",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AddUserVirtualCurrency:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AddUserVirtualCurrency",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AndroidDevicePushNotificationRegistration:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AndroidDevicePushNotificationRegistration",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},AttributeInstall:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/AttributeInstall",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,function(t,n){PlayFab.settings.advertisingIdType+="_Successful",null!=e&&"function"==typeof e&&e(t,n)},n,i)},CancelTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/CancelTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConfirmPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConfirmPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumeItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumeItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumePSNEntitlements:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumePSNEntitlements",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ConsumeXboxEntitlements:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ConsumeXboxEntitlements",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},CreateSharedGroup:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/CreateSharedGroup",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ExecuteCloudScript:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ExecuteCloudScript",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetAccountInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetAccountInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetAllUsersCharacters:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetAllUsersCharacters",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCatalogItems:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCatalogItems",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterInventory:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterInventory",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCharacterStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCharacterStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetContentDownloadUrl:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetContentDownloadUrl",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetCurrentGames:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetCurrentGames",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendLeaderboardAroundPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendLeaderboardAroundPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetFriendsList:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetFriendsList",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetGameServerRegions:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetGameServerRegions",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboard:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboard",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardAroundCharacter:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardAroundCharacter",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardAroundPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardAroundPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetLeaderboardForUserCharacters:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetLeaderboardForUserCharacters",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPaymentToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPaymentToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPhotonAuthenticationToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPhotonAuthenticationToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerCombinedInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerCombinedInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerProfile:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerProfile",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerSegments:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerSegments",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerStatisticVersions:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerStatisticVersions",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerTags:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerTags",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayerTrades:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayerTrades",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromFacebookIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromFacebookIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromFacebookInstantGamesIds:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromFacebookInstantGamesIds",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGameCenterIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGameCenterIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGenericIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGenericIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromGoogleIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromGoogleIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromKongregateIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromKongregateIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromNintendoSwitchDeviceIds:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromNintendoSwitchDeviceIds",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromPSNAccountIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromPSNAccountIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromSteamIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromSteamIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromTwitchIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromTwitchIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPlayFabIDsFromXboxLiveIDs:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPlayFabIDsFromXboxLiveIDs",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetSharedGroupData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetSharedGroupData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetStoreItems:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetStoreItems",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTime:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTime",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitleData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitleData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitleNews:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitleNews",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetTitlePublicKey:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTitlePublicKey",t,null,null,e,n,i)},GetTradeStatus:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetTradeStatus",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserInventory:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserInventory",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserPublisherReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserPublisherReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetUserReadOnlyData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetUserReadOnlyData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},GetWindowsHelloChallenge:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GetWindowsHelloChallenge",t,null,null,e,n,i)},GrantCharacterToUser:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/GrantCharacterToUser",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkAndroidDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkAndroidDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkCustomID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkCustomID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkFacebookAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkFacebookAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkFacebookInstantGamesId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkFacebookInstantGamesId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkGameCenterAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkGameCenterAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkGoogleAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkGoogleAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkIOSDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkIOSDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkKongregate:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkKongregate",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkNintendoSwitchDeviceId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkNintendoSwitchDeviceId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkOpenIdConnect:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkOpenIdConnect",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkPSNAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkPSNAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkSteamAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkSteamAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkTwitch:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkTwitch",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkWindowsHello:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkWindowsHello",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LinkXboxAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LinkXboxAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},LoginWithAndroidDeviceID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithAndroidDeviceID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithCustomID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithCustomID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithEmailAddress:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithEmailAddress",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithFacebook:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithFacebook",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithFacebookInstantGamesId:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithFacebookInstantGamesId",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithGameCenter:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithGameCenter",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithGoogleAccount:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithGoogleAccount",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithIOSDeviceID:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithIOSDeviceID",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithKongregate:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithKongregate",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithNintendoSwitchDeviceId:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithNintendoSwitchDeviceId",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithOpenIdConnect:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithOpenIdConnect",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithPlayFab:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithPlayFab",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithPSN:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithPSN",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithSteam:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithSteam",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithTwitch:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithTwitch",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithWindowsHello:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithWindowsHello",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},LoginWithXbox:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/LoginWithXbox",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},Matchmake:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/Matchmake",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},OpenTrade:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/OpenTrade",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},PayForPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/PayForPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},PurchaseItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/PurchaseItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RedeemCoupon:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RedeemCoupon",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RefreshPSNAuthToken:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RefreshPSNAuthToken",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RegisterForIOSPushNotification:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterForIOSPushNotification",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RegisterPlayFabUser:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterPlayFabUser",t,null,null,function(t,n){null!=t&&null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket,PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},RegisterWithWindowsHello:function(t,e,n,i){if(t.TitleId=PlayFab.settings.titleId?PlayFab.settings.titleId:t.TitleId,!t.TitleId)throw PlayFab._internalSettings.errorTitleId;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RegisterWithWindowsHello",t,null,null,function(t,n){null!=t&&(null!=t.data.SessionTicket&&(PlayFab._internalSettings.sessionTicket=t.data.SessionTicket),null!=t.data.EntityToken&&(PlayFab._internalSettings.entityToken=t.data.EntityToken.EntityToken),PlayFab.ClientApi._MultiStepClientLogin(t.data.SettingsForUser.NeedsAttribution)),null!=e&&"function"==typeof e&&e(t,n)},n,i)},RemoveContactEmail:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveContactEmail",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveFriend:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveFriend",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveGenericID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveGenericID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RemoveSharedGroupMembers:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RemoveSharedGroupMembers",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ReportDeviceInfo:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ReportDeviceInfo",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ReportPlayer:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ReportPlayer",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},RestoreIOSPurchases:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/RestoreIOSPurchases",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SendAccountRecoveryEmail:function(t,e,n,i){PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SendAccountRecoveryEmail",t,null,null,e,n,i)},SetFriendTags:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SetFriendTags",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SetPlayerSecret:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SetPlayerSecret",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},StartGame:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/StartGame",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},StartPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/StartPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},SubtractUserVirtualCurrency:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/SubtractUserVirtualCurrency",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkAndroidDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkAndroidDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkCustomID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkCustomID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkFacebookAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkFacebookAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkFacebookInstantGamesId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkFacebookInstantGamesId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkGameCenterAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkGameCenterAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkGoogleAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkGoogleAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkIOSDeviceID:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkIOSDeviceID",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkKongregate:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkKongregate",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkNintendoSwitchDeviceId:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkNintendoSwitchDeviceId",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkOpenIdConnect:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkOpenIdConnect",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkPSNAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkPSNAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkSteamAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkSteamAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkTwitch:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkTwitch",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkWindowsHello:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkWindowsHello",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlinkXboxAccount:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlinkXboxAccount",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlockContainerInstance:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlockContainerInstance",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UnlockContainerItem:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UnlockContainerItem",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateAvatarUrl:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateAvatarUrl",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateCharacterData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateCharacterData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateCharacterStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateCharacterStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdatePlayerStatistics:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdatePlayerStatistics",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateSharedGroupData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateSharedGroupData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserPublisherData:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserPublisherData",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},UpdateUserTitleDisplayName:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/UpdateUserTitleDisplayName",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateAmazonIAPReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateAmazonIAPReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateGooglePlayPurchase:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateGooglePlayPurchase",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateIOSReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateIOSReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},ValidateWindowsStoreReceipt:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/ValidateWindowsStoreReceipt",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WriteCharacterEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WriteCharacterEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WritePlayerEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WritePlayerEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},WriteTitleEvent:function(t,e,n,i){if(!PlayFab._internalSettings.sessionTicket)throw PlayFab._internalSettings.errorLoggedIn;PlayFab._internalSettings.ExecuteRequest(PlayFab._internalSettings.GetServerUrl()+"/Client/WriteTitleEvent",t,"X-Authorization",PlayFab._internalSettings.sessionTicket,e,n,i)},_MultiStepClientLogin:function(t){if(t&&!PlayFab.settings.disableAdvertising&&null!==PlayFab.settings.advertisingIdType&&null!==PlayFab.settings.advertisingIdValue){var e={};if(PlayFab.settings.advertisingIdType===PlayFab.settings.AD_TYPE_IDFA)e.Idfa=PlayFab.settings.advertisingIdValue;else{if(PlayFab.settings.advertisingIdType!==PlayFab.settings.AD_TYPE_ANDROID_ID)return;e.Adid=PlayFab.settings.advertisingIdValue}PlayFab.ClientApi.AttributeInstall(e,null)}}};var PlayFabClientSDK=PlayFab.ClientApi;PlayFab.RegisterWithPhaser=function(){"undefined"!=typeof Phaser&&(Phaser.Plugin.PlayFab=function(t,e){Phaser.Plugin.call(this,t,e)},Phaser.Plugin.PlayFab.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.PlayFab.prototype.constructor=Phaser.Plugin.PlayFab,Phaser.Plugin.PlayFab.prototype.PlayFab=PlayFab,Phaser.Plugin.PlayFab.prototype.settings=PlayFab.settings,Phaser.Plugin.PlayFab.prototype.ClientApi=PlayFab.ClientApi)},PlayFab.RegisterWithPhaser();var PuzzleSnapController=pc.createScript("puzzleSnapController");PuzzleSnapController.attributes.add("cameraHolder",{type:"entity"}),PuzzleSnapController.attributes.add("puzzleEntity",{type:"entity",description:"Entity with PuzzleController script"}),PuzzleSnapController.attributes.add("effectHolder",{type:"entity"}),PuzzleSnapController.attributes.add("snapDistancePxl",{type:"number",default:5}),PuzzleSnapController.attributes.add("snapTime",{type:"number",default:.5}),PuzzleSnapController.attributes.add("snapAnimTime",{type:"number",default:.5}),PuzzleSnapController.attributes.add("alertMaxDistPxl",{type:"number",default:30}),PuzzleSnapController.attributes.add("colorAnimTime",{type:"number",default:2}),PuzzleSnapController.attributes.add("conflictAnimTime",{type:"number",default:2}),PuzzleSnapController.attributes.add("conflictAnimEasing",{type:"string",default:"Linear",enum:[{Linear:"Linear"},{QuadraticIn:"QuadraticIn"},{QuadraticOut:"QuadraticOut"},{QuadraticInOut:"QuadraticInOut"},{CubicIn:"CubicIn"},{CubicOut:"CubicOut"},{CubicInOut:"CubicInOut"},{QuarticIn:"QuarticIn"},{QuarticOut:"QuarticOut"},{QuarticInOut:"QuarticInOut"},{QuinticIn:"QuinticIn"},{QuinticOut:"QuinticOut"},{QuinticInOut:"QuinticInOut"},{SineIn:"SineIn"},{SineOut:"SineOut"},{SineInOut:"SineInOut"},{ExponentialIn:"ExponentialIn"},{ExponentialOut:"ExponentialOut"},{ExponentialInOut:"ExponentialInOut"},{CircularIn:"CircularIn"},{CircularOut:"CircularOut"},{CircularInOut:"CircularInOut"},{BackIn:"BackIn"},{BackOut:"BackOut"},{BackInOut:"BackInOut"},{BounceIn:"BounceIn"},{BounceOut:"BounceOut"},{BounceInOut:"BounceInOut"},{ElasticIn:"ElasticIn"},{ElasticOut:"ElasticOut"},{ElasticInOut:"ElasticInOut"}]}),PuzzleSnapController.attributes.add("snapIntensity",{type:"number",default:.5,min:0,max:.9}),PuzzleSnapController.attributes.add("hsvHolder",{type:"entity",array:!0}),PuzzleSnapController.prototype.initialize=function(){this.puzzle=this.puzzleEntity.script.puzzleController,this.input=this.cameraHolder.script.mouseInput,this.camera=this.cameraHolder.camera,this.snappedFragments=new HashSet,this.movingFragments=new HashSet,this.tempVec2=new pc.Vec2(0,0),this.tempVec3=new pc.Vec3(0,0,0),this.tempVec3_2=new pc.Vec3(0,0,0),this.tempBb=new pc.BoundingBox,this.time=0,this.snapBeginTime=0,this.activeDistance=0,this.activeStep=0,this.snapInProgress=!1,this.animColors=[];for(var t=0;t<this.hsvHolder.length;t++)this.animColors.push(this.hsvHolder[t].script.hsvColorDelta);this.app.on("game:start",this.onGameStart.bind(this))},PuzzleSnapController.prototype.update=function(t){this.time+=t,this.puzzle.ready&&(this.input.lookButtonDown&&this.checkSnapping(t),this.distanceToColor())},PuzzleSnapController.prototype.tweenColor=function(t,e,n){for(var a=this.animColors,i=0;i<a.length;i++)a[i].tweenColor(t,e,n)},PuzzleSnapController.prototype.distanceToColor=function(){var t=Math.floor(this.alertMaxDistPxl/this.snapDistancePxl),e=Math.min(Math.floor(this.activeDistance/this.snapDistancePxl),t);(e!=this.activeStep||0===e&&0===this.snapBeginTime)&&(this.activeStep=e,0===e&&0===this.snapBeginTime?this.tweenColor(0,!1,this.snapAnimTime+1):this.tweenColor((1-this.snapIntensity)*(1-e/t),!0,this.colorAnimTime))},PuzzleSnapController.prototype.checkSnapping=function(t){if(!this.snapInProgress){var e=this.puzzle.activePuzzle.pairs,n=!1,a=this.time;this.activeDistance=9007199254740991;for(var i=0;i<e.length;i++){var r=e[i];if(!r.snapped){var o=this.camera.worldToScreen(r.fragment1.node.getPosition()),s=this.camera.worldToScreen(r.fragment2.node.getPosition()),l=this.getDistance2(o,s);if(this.activeDistance>l&&(this.activeDistance=l),l<=this.snapDistancePxl){if(n=!0,0===this.snapBeginTime&&(this.snapBeginTime=a),a-this.snapBeginTime>=this.snapTime){n=!1,this.snappedFragments.clear();var p=o.z<s.z?r.fragment1:r.fragment2,c=o.z>=s.z?r.fragment1:r.fragment2,u=c.node.getLocalPosition();this.collectSnappedFragments(p,u);for(var h=this.snappedFragments.values(),m=0;m<h.length;m++){var d=h[m],z=d.node.getLocalPosition();d.node.tween(z).to(u,this.snapAnimTime,pc.Linear).start()}this.collectSnappedFragments(c),this.playSnapEffect(this.tempBb.center),this.detectCollisionAndMove(u),r.snapped=!0,this.snapInProgress=!0,this.entity.delayedExecute(this.snapAnimTime+.1,this.onSnap,this)}break}}}n||(this.snapBeginTime=0)}},PuzzleSnapController.prototype.playSnapEffect=function(t){this.effectHolder.setLocalPosition(t),this.effectHolder.particlesystem.reset(),this.effectHolder.particlesystem.play()},PuzzleSnapController.prototype.collectSnappedFragments=function(t,e){var n=this.puzzle.activePuzzle.pairs,a=this.snappedFragments,i=this.tempBb;e&&(this.tempVec3.copy(t.node.getLocalPosition()),t.node.setLocalPosition(e)),0===a.size()?i.copy(t.aabb):i.add(t.aabb),e&&t.node.setLocalPosition(this.tempVec3),a.add(t);for(var r=0;r<n.length;r++){var o=n[r];if(o.snapped&&(o.fragment1==t||o.fragment2==t)){var s=o.fragment1==t?o.fragment2:o.fragment1;a.has(s)||this.collectSnappedFragments(s,e)}}},PuzzleSnapController.prototype.snapConnectedFragments=function(){for(var t=this.puzzle.activePuzzle.pairs,e=0;e<t.length;e++){var n=t[e];!n.snapped&&n.fragment1.node.getLocalPosition().distance(n.fragment2.node.getLocalPosition())<1e-7&&(n.snapped=!0)}},PuzzleSnapController.prototype.onSnap=function(){this.snapConnectedFragments(),this.snapInProgress=!1,this.app.fire("game:fragment:snapped"),this.puzzle.checkGameCompleted()&&this.app.fire("camera:refreshFocus",!1,!0),playSnapAudio()},PuzzleSnapController.prototype.getDistance2=function(t,e){return this.tempVec2.set(t.x-e.x,t.y-e.y),this.tempVec2.length()},PuzzleSnapController.prototype.onGameStart=function(){this.activeDistance=9007199254740991,this.snapInProgress=!1},PuzzleSnapController.prototype.detectCollisionAndMove=function(t){var e,n=this.puzzle.activePuzzle.fragments,a=this.snappedFragments,i=this.movingFragments,r=this.tempBb,o=this.tempVec3,s=this.tempVec3_2,l=(this.puzzle.localCenter,0),p=0,c=r.halfExtents.getMax(),u=n[0].node.getLocalScale().x;for(i.clear(),l=0;l<n.length;l++)if(e=n[l],!a.has(e)&&!i.has(e)&&r.intersects(e.aabb)){var h=[];s.copy(this.findAvgPairsCenter(e)),o.copy(e.aabb.center),o.sub(s).normalize();o.length();o.scale(c*u).add(s).sub(s.copy(e.aabb.center).sub(e.node.getLocalPosition())),this.collectConnectedFragments(e,i,h);var m=pc[this.conflictAnimEasing];for(p=0;p<h.length;p++){var d=(e=h[p]).node.getLocalPosition();e.node.tween(d).to(o.clone(),this.conflictAnimTime,m).start()}}},PuzzleSnapController.prototype.findAvgPairsCenter=function(t){var e,n,a=this.puzzle.activePuzzle.pairs,i=this.tempVec3,r=this.tempVec3_2;r.set(0,0,0);for(var o=0,s=0;s<a.length;s++)(e=a[s]).fragment1!=t&&e.fragment2!=t||(n=e.fragment1==t?e.fragment2:e.fragment1,i.copy(n.node.getLocalPosition()),n.node.setLocalPosition(t.node.getLocalPosition()),r.add(n.aabb.center),n.node.setLocalPosition(i),o++);return r.divide(o),r},PuzzleSnapController.prototype.collectConnectedFragments=function(t,e,n){var a=this.puzzle.activePuzzle.pairs;e.add(t),n.push(t);for(var i=0;i<a.length;i++){var r=a[i];if(r.snapped&&(r.fragment1==t||r.fragment2==t)){var o=r.fragment1==t?r.fragment2:r.fragment1;e.has(o)||this.collectConnectedFragments(o,e,n)}}};function HashSet(n,t){var e=new Hashtable(n,t);this.add=function(n){e.put(n,!0)},this.addAll=function(n){for(var t=0,i=n.length;t<i;++t)e.put(n[t],!0)},this.values=function(){return e.keys()},this.remove=function(n){return e.remove(n)?n:null},this.contains=function(n){return e.containsKey(n)},this.has=function(n){return e.containsKey(n)},this.clear=function(){e.clear()},this.size=function(){return e.size()},this.isEmpty=function(){return e.isEmpty()},this.clone=function(){var i=new HashSet(n,t);return i.addAll(e.keys()),i},this.intersection=function(i){for(var s,r=new HashSet(n,t),u=i.values(),o=u.length;o--;)s=u[o],e.containsKey(s)&&r.add(s);return r},this.union=function(n){for(var t,i=this.clone(),s=n.values(),r=s.length;r--;)t=s[r],e.containsKey(t)||i.add(t);return i},this.isSubsetOf=function(n){for(var t=e.keys(),i=t.length;i--;)if(!n.contains(t[i]))return!1;return!0},this.complement=function(e){for(var i,s=new HashSet(n,t),r=this.values(),u=r.length;u--;)i=r[u],e.contains(i)||s.add(i);return s}}var Hashtable=function(e){var t="function",n="string";if("undefined"==typeof encodeURIComponent||Array.prototype.splice===e||Object.prototype.hasOwnProperty===e)return null;function toStr(e){return typeof e==n?e:""+e}function hashObject(e){var r;return typeof e==n?e:typeof e.hashCode==t?typeof(r=e.hashCode())==n?r:hashObject(r):toStr(e)}function equals_fixedValueHasEquals(e,t){return e.equals(t)}function equals_fixedValueNoEquals(e,n){return typeof n.equals==t?n.equals(e):e===n}function createKeyValCheck(t){return function(n){if(null===n)throw new Error("null is not a valid "+t);if(n===e)throw new Error(t+" must not be undefined")}}var r=createKeyValCheck("key"),u=createKeyValCheck("value");function Bucket(e,t,n,r){this[0]=e,this.entries=[],this.addEntry(t,n),null!==r&&(this.getEqualityFunction=function(){return r})}var i=0,a=1,s=2;function createBucketSearcher(e){return function(t){for(var n,r=this.entries.length,u=this.getEqualityFunction(t);r--;)if(u(t,(n=this.entries[r])[0]))switch(e){case i:return!0;case a:return n;case s:return[r,n[1]]}return!1}}function createBucketLister(e){return function(t){for(var n=t.length,r=0,u=this.entries,i=u.length;r<i;++r)t[n+r]=u[r][e]}}function getBucketForHash(e,t){var n=e[t];return n&&n instanceof Bucket?n:null}function Hashtable(){var t=[],n={},i={replaceDuplicateKey:!0,hashCode:hashObject,equals:null},a=arguments[0],s=arguments[1];s!==e?(i.hashCode=a,i.equals=s):a!==e&&function merge(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(i,a);var o=i.hashCode,c=i.equals;this.properties=i,this.put=function(e,a){r(e),u(a);var s,l,h=o(e),f=null;return(s=getBucketForHash(n,h))?(l=s.getEntryForKey(e))?(i.replaceDuplicateKey&&(l[0]=e),f=l[1],l[1]=a):s.addEntry(e,a):(s=new Bucket(h,e,a,c),t.push(s),n[h]=s),f},this.get=function(e){r(e);var t=o(e),u=getBucketForHash(n,t);if(u){var i=u.getEntryForKey(e);if(i)return i[1]}return null},this.containsKey=function(e){r(e);var t=o(e),u=getBucketForHash(n,t);return!!u&&u.containsKey(e)},this.containsValue=function(e){u(e);for(var n=t.length;n--;)if(t[n].containsValue(e))return!0;return!1},this.clear=function(){t.length=0,n={}},this.isEmpty=function(){return!t.length};var l=function(e){return function(){for(var n=[],r=t.length;r--;)t[r][e](n);return n}};this.keys=l("keys"),this.values=l("values"),this.entries=l("getEntries"),this.remove=function(e){r(e);var u,i=o(e),a=null,s=getBucketForHash(n,i);return s&&null!==(a=s.removeEntryForKey(e))&&0===s.entries.length&&(u=function searchBuckets(e,t){for(var n=e.length;n--;)if(t===e[n][0])return n;return null}(t,i),t.splice(u,1),delete n[i]),a},this.size=function(){for(var e=0,n=t.length;n--;)e+=t[n].entries.length;return e}}return Bucket.prototype={getEqualityFunction:function(e){return typeof e.equals==t?equals_fixedValueHasEquals:equals_fixedValueNoEquals},getEntryForKey:createBucketSearcher(a),getEntryAndIndexForKey:createBucketSearcher(s),removeEntryForKey:function(e){var t=this.getEntryAndIndexForKey(e);return t?(this.entries.splice(t[0],1),t[1]):null},addEntry:function(e,t){this.entries.push([e,t])},keys:createBucketLister(0),values:createBucketLister(1),getEntries:function(e){for(var t=e.length,n=0,r=this.entries,u=r.length;n<u;++n)e[t+n]=r[n].slice(0)},containsKey:createBucketSearcher(i),containsValue:function(e){for(var t=this.entries,n=t.length;n--;)if(e===t[n][1])return!0;return!1}},(Hashtable.prototype={each:function(e){for(var t,n=this.entries(),r=n.length;r--;)e((t=n[r])[0],t[1])},equals:function(e){var t,n,r,u=this.size();if(u==e.size()){for(t=this.keys();u--;)if(n=t[u],null===(r=e.get(n))||r!==this.get(n))return!1;return!0}return!1},putAll:function(e,n){for(var r,u,i,a,s=e.entries(),o=s.length,c=typeof n==t;o--;)u=(r=s[o])[0],i=r[1],c&&(a=this.get(u))&&(i=n(u,a,i)),this.put(u,i)},clone:function(){var e=new Hashtable(this.properties);return e.putAll(this),e}}).toQueryString=function(){for(var e,t=this.entries(),n=t.length,r=[];n--;)e=t[n],r[n]=encodeURIComponent(toStr(e[0]))+"="+encodeURIComponent(toStr(e[1]));return r.join("&")},Hashtable}();var audioControllerSelf,AudioController=pc.createScript("audioController");function canPlayAudio(){return PlayerData.sound&&!GameData.paused}function playAudio(o){canPlayAudio()&&audioControllerSelf.entity.sound.play(o)}function stopAudio(o){audioControllerSelf.entity.sound.stop(o)}function stopAllAudios(){stopAudio()}function playButtonTapAudio(){playAudio("ButtonTap")}function playSnapAudio(){playAudio("Snap")}function playLevelFinishAudio(){playAudio("LevelFinish")}function playPackUnlockAudio(){playAudio("PackUnlock")}function playInAppAudio(){playAudio("InApp")}function playGiftAudio(){playAudio("Gift")}function playArrowTapAudio(){playAudio("ArrowTap")}function playPopupAudio(){playAudio("Popup")}function playAmbientAudio(){playAudio("Ambient")}AudioController.prototype.initialize=function(){audioControllerSelf=this,this.app.on("game:pause",this.onGamePause),this.app.on("game:unpause",this.onGameUnpause)},AudioController.prototype.onGamePause=function(){stopAllAudios()},AudioController.prototype.onGameUnpause=function(){playAmbientAudio()};var InGameBg=pc.createScript("inGameBg");InGameBg.attributes.add("rootImage",{type:"entity"}),InGameBg.attributes.add("gradient",{type:"entity"}),InGameBg.attributes.add("glow1",{type:"entity"}),InGameBg.attributes.add("glow2",{type:"entity"}),InGameBg.attributes.add("glow3",{type:"entity"}),InGameBg.attributes.add("shadow",{type:"entity"}),InGameBg.attributes.add("vignette",{type:"entity"});var BgColors=pc.createScript("bgColors");BgColors.attributes.add("rootImageColor",{type:"rgb"}),BgColors.attributes.add("rootImageOpacity",{type:"number",default:1}),BgColors.attributes.add("gradientColor",{type:"rgb"}),BgColors.attributes.add("gradientOpacity",{type:"number",default:1}),BgColors.attributes.add("glow1Color",{type:"rgb"}),BgColors.attributes.add("glow1Opacity",{type:"number",default:1}),BgColors.attributes.add("glow2Color",{type:"rgb"}),BgColors.attributes.add("glow2Opacity",{type:"number",default:1}),BgColors.attributes.add("glow3Color",{type:"rgb"}),BgColors.attributes.add("glow3Opacity",{type:"number",default:1}),BgColors.attributes.add("shadowColor",{type:"rgb"}),BgColors.attributes.add("shadowOpacity",{type:"number",default:1}),BgColors.attributes.add("vignetteColor",{type:"rgb"}),BgColors.attributes.add("vignetteOpacity",{type:"number",default:1}),BgColors.attributes.add("itemViewShadowColor",{type:"rgb"}),BgColors.attributes.add("itemViewShadowOpacity",{type:"number",default:.3}),BgColors.attributes.add("fogColor",{type:"rgba",default:[.37,.64,.87,1]});var MaterialsConfig=pc.createScript("materialsConfig");MaterialsConfig.attributes.add("baseMaterial",{type:"asset",assetType:"material"}),MaterialsConfig.attributes.add("fractureMaterial",{type:"asset",assetType:"material"});var HsvColor=pc.createScript("hsvColor");Object.defineProperty(HsvColor.prototype,"hueAngle",{get:function(){return 360*this.h}}),HsvColor.prototype.initialize=function(){this.h=0,this.s=0,this.v=0,this.a=0,this.color=new pc.Color,this.entity.element&&this.linkColor(this.entity.element.color)},HsvColor.prototype.linkColor=function(t){var o=pc.math.clamp(t.r,0,1),i=pc.math.clamp(t.g,0,1),h=pc.math.clamp(t.b,0,1),s=Math.max(o,Math.max(i,h)),e=s-Math.min(o,Math.min(i,h));Math.abs(e)<.001?this.h=0:this.h=o>=i&&o>=h?(i-h)/e%6/6:i>=h?((h-o)/e+2)/6:((o-i)/e+4)/6,this.s=s>0?e/s:0,this.v=s,this.a=pc.math.clamp(t.a,0,1),this.normalize()},HsvColor.prototype.normalize=function(){this.h=this.h%1,this.h<0&&(this.h+=1),this.s=pc.math.clamp(this.s,0,1),this.v=pc.math.clamp(this.v,0,1),this.a=pc.math.clamp(this.a,0,1)},HsvColor.prototype.toColor=function(t){var o=this.h%1*360/60;o<0&&(o+=60);var i=this.v*this.s,h=i*(1-Math.abs(o%2-1)),s=0,e=0,r=0;switch(Math.floor(o)){case 0:s=i,e=h;break;case 1:s=h,e=i;break;case 2:e=i,r=h;break;case 3:e=h,r=i;break;case 4:s=h,r=i;break;case 5:s=i,r=h}var a=this.v-i;return t.set(s+a,e+a,r+a,this.a)},HsvColor.prototype.refreshColor=function(){this.entity.element&&this.linkColor(this.entity.element.color)},HsvColor.prototype.updateColor=function(t){if(this.entity.element){this.toColor(this.color);this.entity.element.color=this.toColor(this.color)}};var HsvColorDelta=pc.createScript("hsvColorDelta");HsvColorDelta.attributes.add("hueDelta",{type:"number",min:-1,max:1,description:""}),HsvColorDelta.attributes.add("saturationDelta",{type:"number",min:-1,max:1,description:"??"}),HsvColorDelta.attributes.add("valueDelta",{type:"number",min:-1,max:1,description:"??"}),HsvColorDelta.attributes.add("alphaDelta",{type:"number",min:-1,max:1}),HsvColorDelta.attributes.add("testMode",{type:"boolean"}),HsvColorDelta.prototype.initialize=function(){this.hsvColor=this.entity.script.hsvColor,this.color={h:this.hsvColor.h,s:this.hsvColor.s,v:this.hsvColor.v,a:this.hsvColor.a},this.interruptable=!0,this.totalDiff={h:this.hueDelta,s:this.saturationDelta,v:this.valueDelta,a:this.alphaDelta},this.currentDiff={h:0,s:0,v:0,a:0},this.targetDiff={h:0,s:0,v:0,a:0},this.on("attr:hueDelta",function(t,o){this.totalDiff.h=t,this.testMode&&(this.hsvColor.h=pc.math.clamp(this.color.h+t,0,1),this.hsvColor.updateColor())}),this.on("attr:saturationDelta",function(t,o){this.totalDiff.s=t,this.testMode&&(this.hsvColor.s=pc.math.clamp(this.color.s+t,0,1),this.hsvColor.updateColor())}),this.on("attr:valueDelta",function(t,o){this.totalDiff.v=t,this.testMode&&(this.hsvColor.v=pc.math.clamp(this.color.v+t,0,1),this.hsvColor.updateColor())}),this.on("attr:alphaDelta",function(t,o){this.totalDiff.a=t,this.testMode&&(this.hsvColor.a=pc.math.clamp(this.color.a+t,0,1),this.hsvColor.updateColor())}),this.on("attr:testMode",function(t,o){t?(this.hsvColor.h=pc.math.clamp(this.color.h+this.hueDelta,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.saturationDelta,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.valueDelta,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.alphaDelta,0,1),this.hsvColor.updateColor()):(this.hsvColor.h=pc.math.clamp(this.color.h,0,1),this.hsvColor.s=pc.math.clamp(this.color.s,0,1),this.hsvColor.v=pc.math.clamp(this.color.v,0,1),this.hsvColor.a=pc.math.clamp(this.color.a,0,1),this.hsvColor.updateColor())}),this.app.on("ui:bg_updated",function(){this.hsvColor.refreshColor(),this.color.h=this.hsvColor.h,this.color.s=this.hsvColor.s,this.color.v=this.hsvColor.v,this.color.a=this.hsvColor.a,this.testMode&&(this.hsvColor.h=pc.math.clamp(this.color.h+this.hueDelta,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.saturationDelta,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.valueDelta,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.alphaDelta,0,1),this.hsvColor.updateColor())}.bind(this)),this.tween=this.app.tween(this.currentDiff),this.tween.on("update",this.updateColor.bind(this))},HsvColorDelta.prototype.tweenColor=function(t,o,s){var h=this.tween;h.playing&&!this.interruptable||(h.stop(),this.interruptable=o,this.targetDiff.h=this.totalDiff.h*t,this.targetDiff.s=this.totalDiff.s*t,this.targetDiff.v=this.totalDiff.v*t,this.targetDiff.a=this.totalDiff.a*t,h.to(this.targetDiff,s,pc.Linear),h.start())},HsvColorDelta.prototype.updateColor=function(){this.hsvColor.h=pc.math.clamp(this.color.h+this.currentDiff.h,0,1),this.hsvColor.s=pc.math.clamp(this.color.s+this.currentDiff.s,0,1),this.hsvColor.v=pc.math.clamp(this.color.v+this.currentDiff.v,0,1),this.hsvColor.a=pc.math.clamp(this.color.a+this.currentDiff.a,0,1),this.hsvColor.updateColor()};var CollectionLockedBypurchasePopup=pc.createScript("collectionLockedBypurchasePopup");CollectionLockedBypurchasePopup.attributes.add("gameController",{type:"entity"}),CollectionLockedBypurchasePopup.attributes.add("purchaseBtn",{type:"entity"}),CollectionLockedBypurchasePopup.attributes.add("purchaseBtnText",{type:"entity"}),CollectionLockedBypurchasePopup.prototype.initialize=function(){this.product=null,UIUtils.addClickListener(this.purchaseBtn,this.onClick,this),this.onCatalogReceived(FbApi.storeCatalog),this.app.on("store:catalog_received",this.onCatalogReceived.bind(this))},CollectionLockedBypurchasePopup.prototype.getProductId=function(){return playerControllerSelf.gameController.script.gameController.collections[GameData.selectedCollectionIndex].script.collectionConfig.inAppProductID},CollectionLockedBypurchasePopup.prototype.onClick=function(e){FbApi.billingAvailable&&!this.purchasing&&(this.purchasing=!1,FbApi.purchaseAsync(this.getProductId(),FbApi.getPlayerID(),this.onPurchase))},CollectionLockedBypurchasePopup.prototype.onCatalogReceived=function(e){var t=this.getProduct(e,this.getProductId());t&&FbApi.billingAvailable?(this.product=t,this.purchaseBtnText.element.text="BUY "+this.generateProductPriceView(t)):this.purchaseBtnText.element.text="UNAVAILABLE"},CollectionLockedBypurchasePopup.prototype.generateProductPriceView=function(e){return e.price.replace(/[^\d.-]/g,"")+" "+e.priceCurrencyCode},CollectionLockedBypurchasePopup.prototype.onPurchase=function(e){this.purchasing=!1,e?(playInAppAudio(),this.app.fire("collection.unlocked",GameData.selectedCollectionIndex),this.app.fire("collections:update"),this.entity.enabled=!1,console.log("onPurchase: success")):console.log("onPurchase: fail")},CollectionLockedBypurchasePopup.prototype.getProduct=function(e,t){if(!e)return null;for(var o=0;o<e.length;o++)if(e[o].productID==t)return e[o];return null},CollectionLockedBypurchasePopup.prototype.productExists=function(e,t){for(var o=0;o<e.length;o++)if(e[o].productID==t)return!0;return!1},CollectionLockedBypurchasePopup.prototype.productBuyed=function(e,t){return this.productExists(e,t)},CollectionLockedBypurchasePopup.prototype.productAvailable=function(e,t){return this.productExists(e,t)};var BossController=pc.createScript("bossController");BossController.attributes.add("puzzleHolder",{type:"entity"}),BossController.attributes.add("cameraHolder",{type:"entity"}),BossController.attributes.add("fogHolder",{type:"entity"}),BossController.attributes.add("finalPartsDistance",{type:"number",default:10}),BossController.attributes.add("fogAnimationTime",{type:"number",default:.5}),BossController.attributes.add("inactivePartsScale",{type:"number",default:.5}),BossController.prototype.initialize=function(){this.puzzle=this.puzzleHolder.script.puzzleController,this.camera=this.cameraHolder.camera,this.pivotPoint=null,this.partSwitchAnimTime=0,this.originalScale=new pc.Vec3(0,0,0),this.inactiveScale=new pc.Vec3(0,0,0),this.app.on("game:ready",this.setup.bind(this)),this.app.on("camera:refreshView",this.checkPuzzle.bind(this));var e=function(){this.enabled=!1,this.fogHolder.setLocalScale(pc.Vec3.ZERO),this.scaleMeshes(this.puzzle.puzzle.meshes,this.originalScale,!1)}.bind(this);this.app.on("game:finish",e),this.app.on("game:stop",e),this.app.on("rewards:get",e),this.app.on("game:parts_completed",this.shortenPartsDistance.bind(this)),this.enabled=!1,this.fogHolder.setLocalScale(pc.Vec3.ZERO)},BossController.prototype.setup=function(){var e=this.cameraHolder.script.orbitCamera;this.partSwitchAnimTime=e.partSwitchAnimTime,this.pivotPoint=e._pivotPoint,this.originalScale.copy(this.puzzle.puzzle.meshes[0].node.getLocalScale()),this.inactiveScale.copy(this.originalScale).scale(this.inactivePartsScale),this.enabled&&this.scaleIncactiveParts(!1)},BossController.prototype.checkPuzzle=function(){var e=this.puzzle.activePuzzle!=this.puzzle.puzzle,t=this.enabled;e&&e===t&&(this.enabled=!1,this.scaleIncactiveParts(!0),this.entity.delayedExecute(this.partSwitchAnimTime,this.enableController,this)),e!==t&&(this.app.tween(this.fogHolder.localScale).to(e?pc.Vec3.ONE:pc.Vec3.ZERO,this.fogAnimationTime,pc.SineOut).on("update",function(){this.fogHolder.setLocalScale(this.fogHolder.localScale)}.bind(this)).start(),this.enabled=e,e||this.scaleMeshes(this.puzzle.activePuzzle.meshes,this.originalScale,!0))},BossController.prototype.showMeshes=function(){for(var e=this.puzzle.puzzle.meshes,t=0;t<e.length;t++)e[t].visible=!0},BossController.prototype.enableController=function(){this.enabled=!0},BossController.prototype.scaleIncactiveParts=function(e){for(var t,s=this.puzzle.parts,i=0;i<s.length;i++)(t=s[i])==this.puzzle.activePuzzle?this.scaleMeshes(t.meshes,this.originalScale,!1):this.scaleMeshes(t.meshes,this.inactiveScale,e)},BossController.prototype.scaleMeshes=function(e,t,s){for(var i=0;i<e.length;i++){var o=e[i];s?o.node.tween(o.node.getLocalScale()).to(t,.5,pc.Linear).start():o.node.setLocalScale(t)}},BossController.prototype.shortenPartsDistance=function(e){for(var t,s=this.puzzle.parts,i=e.fragments[0].node.getLocalScale().x*this.finalPartsDistance,o=e.fragments[0].node.getLocalPosition(),a=new pc.Vec3(0,0,0),l=0;l<s.length;l++)if((t=s[l])!=e){var n=t.fragments[0].node.getLocalPosition();a.copy(n).sub(o);a.length();a.normalize().scale(i).add(o),this.movePartTo(t,a.clone())}},BossController.prototype.movePartTo=function(e,t){for(var s=e.fragments,i=0;i<s.length;i++){s[i].node.setLocalPosition(t)}};var CollectionLockedBybotSubcrPopup=pc.createScript("collectionLockedBybotSubcrPopup");CollectionLockedBybotSubcrPopup.attributes.add("subscribeBtn",{type:"entity"}),CollectionLockedBybotSubcrPopup.prototype.initialize=function(){UIUtils.addClickListener(this.subscribeBtn,function(){FbApi.checkAndSubscribeBot()},this)};var LevelConfig=pc.createScript("levelConfig");LevelConfig.attributes.add("isBoss",{type:"boolean"}),LevelConfig.attributes.add("iconSprite",{type:"asset",assetType:"sprite"}),LevelConfig.attributes.add("model",{type:"asset",assetType:"model"}),LevelConfig.attributes.add("visitorGender",{type:"number",default:0,enum:[{Male:0},{Female:1}]}),LevelConfig.attributes.add("visitorName",{type:"string",default:"John Galt"}),LevelConfig.attributes.add("visitorReview",{type:"string",default:"Lorem ipsum dolor sit amet"});var VisitorGender={Male:0,Female:1};String.prototype.replaceAll=function(t,i){return this.split(t).join(i)};var BotThanksPopup=pc.createScript("botThanksPopup");BotThanksPopup.attributes.add("continueBtn",{type:"entity"}),BotThanksPopup.prototype.initialize=function(){UIUtils.addClickListener(this.continueBtn,function(){this.entity.enabled=!1},this)};var DebugScreenController=pc.createScript("debugScreenController");DebugScreenController.attributes.add("closeBtn",{type:"entity"}),DebugScreenController.attributes.add("resetPlayerSaveBtn",{type:"entity"}),DebugScreenController.attributes.add("interstitialAdsBtn",{type:"entity"}),DebugScreenController.attributes.add("rewardedVideoBtn",{type:"entity"}),DebugScreenController.prototype.initialize=function(){this.closeBtn.element.on("click",function(e){this.entity.enabled=!1},this),this.resetPlayerSaveBtn.element.on("click",function(e){FbApi.resetPlayerData()},this),this.interstitialAdsBtn.element.on("click",function(e){playButtonTapAudio(),console.log("The element "+e.element.entity.name+" was clicked."),FbApi.showInterstitialAd(function(){console.log("int ad showed")},function(){console.log("int ad failed")},"debug")},this),this.rewardedVideoBtn.element.on("click",function(e){playButtonTapAudio(),console.log("The element "+e.element.entity.name+" was clicked."),FbApi.showRewardedVideo(function(){console.log("RewardedVideo showed")},function(){console.log("RewardedVideo failed")},"debug")},this)};var CollectionUlockedPopup=pc.createScript("collectionUlockedPopup");CollectionUlockedPopup.attributes.add("continueButton",{type:"entity"}),CollectionUlockedPopup.attributes.add("closeButton",{type:"entity"}),CollectionUlockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.continueButton,function(){playPackUnlockAudio(),this.app.fire("collection.unlocked",this.collectionIndex),this.app.fire("collection:select",this.collectionIndex),this.entity.enabled=!1},this),UIUtils.addClickListener(this.closeButton,function(){this.entity.enabled=!1},this)};var LevelLockedPopup=pc.createScript("levelLockedPopup");LevelLockedPopup.attributes.add("lockTextElement",{type:"entity"}),LevelLockedPopup.attributes.add("closeBtn",{type:"entity"}),LevelLockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.closeBtn,function(){this.entity.enabled=!1},this)};var SpriteFlipper=pc.createScript("spriteFlipper");SpriteFlipper.attributes.add("cullMode",{type:"number",enum:[{None:0},{FrontFace:1},{BackFace:2}]}),SpriteFlipper.prototype.initialize=function(){this.entity.element._image._material.cull=this.cullMode,this.on("attr:cullMode",function(e,t){this.entity.element._image._material.cull=e})};var GiftLevelLockedPopup=pc.createScript("giftLevelLockedPopup");GiftLevelLockedPopup.attributes.add("closeBtn",{type:"entity"}),GiftLevelLockedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.closeBtn,function(){this.entity.enabled=!1},this)};var UIUtils={animatePressedButton:function(t,e){var n=t.getLocalScale(),o=1.03;t.tween(t.getLocalScale()).to(new pc.Vec3(n.x*o,n.y*o,n.z*o),.07,pc.SineOut).yoyo(!0).repeat(2).on("complete",function(){e()}).start()},onButtonPressed:function(t,e,n){e.stopPropagation(),playButtonTapAudio(),UIUtils.animatePressedButton(t,n)},addClickListener:function(t,e,n){t.element.on("click",function(o){UIUtils.fireButtonClicked(t.name),UIUtils.onButtonPressed(t,o,e.bind(n))},n)},fireButtonClicked:function(t){console.log("ON_CLICK: "+t),pc.Application.getApplication().fire("button:clicked",t)}};var GiftReceivedPopup=pc.createScript("giftReceivedPopup");GiftReceivedPopup.attributes.add("claimButton",{type:"entity"}),GiftReceivedPopup.prototype.initialize=function(){UIUtils.addClickListener(this.claimButton,function(){playGiftAudio(),this.entity.enabled=!1},this)};var ImageToshare=pc.createScript("imageToshare");ImageToshare.attributes.add("screenshotWidth",{type:"number"}),ImageToshare.attributes.add("screenshotHeight",{type:"number"}),ImageToshare.attributes.add("fontType",{type:"string",default:"verdana, sans-serif"}),ImageToshare.attributes.add("visitorNameFontType",{type:"string",default:""}),ImageToshare.attributes.add("visitorNameFontWeight",{type:"string",default:"bold"}),ImageToshare.attributes.add("visitorNameFontFamily",{type:"string",default:"Arial"}),ImageToshare.attributes.add("visitorReviewFontType",{type:"string",default:"italic"}),ImageToshare.attributes.add("visitorReviewFontWeight",{type:"string",default:""}),ImageToshare.attributes.add("visitorReviewFontFamily",{type:"string",default:"monospace"}),ImageToshare.attributes.add("bg",{type:"entity"}),ImageToshare.attributes.add("gradient",{type:"entity"}),ImageToshare.attributes.add("glow1",{type:"entity"}),ImageToshare.attributes.add("glow2",{type:"entity"}),ImageToshare.attributes.add("glow3",{type:"entity"}),ImageToshare.attributes.add("vignette",{type:"entity"}),ImageToshare.attributes.add("flourishImageLayers",{type:"entity",array:!0}),ImageToshare.attributes.add("levelIconImage",{type:"entity"}),ImageToshare.attributes.add("visitorTopSpacing",{type:"number",default:10}),ImageToshare.attributes.add("visitorTopRect",{type:"entity"}),ImageToshare.attributes.add("visitorBackImage",{type:"entity"}),ImageToshare.attributes.add("visitorIconImage",{type:"entity"}),ImageToshare.attributes.add("visitorNameText",{type:"entity"}),ImageToshare.attributes.add("visitorReviewText",{type:"entity"});var EventProducer=function(t){this.settings=this.parseSettings(t),this.options=this.createRequestOptions(),this.pending=store.get("pending")||[],store.remove("pending"),SessionStats.countryCode=store.get("counryCode"),this.wait=void 0===SessionStats.countryCode,this.closing=!1,this.continue=!1;var n=pc.Application.getApplication();n.on("game:pause",function(t){console.log("game:pause"),this.closing=!0,store.set("pending",this.pending)}.bind(this)),n.on("game:unpause",function(t){console.log("game:unpause"),this.closing=!1}.bind(this)),n.on("player:location",function(t){t&&SessionStats.countryCode!=t.CountryCode?(store.set("counryCode",t.CountryCode),SessionStats.countryCode=t.CountryCode,this.updateCountryCode()):SessionStats.countryCode||(SessionStats.countryCode=platform.lang.slice(-2)||"US",this.updateCountryCode()),this.wait=!1,this.send()}.bind(this))};EventProducer.prototype.createRequestOptions=function(){var t={headers:{},async:!0};return t.headers["Content-Type"]="application/vnd.kafka.json.v2+json",t.headers.Accept="application/vnd.kafka.v2+json",t},EventProducer.prototype.send=function(t){t&&(t.constructor===Array?this.pending.push.apply(this.pending,t):this.pending.push(t)),this.pending.length>50&&this.pending.splice(0,this.pending.length-50);var n=this.pending.length;if(!this.wait&&0!==n){var e=this.createDataRecord(this.pending),o=this.buildUrl(this.settings);this.wait=!0,this.continue=!1,pc.http.post(o,e,this.options,function(t,e){null!==t?console.log("error: "+t):e&&(this.continue=this.pending.length!=n,this.pending.splice(0,n)),this.wait=!1,this.closing&&store.set("pending",this.pending),this.continue&&this.send()}.bind(this))}},EventProducer.prototype.buildUrl=function(t){var n=t.user?t.user+":"+t.pasw+"@":"";return t.protocol+"://"+n+t.endpoint+"/topics/"+t.topic},EventProducer.prototype.updateCountryCode=function(){if(0!==this.pending.length)for(var t=this.pending,n=0;n<t.length;n++)t[n].country=SessionStats.countryCode},EventProducer.prototype.createDataRecord=function(t){for(var n={records:[]},e=0;e<t.length;e++)console.log("SEND: "+t[e].type),n.records.push({value:t[e]});return JSON.stringify(n)},EventProducer.prototype.parseSettings=function(t){return t||(t={}),t.protocol=t.protocol?t.protocol:"http",t.endpoint=t.endpoint?t.endpoint:"localhost:8082",t.topic=t.topic?t.topic:"test_topic",t.user=t.user?t.user:null,t.pasw=t.pasw?t.pasw:"",t};var Rotate=pc.createScript("rotate");Rotate.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Rotate.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),Rotate.prototype.initialize=function(){this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.lastTouchPoint=new pc.Vec2,this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this))},Rotate.horizontalQuat=new pc.Quat,Rotate.verticalQuat=new pc.Quat,Rotate.resultQuat=new pc.Quat,Rotate.prototype.rotate=function(t,o){var e=Rotate.horizontalQuat,i=Rotate.verticalQuat,a=Rotate.resultQuat;e.setFromAxisAngle(this.cameraEntity.up,t*this.orbitSensitivity),i.setFromAxisAngle(this.cameraEntity.right,o*this.orbitSensitivity),a.mul2(e,i),a.mul(this.entity.getRotation()),this.entity.setRotation(a)},Rotate.prototype.onTouchStart=function(t){var o=t.touches[0];this.lastTouchPoint.set(o.x,o.y)},Rotate.prototype.onTouchMove=function(t){var o=t.touches[0],e=o.x-this.lastTouchPoint.x,i=o.y-this.lastTouchPoint.y;this.rotate(e,i),this.lastTouchPoint.set(o.x,o.y)},Rotate.prototype.onMouseMove=function(t){this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)&&this.rotate(t.dx,t.dy)};!function onload(){!function handleGlobal(){var n=window.onerror;window.onerror=function(){if(window.onanyerror.apply(this,arguments),n)return n.apply(this,arguments)}}()}(),window.onanyerror=window.onanyerror||function onanyerrorx(n,o,r,e,a){var t=n;if(n instanceof XMLHttpRequest)t=n.status+" "+n.responseURL;else if(n instanceof Event){var i=n.currentTarget;t=i}console.log("[onanyerror]",t,n)};// store.legacy.min.js
/* store.js - Copyright (c) 2010-2017 Marcus Westin */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.store=e()}}(function(){var define,module,exports;return function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var s=n[u]={exports:{}};t[u][0].call(s.exports,function(e){var n=t[u][1][e];return o(n?n:e)},s,s.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";var r=e("../src/store-engine"),o=e("../storages/all"),i=[e("../plugins/json2")];t.exports=r.createStore(o,i)},{"../plugins/json2":2,"../src/store-engine":4,"../storages/all":6}],2:[function(e,t,n){"use strict";function r(){return e("./lib/json2"),{}}t.exports=r},{"./lib/json2":3}],3:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};"object"!==("undefined"==typeof JSON?"undefined":_typeof(JSON))&&(JSON={}),function(){function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,o,i,u,a=gap,c=t[e];switch(c&&"object"===("undefined"==typeof c?"undefined":_typeof(c))&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),"undefined"==typeof c?"undefined":_typeof(c)){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,u=[],"[object Array]"===Object.prototype.toString.apply(c)){for(i=c.length,n=0;n<i;n+=1)u[n]=str(n,c)||"null";return o=0===u.length?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+a+"]":"["+u.join(",")+"]",gap=a,o}if(rep&&"object"===("undefined"==typeof rep?"undefined":_typeof(rep)))for(i=rep.length,n=0;n<i;n+=1)"string"==typeof rep[n]&&(r=rep[n],o=str(r,c),o&&u.push(quote(r)+(gap?": ":":")+o));else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(o=str(r,c),o&&u.push(quote(r)+(gap?": ":":")+o));return o=0===u.length?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+a+"}":"{"+u.join(",")+"}",gap=a,o}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!==("undefined"==typeof t?"undefined":_typeof(t))||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,o=e[t];if(o&&"object"===("undefined"==typeof o?"undefined":_typeof(o)))for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r=walk(o,n),void 0!==r?o[n]=r:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},{}],4:[function(e,t,n){"use strict";function r(){var e="undefined"==typeof console?null:console;if(e){var t=e.warn?e.warn:e.log;t.apply(e,arguments)}}function o(e,t,n){n||(n=""),e&&!l(e)&&(e=[e]),t&&!l(t)&&(t=[t]);var o=n?"__storejs_"+n+"_":"",i=n?new RegExp("^"+o):null,v=/^[a-zA-Z0-9_\-]*$/;if(!v.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var h={_namespacePrefix:o,_namespaceRegexp:i,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(r){return!1}},_assignPluginFnProp:function(e,t){var n=this[t];this[t]=function(){function t(){if(n)return c(arguments,function(e,t){r[t]=e}),n.apply(o,r)}var r=u(arguments,0),o=this,i=[t].concat(r);return e.apply(o,i)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(r){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(l(e))return void c(e,function(e){t._addPlugin(e)});var n=a(this.plugins,function(t){return e===t});if(!n){if(this.plugins.push(e),!p(e))throw new Error("Plugins must be function values that return objects");var r=e.call(this);if(!d(r))throw new Error("Plugins must return an object of function properties");c(r,function(n,r){if(!p(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)})}},addStorage:function(e){r("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},m=s(h,g,{plugins:[]});return m.raw={},c(m,function(e,t){p(e)&&(m.raw[t]=f(m,e))}),c(e,function(e){m._addStorage(e)}),c(t,function(e){m._addPlugin(e)}),m}var i=e("./util"),u=i.slice,a=i.pluck,c=i.each,f=i.bind,s=i.create,l=i.isList,p=i.isFunction,d=i.isObject;t.exports={createStore:o};var g={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return o.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return o(this.storage,this.plugins,e)}}},{"./util":5}],5:[function(e,t,n){(function(e){"use strict";function n(){return Object.assign?Object.assign:function(e,t,n,r){for(var o=1;o<arguments.length;o++)a(Object(arguments[o]),function(t,n){e[n]=t});return e}}function r(){if(Object.create)return function(e,t,n,r){var o=u(arguments,1);return d.apply(this,[Object.create(e)].concat(o))};var e=function(){};return function(t,n,r,o){var i=u(arguments,1);return e.prototype=t,d.apply(this,[new e].concat(i))}}function o(){return String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function i(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}}function u(e,t){return Array.prototype.slice.call(e,t||0)}function a(e,t){f(e,function(e,n){return t(e,n),!1})}function c(e,t){var n=s(e)?[]:{};return f(e,function(e,r){return n[r]=t(e,r),!1}),n}function f(e,t){if(s(e)){for(var n=0;n<e.length;n++)if(t(e[n],n))return e[n]}else for(var r in e)if(e.hasOwnProperty(r)&&t(e[r],r))return e[r]}function s(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}function l(e){return e&&"[object Function]"==={}.toString.call(e)}function p(e){return e&&"[object Object]"==={}.toString.call(e)}var d=n(),g=r(),v=o(),h="undefined"!=typeof window?window:e;t.exports={assign:d,create:g,trim:v,bind:i,slice:u,each:a,map:c,pluck:f,isList:s,isFunction:l,isObject:p,Global:h}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,t,n){"use strict";t.exports=[e("./localStorage"),e("./oldFF-globalStorage"),e("./oldIE-userDataStorage"),e("./cookieStorage"),e("./sessionStorage"),e("./memoryStorage")]},{"./cookieStorage":7,"./localStorage":8,"./memoryStorage":9,"./oldFF-globalStorage":10,"./oldIE-userDataStorage":11,"./sessionStorage":12}],7:[function(e,t,n){"use strict";function r(e){if(!e||!c(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(p.cookie.replace(new RegExp(t),"$1"))}function o(e){for(var t=p.cookie.split(/; ?/g),n=t.length-1;n>=0;n--)if(l(t[n])){var r=t[n].split("="),o=unescape(r[0]),i=unescape(r[1]);e(i,o)}}function i(e,t){e&&(p.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function u(e){e&&c(e)&&(p.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function a(){o(function(e,t){u(t)})}function c(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(p.cookie)}var f=e("../src/util"),s=f.Global,l=f.trim;t.exports={name:"cookieStorage",read:r,write:i,each:o,remove:u,clearAll:a};var p=s.document},{"../src/util":5}],8:[function(e,t,n){"use strict";function r(){return s.localStorage}function o(e){return r().getItem(e)}function i(e,t){return r().setItem(e,t)}function u(e){for(var t=r().length-1;t>=0;t--){var n=r().key(t);e(o(n),n)}}function a(e){return r().removeItem(e)}function c(){return r().clear()}var f=e("../src/util"),s=f.Global;t.exports={name:"localStorage",read:o,write:i,each:u,remove:a,clearAll:c}},{"../src/util":5}],9:[function(e,t,n){"use strict";function r(e){return c[e]}function o(e,t){c[e]=t}function i(e){for(var t in c)c.hasOwnProperty(t)&&e(c[t],t)}function u(e){delete c[e]}function a(e){c={}}t.exports={name:"memoryStorage",read:r,write:o,each:i,remove:u,clearAll:a};var c={}},{}],10:[function(e,t,n){"use strict";function r(e){return s[e]}function o(e,t){s[e]=t}function i(e){for(var t=s.length-1;t>=0;t--){var n=s.key(t);e(s[n],n)}}function u(e){return s.removeItem(e)}function a(){i(function(e,t){delete s[e]})}var c=e("../src/util"),f=c.Global;t.exports={name:"oldFF-globalStorage",read:r,write:o,each:i,remove:u,clearAll:a};var s=f.globalStorage},{"../src/util":5}],11:[function(e,t,n){"use strict";function r(e,t){if(!v){var n=c(e);g(function(e){e.setAttribute(n,t),e.save(p)})}}function o(e){if(!v){var t=c(e),n=null;return g(function(e){n=e.getAttribute(t)}),n}}function i(e){g(function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var o=n[r];e(t.getAttribute(o.name),o.name)}})}function u(e){var t=c(e);g(function(e){e.removeAttribute(t),e.save(p)})}function a(){g(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(p);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(p)})}function c(e){return e.replace(/^\d/,"___$&").replace(h,"___")}function f(){if(!d||!d.documentElement||!d.documentElement.addBehavior)return null;var e,t,n,r="script";try{t=new ActiveXObject("htmlfile"),t.open(),t.write("<"+r+">document.w=window</"+r+'><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,n=e.createElement("div")}catch(o){n=d.createElement("div"),e=d.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(n),e.appendChild(n),n.addBehavior("#default#userData"),n.load(p),t.apply(this,r),e.removeChild(n)}}var s=e("../src/util"),l=s.Global;t.exports={name:"oldIE-userDataStorage",write:r,read:o,each:i,remove:u,clearAll:a};var p="storejs",d=l.document,g=f(),v=(l.navigator?l.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./),h=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g")},{"../src/util":5}],12:[function(e,t,n){"use strict";function r(){return s.sessionStorage}function o(e){return r().getItem(e)}function i(e,t){return r().setItem(e,t)}function u(e){for(var t=r().length-1;t>=0;t--){var n=r().key(t);e(o(n),n)}}function a(e){return r().removeItem(e)}function c(){return r().clear()}var f=e("../src/util"),s=f.Global;t.exports={name:"sessionStorage",read:o,write:i,each:u,remove:a,clearAll:c}},{"../src/util":5}]},{},[1])(1)});

var RewardScreenTutorialStep=pc.createScript("rewardScreenTutorialStep");RewardScreenTutorialStep.attributes.add("collectionIndex",{type:"number"}),RewardScreenTutorialStep.attributes.add("levelIndex",{type:"number"}),RewardScreenTutorialStep.attributes.add("hint",{type:"string",default:"Look, your first customer just walked in! Heres what they say:"});var TutorialRewardStep=pc.createScript("tutorialRewardStep");TutorialRewardStep.attributes.add("collectionIndex",{type:"number"}),TutorialRewardStep.attributes.add("levelIndex",{type:"number"}),TutorialRewardStep.attributes.add("hint",{type:"string"});var TutorialLevelScreen=pc.createScript("tutorialLevelScreen");TutorialLevelScreen.attributes.add("userInputsAmount",{type:"number",default:3}),TutorialLevelScreen.attributes.add("active",{type:"boolean",default:!0}),TutorialLevelScreen.attributes.add("started",{type:"boolean",default:!1}),TutorialLevelScreen.attributes.add("moved",{type:"boolean",default:!1}),TutorialLevelScreen.attributes.add("hand",{type:"entity"}),TutorialLevelScreen.attributes.add("hideHandDuration",{type:"number",default:.3}),TutorialLevelScreen.prototype.initialize=function(){this.subscribeToInputEvents()},TutorialLevelScreen.prototype.subscribeToInputEvents=function(){var t=this.app.touch;t&&(t.on(pc.EVENT_TOUCHSTART,this.onMouseStart,this),t.on(pc.EVENT_TOUCHMOVE,this.onMouseMove,this),t.on(pc.EVENT_TOUCHEND,this.onMouseUp,this));var e=this.app.mouse;e&&(e.on(pc.EVENT_MOUSEDOWN,this.onMouseStart,this),e.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),e.on(pc.EVENT_MOUSEUP,this.onMouseUp,this))},TutorialLevelScreen.prototype.onMouseStart=function(){this.active&&(this.started=!0)},TutorialLevelScreen.prototype.onMouseMove=function(){this.active&&this.started&&(this.started=!1,this.moved=!0)},TutorialLevelScreen.prototype.onMouseUp=function(){this.active&&(this.moved?(this.moved=!1,this.userInputsAmount--,this.userInputsAmount<=0&&(this.active=!1,this.hideHand())):this.started=!1)},TutorialLevelScreen.prototype.hide=function(){this.active=!1,this.entity.enabled=!1},TutorialLevelScreen.prototype.hideHand=function(){ImageUtils.tweenOpacity(this.hand.element,1,0,this.hideHandDuration,pc.SineInOut)};(function(){"use strict";var e={function:!0,object:!0},t=e[typeof window]&&window||this,r=e[typeof exports]&&exports,i=e[typeof module]&&module&&!module.nodeType&&module,n=r&&i&&"object"==typeof global&&global;!n||n.global!==n&&n.window!==n&&n.self!==n||(t=n);var a=Math.pow(2,53)-1,o=/\bOpera/,l=Object.prototype,s=l.hasOwnProperty,b=l.toString;function capitalize(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function format(e){return e=trim(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:capitalize(e)}function forOwn(e,t){for(var r in e)s.call(e,r)&&t(e[r],r,e)}function getClassOf(e){return null==e?capitalize(e):b.call(e).slice(8,-1)}function qualify(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function reduce(e,t){var r=null;return function each(e,t){var r=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=a)for(;++r<i;)t(e[r],r,e);else forOwn(e,t)}(e,function(i,n){r=t(r,i,n,e)}),r}function trim(e){return String(e).replace(/^ +| +$/g,"")}var c=function parse(e){var r=t,i=e&&"object"==typeof e&&"String"!=getClassOf(e);i&&(r=e,e=null);var n=r.navigator||{},a=n.language,l=n.userAgent||"";e||(e=l);var s,c,u=i?!!n.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(b.toString()),p="Object",d=i?p:"ScriptBridgingProxyObject",f=i?p:"Environment",S=i&&r.java?"JavaPackage":getClassOf(r.java),x=i?p:"RuntimeObject",g=/\bJava/.test(S)&&r.java,m=g&&getClassOf(r.environment)==f,h=g?"a":"",O=g?"b":"",y=r.document||{},M=r.operamini||r.opera,w=o.test(w=i&&M?M["[[Class]]"]:getClassOf(M))?w:M=null,E=e,P=[],v=null,C=e==l,k=C&&M&&"function"==typeof M.version&&M.version(),W=function getLayout(t){return reduce(t,function(t,r){return t||RegExp("\\b"+(r.pattern||qualify(r))+"\\b","i").exec(e)&&(r.label||r)})}([{label:"EdgeHTML",pattern:"(?:Edge|EdgA|EdgiOS)"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),B=function getName(t){return reduce(t,function(t,r){return t||RegExp("\\b"+(r.pattern||qualify(r))+"\\b","i").exec(e)&&(r.label||r)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),A=getProduct([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),I=function getManufacturer(t){return reduce(t,function(t,r,i){return t||(r[A]||r[/^[a-z]+(?: +[a-z]+\b)*/i.exec(A)]||RegExp("\\b"+qualify(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),R=function getOS(t){return reduce(t,function(t,r){var i=r.pattern||qualify(r);return!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=function cleanupOS(e,t,r){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),e=format(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(t,i,r.label||r)),t})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function getProduct(t){return reduce(t,function(t,r){var i=r.pattern||qualify(r);return!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(e)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(r.label&&!RegExp(i,"i").test(r.label)?r.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),r=r.label||r,t=format(t[0].replace(RegExp(i,"i"),r).replace(RegExp("; *(?:"+r+"[_-])?","i")," ").replace(RegExp("("+r+")[-_.]?(\\w)","i"),"$1 $2"))),t})}if(W&&(W=[W]),I&&!A&&(A=getProduct([I])),(s=/\bGoogle TV\b/.exec(A))&&(A=s[0]),/\bSimulator\b/i.test(e)&&(A=(A?A+" ":"")+"Simulator"),"Opera Mini"==B&&/\bOPiOS\b/.test(e)&&P.push("running in Turbo/Uncompressed mode"),"IE"==B&&/\blike iPhone OS\b/.test(e)?(I=(s=parse(e.replace(/like iPhone OS/,""))).manufacturer,A=s.product):/^iP/.test(A)?(B||(B="Safari"),R="iOS"+((s=/ OS ([\d_]+)/i.exec(e))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"!=B||/buntu/i.test(R)?I&&"Google"!=I&&(/Chrome/.test(B)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(A))||/\bAndroid\b/.test(R)&&/^Chrome/.test(B)&&/\bVersion\//i.test(e)?(B="Android Browser",R=/\bAndroid\b/.test(R)?R:"Android"):"Silk"==B?(/\bMobi/i.test(e)||(R="Android",P.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&P.unshift("accelerated")):"PaleMoon"==B&&(s=/\bFirefox\/([\d.]+)\b/.exec(e))?P.push("identifying as Firefox "+s[1]):"Firefox"==B&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(R||(R="Firefox OS"),A||(A=s[1])):!B||(s=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(B))?(B&&!A&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(s+"/")+8))&&(B=null),(s=A||I||R)&&(A||I||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(R))&&(B=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(R)?R:s)+" Browser")):"Electron"==B&&(s=(/\bChrome\/([\d.]+)\b/.exec(e)||0)[1])&&P.push("Chromium "+s):R="Kubuntu",k||(k=function getVersion(t){return reduce(t,function(t,r){return t||(RegExp(r+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|EdgA|EdgiOS|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",qualify(B),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==W&&parseFloat(k)>3?"WebKit":/\bOpera\b/.test(B)&&(/\bOPR\b/.test(e)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(W)&&"WebKit"||!W&&/\bMSIE\b/i.test(e)&&("Mac OS"==R?"Tasman":"Trident")||"WebKit"==W&&/\bPlayStation\b(?! Vita\b)/i.test(B)&&"NetFront")&&(W=[s]),"IE"==B&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(B+=" Mobile",R="Windows Phone "+(/\+$/.test(s)?s:s+".x"),P.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(B="IE Mobile",R="Windows Phone 8.x",P.unshift("desktop mode"),k||(k=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=B&&"Trident"==W&&(s=/\brv:([\d.]+)/.exec(e))&&(B&&P.push("identifying as "+B+(k?" "+k:"")),B="IE",k=s[1]),C){if(function isHostType(e,t){var r=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(r)||"object"==r&&!e[t])}(r,"global"))if(g&&(E=(s=g.lang.System).getProperty("os.arch"),R=R||s.getProperty("os.name")+" "+s.getProperty("os.version")),m){try{k=r.require("ringo/engine").version.join("."),B="RingoJS"}catch(e){(s=r.system)&&s.global.system==r.system&&(B="Narwhal",R||(R=s[0].os||null))}B||(B="Rhino")}else"object"==typeof r.process&&!r.process.browser&&(s=r.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(P.push("Node "+s.versions.node),B="Electron",k=s.versions.electron):"string"==typeof s.versions.nw&&(P.push("Chromium "+k,"Node "+s.versions.node),B="NW.js",k=s.versions.nw)),B||(B="Node.js",E=s.arch,R=s.platform,k=(k=/[\d.]+/.exec(s.version))?k[0]:null));else getClassOf(s=r.runtime)==d?(B="Adobe AIR",R=s.flash.system.Capabilities.os):getClassOf(s=r.phantom)==x?(B="PhantomJS",k=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof y.documentMode&&(s=/\bTrident\/(\d+)/i.exec(e))?(k=[k,y.documentMode],(s=+s[1]+4)!=k[1]&&(P.push("IE "+k[1]+" mode"),W&&(W[1]=""),k[1]=s),k="IE"==B?String(k[1].toFixed(1)):k[0]):"number"==typeof y.documentMode&&/^(?:Chrome|Firefox)\b/.test(B)&&(P.push("masking as "+B+" "+k),B="IE",k="11.0",W=["Trident"],R="Windows");R=R&&format(R)}if(k&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(k)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(C&&n.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(v=/b/i.test(s)?"beta":"alpha",k=k.replace(RegExp(s+"\\+?$"),"")+("beta"==v?O:h)+(/\d+\+?/.exec(s)||"")),"Fennec"==B||"Firefox"==B&&/\b(?:Android|Firefox OS)\b/.test(R))B="Firefox Mobile";else if("Maxthon"==B&&k)k=k.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(A))"Xbox 360"==A&&(R=null),"Xbox 360"==A&&/\bIEMobile\b/.test(e)&&P.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(B)&&(!B||A||/Browser|Mobi/.test(B))||"Windows CE"!=R&&!/Mobi/i.test(e))if("IE"==B&&C)try{null===r.external&&P.unshift("platform preview")}catch(e){P.unshift("embedded")}else(/\bBlackBerry\b/.test(A)||/\bBB10\b/.test(e))&&(s=(RegExp(A.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||k)?(s=[s,/BB10/.test(e)],R=(s[1]?(A=null,I="BlackBerry"):"Device Software")+" "+s[0],k=null):this!=forOwn&&"Wii"!=A&&(C&&M||/Opera/.test(B)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==B&&/\bOS X (?:\d+\.){2,}/.test(R)||"IE"==B&&(R&&!/^Win/.test(R)&&k>5.5||/\bWindows XP\b/.test(R)&&k>8||8==k&&!/\bTrident\b/.test(e)))&&!o.test(s=parse.call(forOwn,e.replace(o,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),o.test(B)?(/\bIE\b/.test(s)&&"Mac OS"==R&&(R=null),s="identify"+s):(s="mask"+s,B=w?format(w.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(R=null),C||(k=null)),W=["Presto"],P.push(s));else B+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==B&&"+"==s[1].slice(-1)?(B="WebKit Nightly",v="alpha",k=s[1].slice(0,-1)):k!=s[1]&&k!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(k=null),s[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==W&&(W=["Blink"]),C&&(u||s[1])?(W&&(W[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=W?"27":"28")):(W&&(W[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:"8"),W&&(W[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==B&&(!k||parseInt(k)>45)&&(k=s)),"Opera"==B&&(s=/\bzbov|zvav$/.exec(R))?(B+=" ",P.unshift("desktop mode"),"zvav"==s?(B+="Mini",k=null):B+="Mobile",R=R.replace(RegExp(" *"+s+"$"),"")):"Safari"==B&&/\bChrome\b/.exec(W&&W[1])&&(P.unshift("desktop mode"),B="Chrome Mobile",k=null,/\bOS X\b/.test(R)?(I="Apple",R="iOS 4.3+"):R=null),k&&0==k.indexOf(s=/[\d.]+$/.exec(R))&&e.indexOf("/"+s+"-")>-1&&(R=trim(R.replace(s,""))),W&&!/\b(?:Avant|Nook)\b/.test(B)&&(/Browser|Lunascape|Maxthon/.test(B)||"Safari"!=B&&/^iOS/.test(R)&&/\bSafari\b/.test(W[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(B)&&W[1])&&(s=W[W.length-1])&&P.push(s),P.length&&(P=["("+P.join("; ")+")"]),I&&A&&A.indexOf(I)<0&&P.push("on "+I),A&&P.push((/^on /.test(P[P.length-1])?"":"on ")+A),R&&(s=/ ([\d.+]+)$/.exec(R),c=s&&"/"==R.charAt(R.length-s[0].length-1),R={arch:32,family:s&&!c?R.replace(s[0],""):R,ver:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.arch?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(E))&&!/\bi686\b/i.test(E)?(R&&(R.arch=64,R.family=R.family.replace(RegExp(" *"+s),"")),B&&(/\bWOW64\b/i.test(e)||C&&/\w(?:86|32)$/.test(n.cpuClass||n.platform)&&!/\bWin64; x64\b/i.test(e))&&P.unshift("32-bit")):R&&/^OS X/.test(R.family)&&"Chrome"==B&&parseFloat(k)>=39&&(R.arch=64),e||(e=null);var T={};return T.description=e,T.layout=W&&W[0],T.manufacturer=I,T.name=B,T.prerelease=v,T.product=A,T.ua=e,T.version=B&&k,T.os=R||{arch:null,family:null,ver:null,toString:function(){return"null"}},T.lang=a,T.parse=parse,T.toString=function toStringPlatform(){return this.description||""},T.version&&P.unshift(k),T.name&&P.unshift(B),R&&B&&(R!=String(R).split(" ")[0]||R!=B.split(" ")[0]&&!A)&&P.push(A?"("+R+")":"on "+R),P.length&&(T.description=P.join(" ")),T}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t.platform=c,define(function(){return c})):r&&i?forOwn(c,function(e,t){r[t]=e}):t.platform=c}).call(this);var TutorialGalleryStep=pc.createScript("tutorialGalleryStep");TutorialGalleryStep.attributes.add("collectionIndex",{type:"number"}),TutorialGalleryStep.attributes.add("levelIndex",{type:"number"}),TutorialGalleryStep.attributes.add("ui",{type:"entity"});var TutorialRewardScreen=pc.createScript("tutorialRewardScreen");TutorialRewardScreen.attributes.add("hintText",{type:"entity"}),TutorialRewardScreen.attributes.add("hintTextPanel",{type:"entity"}),TutorialRewardScreen.attributes.add("startHintTextPos",{type:"entity"}),TutorialRewardScreen.attributes.add("hintAnimDuration",{type:"number",default:1}),TutorialRewardScreen.attributes.add("hintAnimDelay",{type:"number",default:0}),TutorialRewardScreen.attributes.add("visitorReviewAnimDelay",{type:"number",default:0}),TutorialRewardScreen.attributes.add("buttonsAnimDelay",{type:"number",default:.7});var BounceAnimation=pc.createScript("bounceAnimation");BounceAnimation.attributes.add("fromPoint",{type:"entity"}),BounceAnimation.attributes.add("toPoint",{type:"entity"}),BounceAnimation.attributes.add("duration",{type:"number",default:.7}),BounceAnimation.prototype.initialize=function(){ImageUtils.tweenPos(this.entity,this.fromPoint,this.toPoint,this.duration,0,pc.SineInOut,!0,!0)};var TutorialGameStep=pc.createScript("tutorialGameStep");TutorialGameStep.attributes.add("collectionIndex",{type:"number"}),TutorialGameStep.attributes.add("levelIndex",{type:"number"}),TutorialGameStep.attributes.add("hint",{type:"string"}),TutorialGameStep.attributes.add("userInputsAmount",{type:"number",default:3});var EllipseAnimation=pc.createScript("ellipseAnimation");EllipseAnimation.attributes.add("quarterWave",{type:"curve",curves:["x","y"]}),EllipseAnimation.attributes.add("xMultiplier",{type:"number",default:200}),EllipseAnimation.attributes.add("yMultiplier",{type:"number",default:75}),EllipseAnimation.attributes.add("duration",{type:"number",default:5}),EllipseAnimation.prototype.initialize=function(){this.tween=this.startAnimation(),this.entity.script.on("state",function(t){t?this.startAnimation():this.stopAnimation()}.bind(this))},EllipseAnimation.prototype.startAnimation=function(){this.stopAnimation();var t=this.quarterWave.curves[0],i=this.quarterWave.curves[1],e=this.entity.getLocalPosition().clone(),n={t:0,xPos:0,yPox:0};return this.app.tween(n).to({t:1},this.duration,pc.Linear).on("update",function(){n.xPos=t.value(n.t),n.yPos=i.value(n.t),this.entity.setLocalPosition(new pc.Vec3(e.x+n.xPos*this.xMultiplier,e.y+n.yPos*this.yMultiplier,e.z))}.bind(this)).loop(!0).start()},EllipseAnimation.prototype.stopAnimation=function(){this.tween&&this.tween.stop()};var PaginationPoint=pc.createScript("paginationPoint");PaginationPoint.attributes.add("inactivePaginatorPoint",{type:"entity"}),PaginationPoint.attributes.add("activePaginatorPoint",{type:"entity"}),PaginationPoint.attributes.add("inactiveBonusPaginatorPoint",{type:"entity"}),PaginationPoint.attributes.add("activeBonusPaginatorPoint",{type:"entity"});function UUID(){"use strict";var n,e,r,o=window.crypto||window.msCrypto;if(!n&&o&&o.getRandomValues)try{var a=new Uint8Array(16);r=n=function whatwgRNG(){return o.getRandomValues(a),a},n()}catch(n){}if(!n){var t=new Array(16);e=n=function(){for(var n,e=0;e<16;e++)0==(3&e)&&(n=4294967296*Math.random()),t[e]=n>>>((3&e)<<3)&255;return t},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}for(var u="function"==typeof Buffer?Buffer:Array,s=[],f={},i=0;i<256;i++)s[i]=(i+256).toString(16).substr(1),f[s[i]]=i;function unparse(n,e){var r=e||0,o=s;return o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+"-"+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]+o[n[r++]]}var c=n(),l=[1|c[0],c[1],c[2],c[3],c[4],c[5]],d=16383&(c[6]<<8|c[7]),v=0,w=0;function v4(e,r,o){var a=r&&o||0;"string"==typeof e&&(r="binary"===e?new u(16):null,e=null);var t=(e=e||{}).random||(e.rng||n)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,r)for(var s=0;s<16;s++)r[a+s]=t[s];return r||unparse(t)}var p=v4;return p.v1=function v1(n,e,r){var o=e&&r||0,a=e||[],t=null!=(n=n||{}).clockseq?n.clockseq:d,u=null!=n.msecs?n.msecs:(new Date).getTime(),s=null!=n.nsecs?n.nsecs:w+1,f=u-v+(s-w)/1e4;if(f<0&&null==n.clockseq&&(t=t+1&16383),(f<0||u>v)&&null==n.nsecs&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=u,w=s,d=t;var i=(1e4*(268435455&(u+=122192928e5))+s)%4294967296;a[o++]=i>>>24&255,a[o++]=i>>>16&255,a[o++]=i>>>8&255,a[o++]=255&i;var c=u/4294967296*1e4&268435455;a[o++]=c>>>8&255,a[o++]=255&c,a[o++]=c>>>24&15|16,a[o++]=c>>>16&255,a[o++]=t>>>8|128,a[o++]=255&t;for(var p=n.node||l,m=0;m<6;m++)a[o+m]=p[m];return e||unparse(a)},p.v4=v4,p.parse=function parse(n,e,r){var o=e&&r||0,a=0;for(e=e||[],n.toLowerCase().replace(/[0-9a-f]{2}/g,function(n){a<16&&(e[o+a++]=f[n])});a<16;)e[o+a++]=0;return e},p.unparse=unparse,p.BufferClass=u,p._rng=n,p._mathRNG=e,p._whatwgRNG=r,p}"undefined"!=typeof module&&module.exports?module.exports=new UUID:"undefined"!=typeof define&&define.amd?define(function(){return new UUID}):window.uuid=UUID();// sourcebuster.min.js
/** sourcebuster v1.1.1 **/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self&&(r=self),r.sbjs=e()}}(function(){return function e(r,t,s){function n(a,i){if(!t[a]){if(!r[a]){var c="function"==typeof require&&require;if(!i&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=t[a]={exports:{}};r[a][0].call(p.exports,function(e){var t=r[a][1][e];return n(t?t:e)},p,p.exports,e,r,t,s)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(e,r,t){"use strict";var s=e("./init"),n={init:function(e){this.get=s(e),e&&e.callback&&"function"==typeof e.callback&&e.callback(this.get)}};r.exports=n},{"./init":6}],2:[function(e,r,t){"use strict";var s=e("./terms"),n=e("./helpers/utils"),o={containers:{current:"sbjs_current",current_extra:"sbjs_current_add",first:"sbjs_first",first_extra:"sbjs_first_add",session:"sbjs_session",udata:"sbjs_udata",promocode:"sbjs_promo"},service:{migrations:"sbjs_migrations"},delimiter:"|||",aliases:{main:{type:"typ",source:"src",medium:"mdm",campaign:"cmp",content:"cnt",term:"trm"},extra:{fire_date:"fd",entrance_point:"ep",referer:"rf"},session:{pages_seen:"pgs",current_page:"cpg"},udata:{visits:"vst",ip:"uip",agent:"uag"},promo:"code"},pack:{main:function(e){return o.aliases.main.type+"="+e.type+o.delimiter+o.aliases.main.source+"="+e.source+o.delimiter+o.aliases.main.medium+"="+e.medium+o.delimiter+o.aliases.main.campaign+"="+e.campaign+o.delimiter+o.aliases.main.content+"="+e.content+o.delimiter+o.aliases.main.term+"="+e.term},extra:function(e){return o.aliases.extra.fire_date+"="+n.setDate(new Date,e)+o.delimiter+o.aliases.extra.entrance_point+"="+document.location.href+o.delimiter+o.aliases.extra.referer+"="+(document.referrer||s.none)},user:function(e,r){return o.aliases.udata.visits+"="+e+o.delimiter+o.aliases.udata.ip+"="+r+o.delimiter+o.aliases.udata.agent+"="+navigator.userAgent},session:function(e){return o.aliases.session.pages_seen+"="+e+o.delimiter+o.aliases.session.current_page+"="+document.location.href},promo:function(e){return o.aliases.promo+"="+n.setLeadingZeroToInt(n.randomInt(e.min,e.max),e.max.toString().length)}}};r.exports=o},{"./helpers/utils":5,"./terms":9}],3:[function(e,r,t){"use strict";var s=e("../data").delimiter;r.exports={encodeData:function(e){return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\~/g,"%7E").replace(/\*/g,"%2A").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},decodeData:function(e){try{return decodeURIComponent(e).replace(/\%21/g,"!").replace(/\%7E/g,"~").replace(/\%2A/g,"*").replace(/\%27/g,"'").replace(/\%28/g,"(").replace(/\%29/g,")")}catch(r){try{return unescape(e)}catch(t){return""}}},set:function(e,r,t,s,n){var o,a;if(t){var i=new Date;i.setTime(i.getTime()+60*t*1e3),o="; expires="+i.toGMTString()}else o="";a=s&&!n?";domain=."+s:"",document.cookie=this.encodeData(e)+"="+this.encodeData(r)+o+a+"; path=/"},get:function(e){for(var r=this.encodeData(e)+"=",t=document.cookie.split(";"),s=0;s<t.length;s++){for(var n=t[s];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(r))return this.decodeData(n.substring(r.length,n.length))}return null},destroy:function(e,r,t){this.set(e,"",-1,r,t)},parse:function(e){var r=[],t={};if("string"==typeof e)r.push(e);else for(var n in e)e.hasOwnProperty(n)&&r.push(e[n]);for(var o=0;o<r.length;o++){var a;t[this.unsbjs(r[o])]={},a=this.get(r[o])?this.get(r[o]).split(s):[];for(var i=0;i<a.length;i++){var c=a[i].split("="),u=c.splice(0,1);u.push(c.join("=")),t[this.unsbjs(r[o])][u[0]]=this.decodeData(u[1])}}return t},unsbjs:function(e){return e.replace("sbjs_","")}}},{"../data":2}],4:[function(e,r,t){"use strict";r.exports={parse:function(e){for(var r=this.parseOptions,t=r.parser[r.strictMode?"strict":"loose"].exec(e),s={},n=14;n--;)s[r.key[n]]=t[n]||"";return s[r.q.name]={},s[r.key[12]].replace(r.q.parser,function(e,t,n){t&&(s[r.q.name][t]=n)}),s},parseOptions:{strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},getParam:function(e){for(var r={},t=e?e:window.location.search.substring(1),s=t.split("&"),n=0;n<s.length;n++){var o=s[n].split("=");if("undefined"==typeof r[o[0]])r[o[0]]=o[1];else if("string"==typeof r[o[0]]){var a=[r[o[0]],o[1]];r[o[0]]=a}else r[o[0]].push(o[1])}return r},getHost:function(e){return this.parse(e).host.replace("www.","")}}},{}],5:[function(e,r,t){"use strict";r.exports={escapeRegexp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},setDate:function(e,r){var t=e.getTimezoneOffset()/60,s=e.getHours(),n=r||0===r?r:-t;e.setHours(s+t+n);var o=e.getFullYear(),a=this.setLeadingZeroToInt(e.getMonth()+1,2),i=this.setLeadingZeroToInt(e.getDate(),2),c=this.setLeadingZeroToInt(e.getHours(),2),u=this.setLeadingZeroToInt(e.getMinutes(),2),p=this.setLeadingZeroToInt(e.getSeconds(),2);return o+"-"+a+"-"+i+" "+c+":"+u+":"+p},setLeadingZeroToInt:function(e,r){for(var t=e+"";t.length<r;)t="0"+t;return t},randomInt:function(e,r){return Math.floor(Math.random()*(r-e+1))+e}}},{}],6:[function(e,r,t){"use strict";var s=e("./data"),n=e("./terms"),o=e("./helpers/cookies"),a=e("./helpers/uri"),i=e("./helpers/utils"),c=e("./params"),u=e("./migrations");r.exports=function(e){function r(){var e;if("undefined"!=typeof y.utm_source||"undefined"!=typeof y.utm_medium||"undefined"!=typeof y.utm_campaign||"undefined"!=typeof y.utm_content||"undefined"!=typeof y.utm_term||"undefined"!=typeof y.gclid||"undefined"!=typeof y.yclid||"undefined"!=typeof y[h.campaign_param]||"undefined"!=typeof y[h.term_param]||"undefined"!=typeof y[h.content_param])g(),e=t(n.traffic.utm);else if(f(n.traffic.organic))g(),e=t(n.traffic.organic);else if(!o.get(s.containers.session)&&f(n.traffic.referral))g(),e=t(n.traffic.referral);else{if(o.get(s.containers.first)||o.get(s.containers.current))return o.get(s.containers.current);g(),e=t(n.traffic.typein)}return e}function t(e){switch(e){case n.traffic.utm:v=n.traffic.utm,x="undefined"!=typeof y.utm_source?y.utm_source:"undefined"!=typeof y.gclid?"google":"undefined"!=typeof y.yclid?"yandex":n.none,D="undefined"!=typeof y.utm_medium?y.utm_medium:"undefined"!=typeof y.gclid?"cpc":"undefined"!=typeof y.yclid?"cpc":n.none,k="undefined"!=typeof y.utm_campaign?y.utm_campaign:"undefined"!=typeof y[h.campaign_param]?y[h.campaign_param]:"undefined"!=typeof y.gclid?"google_cpc":"undefined"!=typeof y.yclid?"yandex_cpc":n.none,w="undefined"!=typeof y.utm_content?y.utm_content:"undefined"!=typeof y[h.content_param]?y[h.content_param]:n.none,C="undefined"!=typeof y.utm_term?y.utm_term:"undefined"!=typeof y[h.term_param]?y[h.term_param]:p()||n.none;break;case n.traffic.organic:v=n.traffic.organic,x=x||a.getHost(document.referrer),D=n.referer.organic,k=n.none,w=n.none,C=n.none;break;case n.traffic.referral:v=n.traffic.referral,x=x||a.getHost(document.referrer),D=D||n.referer.referral,k=n.none,w=a.parse(document.referrer).path,C=n.none;break;case n.traffic.typein:v=n.traffic.typein,x=h.typein_attributes.source,D=h.typein_attributes.medium,k=n.none,w=n.none,C=n.none;break;default:v=n.oops,x=n.oops,D=n.oops,k=n.oops,w=n.oops,C=n.oops}var r={type:v,source:x,medium:D,campaign:k,content:w,term:C};return s.pack.main(r)}function p(){var e=document.referrer;if(y.utm_term)return y.utm_term;if(!(e&&a.parse(e).host&&a.parse(e).host.match(/^(?:.*\.)?yandex\..{2,9}$/i)))return!1;try{return a.getParam(a.parse(document.referrer).query).text}catch(r){return!1}}function f(e){var r=document.referrer;switch(e){case n.traffic.organic:return!!r&&m(r)&&d(r);case n.traffic.referral:return!!r&&m(r)&&l(r);default:return!1}}function m(e){if(h.domain){if(_)return a.getHost(e)!==a.getHost(j);var r=new RegExp("^(?:.*\\.)?"+i.escapeRegexp(j)+"$","i");return!a.getHost(e).match(r)}return a.getHost(e)!==a.getHost(document.location.href)}function d(e){var r="yandex",t="text",s="google",n=new RegExp("^(?:.*\\.)?"+i.escapeRegexp(r)+"\\..{2,9}$"),o=new RegExp(".*"+i.escapeRegexp(t)+"=.*"),c=new RegExp("^(?:www\\.)?"+i.escapeRegexp(s)+"\\..{2,9}$");if(a.parse(e).query&&a.parse(e).host.match(n)&&a.parse(e).query.match(o))return x=r,!0;if(a.parse(e).host.match(c))return x=s,!0;if(!a.parse(e).query)return!1;for(var u=0;u<h.organics.length;u++){if(a.parse(e).host.match(new RegExp("^(?:.*\\.)?"+i.escapeRegexp(h.organics[u].host)+"$","i"))&&a.parse(e).query.match(new RegExp(".*"+i.escapeRegexp(h.organics[u].param)+"=.*","i")))return x=h.organics[u].display||h.organics[u].host,!0;if(u+1===h.organics.length)return!1}}function l(e){if(!(h.referrals.length>0))return x=a.getHost(e),!0;for(var r=0;r<h.referrals.length;r++){if(a.parse(e).host.match(new RegExp("^(?:.*\\.)?"+i.escapeRegexp(h.referrals[r].host)+"$","i")))return x=h.referrals[r].display||h.referrals[r].host,D=h.referrals[r].medium||n.referer.referral,!0;if(r+1===h.referrals.length)return x=a.getHost(e),!0}}function g(){o.set(s.containers.current_extra,s.pack.extra(h.timezone_offset),b,j,_),o.get(s.containers.first_extra)||o.set(s.containers.first_extra,s.pack.extra(h.timezone_offset),b,j,_)}var h=c.fetch(e),y=a.getParam(),j=h.domain.host,_=h.domain.isolate,b=h.lifetime;u.go(b,j,_);var v,x,D,k,w,C;return function(){o.set(s.containers.current,r(),b,j,_),o.get(s.containers.first)||o.set(s.containers.first,o.get(s.containers.current),b,j,_);var e,t;o.get(s.containers.udata)?(e=parseInt(o.parse(s.containers.udata)[o.unsbjs(s.containers.udata)][s.aliases.udata.visits])||1,e=o.get(s.containers.session)?e:e+1,t=s.pack.user(e,h.user_ip)):(e=1,t=s.pack.user(e,h.user_ip)),o.set(s.containers.udata,t,b,j,_);var n;o.get(s.containers.session)?(n=parseInt(o.parse(s.containers.session)[o.unsbjs(s.containers.session)][s.aliases.session.pages_seen])||1,n+=1):n=1,o.set(s.containers.session,s.pack.session(n),h.session_length,j,_),h.promocode&&!o.get(s.containers.promocode)&&o.set(s.containers.promocode,s.pack.promo(h.promocode),b,j,_)}(),o.parse(s.containers)}},{"./data":2,"./helpers/cookies":3,"./helpers/uri":4,"./helpers/utils":5,"./migrations":7,"./params":8,"./terms":9}],7:[function(e,r,t){"use strict";var s=e("./data"),n=e("./helpers/cookies");r.exports={go:function(e,r,t){var o,a=this.migrations,i={l:e,d:r,i:t};if(n.get(s.containers.first)||n.get(s.service.migrations)){if(!n.get(s.service.migrations))for(o=0;o<a.length;o++)a[o].go(a[o].id,i)}else{var c=[];for(o=0;o<a.length;o++)c.push(a[o].id);var u="";for(o=0;o<c.length;o++)u+=c[o]+"=1",o<c.length-1&&(u+=s.delimiter);n.set(s.service.migrations,u,i.l,i.d,i.i)}},migrations:[{id:"1418474375998",version:"1.0.0-beta",go:function(e,r){var t=e+"=1",o=e+"=0",a=function(e,r,t){return r||t?e:s.delimiter};try{var i=[];for(var c in s.containers)s.containers.hasOwnProperty(c)&&i.push(s.containers[c]);for(var u=0;u<i.length;u++)if(n.get(i[u])){var p=n.get(i[u]).replace(/(\|)?\|(\|)?/g,a);n.destroy(i[u],r.d,r.i),n.destroy(i[u],r.d,!r.i),n.set(i[u],p,r.l,r.d,r.i)}n.get(s.containers.session)&&n.set(s.containers.session,s.pack.session(0),r.l,r.d,r.i),n.set(s.service.migrations,t,r.l,r.d,r.i)}catch(f){n.set(s.service.migrations,o,r.l,r.d,r.i)}}}]}},{"./data":2,"./helpers/cookies":3}],8:[function(e,r,t){"use strict";var s=e("./terms"),n=e("./helpers/uri");r.exports={fetch:function(e){var r=e||{},t={};if(t.lifetime=this.validate.checkFloat(r.lifetime)||6,t.lifetime=parseInt(30*t.lifetime*24*60),t.session_length=this.validate.checkInt(r.session_length)||30,t.timezone_offset=this.validate.checkInt(r.timezone_offset),t.campaign_param=r.campaign_param||!1,t.term_param=r.term_param||!1,t.content_param=r.content_param||!1,t.user_ip=r.user_ip||s.none,r.promocode?(t.promocode={},t.promocode.min=parseInt(r.promocode.min)||1e5,t.promocode.max=parseInt(r.promocode.max)||999999):t.promocode=!1,r.typein_attributes&&r.typein_attributes.source&&r.typein_attributes.medium?(t.typein_attributes={},t.typein_attributes.source=r.typein_attributes.source,t.typein_attributes.medium=r.typein_attributes.medium):t.typein_attributes={source:"(direct)",medium:"(none)"},r.domain&&this.validate.isString(r.domain)?t.domain={host:r.domain,isolate:!1}:r.domain&&r.domain.host?t.domain=r.domain:t.domain={host:n.getHost(document.location.hostname),isolate:!1},t.referrals=[],r.referrals&&r.referrals.length>0)for(var o=0;o<r.referrals.length;o++)r.referrals[o].host&&t.referrals.push(r.referrals[o]);if(t.organics=[],r.organics&&r.organics.length>0)for(var a=0;a<r.organics.length;a++)r.organics[a].host&&r.organics[a].param&&t.organics.push(r.organics[a]);return t.organics.push({host:"bing.com",param:"q",display:"bing"}),t.organics.push({host:"yahoo.com",param:"p",display:"yahoo"}),t.organics.push({host:"about.com",param:"q",display:"about"}),t.organics.push({host:"aol.com",param:"q",display:"aol"}),t.organics.push({host:"ask.com",param:"q",display:"ask"}),t.organics.push({host:"globososo.com",param:"q",display:"globo"}),t.organics.push({host:"go.mail.ru",param:"q",display:"go.mail.ru"}),t.organics.push({host:"rambler.ru",param:"query",display:"rambler"}),t.organics.push({host:"tut.by",param:"query",display:"tut.by"}),t.referrals.push({host:"t.co",display:"twitter.com"}),t.referrals.push({host:"plus.url.google.com",display:"plus.google.com"}),t},validate:{checkFloat:function(e){return!(!e||!this.isNumeric(parseFloat(e)))&&parseFloat(e)},checkInt:function(e){return!(!e||!this.isNumeric(parseInt(e)))&&parseInt(e)},isNumeric:function(e){return!isNaN(e)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)}}}},{"./helpers/uri":4,"./terms":9}],9:[function(e,r,t){"use strict";r.exports={traffic:{utm:"utm",organic:"organic",referral:"referral",typein:"typein"},referer:{referral:"referral",organic:"organic",social:"social"},none:"(none)",oops:"(Houston, we have a problem)"}},{}]},{},[1])(1)});

